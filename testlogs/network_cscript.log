-------------------------------------------------------------------------------
      name:  <unnamed>
       log:  c:\ado\ian\network\testlogs\network_cscript.log
  log type:  text
 opened on:   8 Apr 2021, 17:37:45

. 
. cls

. cscript network
------------------------------------------------------------------BEGIN network

. set trace off

. set more off

. pause on

. prog drop _all

. myadopath mvmeta network
  [1]              "c:\ado\ian\network\package"
  [2]              "c:\ado\ian\mvmeta\package"
  [3]  (BASE)      "C:\Program Files\Stata16\ado\base/"
  [4]  (SITE)      "C:\Program Files\Stata16\ado\site/"
  [5]              "."
  [6]  (PERSONAL)  "N:\Home\ado\personal/"
  [7]  (PLUS)      "N:\Home\ado\stbplus/"
  [8]  (OLDPLACE)  "c:\ado/"

. 
. which mvmeta
c:\ado\ian\mvmeta\package\mvmeta.ado
*! version 3.2.4 # Ian White # 8mar2021
*! version 3.2.3 # Ian White # 22jan2021

. which network
c:\ado\ian\network\package\network.ado
*! version 1.7.0 # Ian White # 8apr2021

. 
. // check network setup
. 
. use smoking, clear
(Smoking data from Lu & Ades (2006))

. keep study trt d n

. 
. network setup d n, studyvar(stud) trtvar(trt) format(aug) ref(Self help)
Treatments used
   A:                                  No contact
   B (reference):                      Self help
   C:                                  Individual counselling
   D:                                  Group counselling

Measure                                Log odds ratio

Studies
   ID variable:                        study
   Number used:                        24
   IDs with zero cells:                9 20
   - count added to all their cells:   .5
   IDs with augmented reference arm:   1 6 7 8 9 10 11 12 13 14 15 16 17 18 19 
> 20 23 24
   - observations added:               0.00001
   - mean in augmented observations:   study-specific mean

Network information                    
   Components:                         1 (connected)
   D.f. for inconsistency:             7
   D.f. for heterogeneity:             16

Current data
   Data format:                        augmented
   Design variable:                    _design
   Estimate variables:                 _y*
   Variance variables:                 _S*
   Command to list the data:           list study _y* _S*, noo sepby(_design)

. l if study<=3

     +------------------------------------------------------------------------+
  1. | study | dA |  nA |       dB |       nB | dC |  nC | dD |  nD | _design |
     |     1 |  9 | 140 | 1.00e-06 | 1.00e-05 | 23 | 140 | 10 | 138 |   A C D |
     |------------------------------------------------------------------------|
     |      _y_A |      _y_C |       _y_D |    _S_A_A |    _S_A_C |    _S_A_D |
     | -.4860533 | .56523973 | -.35752573 | 1106408.4 | 1106408.3 | 1106408.3 |
     |-----------------------+------------------------------------------------|
     |          _S_C_C       |          _S_C_D       |          _S_D_D        |
     |       1106408.3       |       1106408.3       |       1106408.4        |
     +------------------------------------------------------------------------+

     +------------------------------------------------------------------------+
  2. | study | dA |  nA |       dB |       nB | dC |  nC | dD |  nD | _design |
     |     2 |  . |   . |       11 |       78 | 12 |  85 | 29 | 170 |   B C D |
     |------------------------------------------------------------------------|
     |      _y_A |      _y_C |       _y_D |    _S_A_A |    _S_A_C |    _S_A_D |
     |         . | .00124456 |  .22533329 |         . |         . |         . |
     |-----------------------+------------------------------------------------|
     |          _S_C_C       |          _S_C_D       |          _S_D_D        |
     |       .20286643       |       .10583446       |       .14740942        |
     +------------------------------------------------------------------------+

     +------------------------------------------------------------------------+
  3. | study | dA |  nA |       dB |       nB | dC |  nC | dD |  nD | _design |
     |     3 | 79 | 702 |       77 |      694 |  . |   . |  . |   . |     A B |
     |------------------------------------------------------------------------|
     |      _y_A |      _y_C |       _y_D |    _S_A_A |    _S_A_C |    _S_A_D |
     | .01596494 |         . |          . | .02887112 |         . |         . |
     |-----------------------+------------------------------------------------|
     |          _S_C_C       |          _S_C_D       |          _S_D_D        |
     |               .       |               .       |               .        |
     +------------------------------------------------------------------------+

. 
. // check network convert
. network convert pairs
Converting augmented to pairs ...

. l if study<=3

     +----------------------------------------------------------------+
  1. | study | d1 |  n1 | d2 |  n2 | _design | _t1 | _t2 |         _y |
     |     1 |  9 | 140 | 23 | 140 |   A C D |   A |   C |   1.051293 |
     |----------------------------------------------------------------|
     |             _stderr            |           _contr~t            |
     |           .41324323            |              C - A            |
     +----------------------------------------------------------------+

     +----------------------------------------------------------------+
  2. | study | d1 |  n1 | d2 |  n2 | _design | _t1 | _t2 |         _y |
     |     1 |  9 | 140 | 10 | 138 |   A C D |   A |   D |  .12852757 |
     |----------------------------------------------------------------|
     |             _stderr            |           _contr~t            |
     |           .47598025            |              D - A            |
     +----------------------------------------------------------------+

     +----------------------------------------------------------------+
  3. | study | d1 |  n1 | d2 |  n2 | _design | _t1 | _t2 |         _y |
     |     1 | 23 | 140 | 10 | 138 |   A C D |   C |   D | -.92276545 |
     |----------------------------------------------------------------|
     |             _stderr            |           _contr~t            |
     |           .39979716            |              D - C            |
     +----------------------------------------------------------------+

     +----------------------------------------------------------------+
  4. | study | d1 |  n1 | d2 |  n2 | _design | _t1 | _t2 |         _y |
     |     2 | 11 |  78 | 12 |  85 |   B C D |   B |   C |  .00124456 |
     |----------------------------------------------------------------|
     |             _stderr            |           _contr~t            |
     |           .45040696            |              C - B            |
     +----------------------------------------------------------------+

     +----------------------------------------------------------------+
  5. | study | d1 |  n1 | d2 |  n2 | _design | _t1 | _t2 |         _y |
     |     2 | 11 |  78 | 29 | 170 |   B C D |   B |   D |  .22533329 |
     |----------------------------------------------------------------|
     |             _stderr            |           _contr~t            |
     |           .38393935            |              D - B            |
     +----------------------------------------------------------------+

     +----------------------------------------------------------------+
  6. | study | d1 |  n1 | d2 |  n2 | _design | _t1 | _t2 |         _y |
     |     2 | 12 |  85 | 29 | 170 |   B C D |   C |   D |  .22408873 |
     |----------------------------------------------------------------|
     |             _stderr            |           _contr~t            |
     |            .3722995            |              D - C            |
     +----------------------------------------------------------------+

     +----------------------------------------------------------------+
  7. | study | d1 |  n1 | d2 |  n2 | _design | _t1 | _t2 |         _y |
     |     3 | 79 | 702 | 77 | 694 |     A B |   A |   B | -.01596494 |
     |----------------------------------------------------------------|
     |             _stderr            |           _contr~t            |
     |           .16991505            |              B - A            |
     +----------------------------------------------------------------+

. 
. network convert stan
Converting pairs to standard ...

. l if study<=3

     +---------------------------------------------------------------------+
  1. | study | d0 |  n0 | d1  |  n1  | d2  |  n2  | _design  |       _y_1  |
     |     1 |  9 | 140 | 23  | 140  | 10  | 138  |   A C D  |   1.051293  |
     |---------------------------------------------------------------------|
     |      _y_2 |    _S_1_1 |    _S_1_2 |    _S_2_2 | _contr~1 | _contr~2 |
     | .12852757 | .17076997 |  .1187447 |  .2265572 |    C - A |    D - A |
     +---------------------------------------------------------------------+

     +---------------------------------------------------------------------+
  2. | study | d0 |  n0 | d1  |  n1  | d2  |  n2  | _design  |       _y_1  |
     |     2 | 11 |  78 | 12  |  85  | 29  | 170  |   B C D  |  .00124456  |
     |---------------------------------------------------------------------|
     |      _y_2 |    _S_1_1 |    _S_1_2 |    _S_2_2 | _contr~1 | _contr~2 |
     | .22533329 | .20286643 | .10583446 | .14740942 |    C - B |    D - B |
     +---------------------------------------------------------------------+

     +---------------------------------------------------------------------+
  3. | study | d0 |  n0 | d1  |  n1  | d2  |  n2  | _design  |       _y_1  |
     |     3 | 79 | 702 | 77  | 694  |  .  |   .  |     A B  | -.01596494  |
     |---------------------------------------------------------------------|
     |      _y_2 |    _S_1_1 |    _S_1_2 |    _S_2_2 | _contr~1 | _contr~2 |
     |         . | .02887112 |         . |         . |    B - A |          |
     +---------------------------------------------------------------------+

. save z, replace
file z.dta saved

. 
. network convert aug, large(1E5)
Converting standard to augmented ...

. l if study<=3

     +-----------------------------------------------------------------+
  1. | study | dB |  nB | dA |  nA | dC |  nC  | dD  |  nD  | _design  |
     |     1 |  . |   . |  9 | 140 | 23 | 140  | 10  | 138  |   A C D  |
     |-----------------------+-----------------------+-----------------|
     |      _y_A |      _y_C |      _y_D |    _S_A_A | _S_A_C | _S_A_D |
     |         0 |  1.051293 | .12852757 |    100000 | 100000 | 100000 |
     |-----------------------------------------------------------------|
     |         _S_C_C      |         _S_C_D      |         _S_D_D      |
     |      100000.17      |      100000.12      |      100000.23      |
     +-----------------------------------------------------------------+

     +-----------------------------------------------------------------+
  2. | study | dB |  nB | dA |  nA | dC |  nC  | dD  |  nD  | _design  |
     |     2 | 11 |  78 |  . |   . | 12 |  85  | 29  | 170  |   B C D  |
     |-----------------------+-----------------------+-----------------|
     |      _y_A |      _y_C |      _y_D |    _S_A_A | _S_A_C | _S_A_D |
     |         . | .00124456 | .22533329 |         . |      . |      . |
     |-----------------------------------------------------------------|
     |         _S_C_C      |         _S_C_D      |         _S_D_D      |
     |      .20286643      |      .10583446      |      .14740942      |
     +-----------------------------------------------------------------+

     +-----------------------------------------------------------------+
  3. | study | dB |  nB | dA |  nA | dC |  nC  | dD  |  nD  | _design  |
     |     3 | 77 | 694 | 79 | 702 |  . |   .  |  .  |   .  |     A B  |
     |-----------------------+-----------------------+-----------------|
     |      _y_A |      _y_C |      _y_D |    _S_A_A | _S_A_C | _S_A_D |
     | .01596494 |         . |         . | .02887112 |      . |      . |
     |-----------------------------------------------------------------|
     |         _S_C_C      |         _S_C_D      |         _S_D_D      |
     |              .      |              .      |              .      |
     +-----------------------------------------------------------------+

. 
. network convert pairs
Converting augmented to pairs ...

. l if study<=3

     +----------------------------------------------------------------+
  1. | study | d1 |  n1 | d2 |  n2 | _design | _t1 | _t2 |         _y |
     |     1 |  9 | 140 | 23 | 140 |   A C D |   A |   C |   1.051293 |
     |----------------------------------------------------------------|
     |             _stderr            |           _contr~t            |
     |           .41324323            |              C - A            |
     +----------------------------------------------------------------+

     +----------------------------------------------------------------+
  2. | study | d1 |  n1 | d2 |  n2 | _design | _t1 | _t2 |         _y |
     |     1 |  9 | 140 | 10 | 138 |   A C D |   A |   D |  .12852757 |
     |----------------------------------------------------------------|
     |             _stderr            |           _contr~t            |
     |           .47598025            |              D - A            |
     +----------------------------------------------------------------+

     +----------------------------------------------------------------+
  3. | study | d1 |  n1 | d2 |  n2 | _design | _t1 | _t2 |         _y |
     |     1 | 23 | 140 | 10 | 138 |   A C D |   C |   D | -.92276545 |
     |----------------------------------------------------------------|
     |             _stderr            |           _contr~t            |
     |           .39979716            |              D - C            |
     +----------------------------------------------------------------+

     +----------------------------------------------------------------+
  4. | study | d1 |  n1 | d2 |  n2 | _design | _t1 | _t2 |         _y |
     |     2 | 11 |  78 | 12 |  85 |   B C D |   B |   C |  .00124456 |
     |----------------------------------------------------------------|
     |             _stderr            |           _contr~t            |
     |           .45040696            |              C - B            |
     +----------------------------------------------------------------+

     +----------------------------------------------------------------+
  5. | study | d1 |  n1 | d2 |  n2 | _design | _t1 | _t2 |         _y |
     |     2 | 11 |  78 | 29 | 170 |   B C D |   B |   D |  .22533329 |
     |----------------------------------------------------------------|
     |             _stderr            |           _contr~t            |
     |           .38393935            |              D - B            |
     +----------------------------------------------------------------+

     +----------------------------------------------------------------+
  6. | study | d1 |  n1 | d2 |  n2 | _design | _t1 | _t2 |         _y |
     |     2 | 12 |  85 | 29 | 170 |   B C D |   C |   D |  .22408873 |
     |----------------------------------------------------------------|
     |             _stderr            |           _contr~t            |
     |            .3722995            |              D - C            |
     +----------------------------------------------------------------+

     +----------------------------------------------------------------+
  7. | study | d1 |  n1 | d2 |  n2 | _design | _t1 | _t2 |         _y |
     |     3 | 79 | 702 | 77 | 694 |     A B |   A |   B | -.01596494 |
     |----------------------------------------------------------------|
     |             _stderr            |           _contr~t            |
     |           .16991505            |              B - A            |
     +----------------------------------------------------------------+

. 
. network convert stan
Converting pairs to standard ...

. l if study<=3

     +---------------------------------------------------------------------+
  1. | study | d0 |  n0 | d1  |  n1  | d2  |  n2  | _design  |       _y_1  |
     |     1 |  9 | 140 | 23  | 140  | 10  | 138  |   A C D  |   1.051293  |
     |---------------------------------------------------------------------|
     |      _y_2 |    _S_1_1 |    _S_1_2 |    _S_2_2 | _contr~1 | _contr~2 |
     | .12852757 | .17076997 |  .1187447 |  .2265572 |    C - A |    D - A |
     +---------------------------------------------------------------------+

     +---------------------------------------------------------------------+
  2. | study | d0 |  n0 | d1  |  n1  | d2  |  n2  | _design  |       _y_1  |
     |     2 | 11 |  78 | 12  |  85  | 29  | 170  |   B C D  |  .00124456  |
     |---------------------------------------------------------------------|
     |      _y_2 |    _S_1_1 |    _S_1_2 |    _S_2_2 | _contr~1 | _contr~2 |
     | .22533329 | .20286643 | .10583446 | .14740942 |    C - B |    D - B |
     +---------------------------------------------------------------------+

     +---------------------------------------------------------------------+
  3. | study | d0 |  n0 | d1  |  n1  | d2  |  n2  | _design  |       _y_1  |
     |     3 | 79 | 702 | 77  | 694  |  .  |   .  |     A B  | -.01596494  |
     |---------------------------------------------------------------------|
     |      _y_2 |    _S_1_1 |    _S_1_2 |    _S_2_2 | _contr~1 | _contr~2 |
     |         . | .02887112 |         . |         . |    B - A |          |
     +---------------------------------------------------------------------+

. 
. network convert aug, large(1E5)
Converting standard to augmented ...

. l if study<=3

     +-----------------------------------------------------------------+
  1. | study | dB |  nB | dA |  nA | dC |  nC  | dD  |  nD  | _design  |
     |     1 |  . |   . |  9 | 140 | 23 | 140  | 10  | 138  |   A C D  |
     |-----------------------+-----------------------+-----------------|
     |      _y_A |      _y_C |      _y_D |    _S_A_A | _S_A_C | _S_A_D |
     |         0 |  1.051293 | .12852757 |    100000 | 100000 | 100000 |
     |-----------------------------------------------------------------|
     |         _S_C_C      |         _S_C_D      |         _S_D_D      |
     |      100000.17      |      100000.12      |      100000.23      |
     +-----------------------------------------------------------------+

     +-----------------------------------------------------------------+
  2. | study | dB |  nB | dA |  nA | dC |  nC  | dD  |  nD  | _design  |
     |     2 | 11 |  78 |  . |   . | 12 |  85  | 29  | 170  |   B C D  |
     |-----------------------+-----------------------+-----------------|
     |      _y_A |      _y_C |      _y_D |    _S_A_A | _S_A_C | _S_A_D |
     |         . | .00124456 | .22533329 |         . |      . |      . |
     |-----------------------------------------------------------------|
     |         _S_C_C      |         _S_C_D      |         _S_D_D      |
     |      .20286643      |      .10583446      |      .14740942      |
     +-----------------------------------------------------------------+

     +-----------------------------------------------------------------+
  3. | study | dB |  nB | dA |  nA | dC |  nC  | dD  |  nD  | _design  |
     |     3 | 77 | 694 | 79 | 702 |  . |   .  |  .  |   .  |     A B  |
     |-----------------------+-----------------------+-----------------|
     |      _y_A |      _y_C |      _y_D |    _S_A_A | _S_A_C | _S_A_D |
     | .01596494 |         . |         . | .02887112 |      . |      . |
     |-----------------------------------------------------------------|
     |         _S_C_C      |         _S_C_D      |         _S_D_D      |
     |              .      |              .      |              .      |
     +-----------------------------------------------------------------+

. 
. network convert pairs
Converting augmented to pairs ...

. l if study<=3

     +----------------------------------------------------------------+
  1. | study | d1 |  n1 | d2 |  n2 | _design | _t1 | _t2 |         _y |
     |     1 |  9 | 140 | 23 | 140 |   A C D |   A |   C |   1.051293 |
     |----------------------------------------------------------------|
     |             _stderr            |           _contr~t            |
     |           .41324323            |              C - A            |
     +----------------------------------------------------------------+

     +----------------------------------------------------------------+
  2. | study | d1 |  n1 | d2 |  n2 | _design | _t1 | _t2 |         _y |
     |     1 |  9 | 140 | 10 | 138 |   A C D |   A |   D |  .12852757 |
     |----------------------------------------------------------------|
     |             _stderr            |           _contr~t            |
     |           .47598025            |              D - A            |
     +----------------------------------------------------------------+

     +----------------------------------------------------------------+
  3. | study | d1 |  n1 | d2 |  n2 | _design | _t1 | _t2 |         _y |
     |     1 | 23 | 140 | 10 | 138 |   A C D |   C |   D | -.92276545 |
     |----------------------------------------------------------------|
     |             _stderr            |           _contr~t            |
     |           .39979716            |              D - C            |
     +----------------------------------------------------------------+

     +----------------------------------------------------------------+
  4. | study | d1 |  n1 | d2 |  n2 | _design | _t1 | _t2 |         _y |
     |     2 | 11 |  78 | 12 |  85 |   B C D |   B |   C |  .00124456 |
     |----------------------------------------------------------------|
     |             _stderr            |           _contr~t            |
     |           .45040696            |              C - B            |
     +----------------------------------------------------------------+

     +----------------------------------------------------------------+
  5. | study | d1 |  n1 | d2 |  n2 | _design | _t1 | _t2 |         _y |
     |     2 | 11 |  78 | 29 | 170 |   B C D |   B |   D |  .22533329 |
     |----------------------------------------------------------------|
     |             _stderr            |           _contr~t            |
     |           .38393935            |              D - B            |
     +----------------------------------------------------------------+

     +----------------------------------------------------------------+
  6. | study | d1 |  n1 | d2 |  n2 | _design | _t1 | _t2 |         _y |
     |     2 | 12 |  85 | 29 | 170 |   B C D |   C |   D |  .22408873 |
     |----------------------------------------------------------------|
     |             _stderr            |           _contr~t            |
     |            .3722995            |              D - C            |
     +----------------------------------------------------------------+

     +----------------------------------------------------------------+
  7. | study | d1 |  n1 | d2 |  n2 | _design | _t1 | _t2 |         _y |
     |     3 | 79 | 702 | 77 | 694 |     A B |   A |   B | -.01596494 |
     |----------------------------------------------------------------|
     |             _stderr            |           _contr~t            |
     |           .16991505            |              B - A            |
     +----------------------------------------------------------------+

. 
. network convert stan
Converting pairs to standard ...

. l if study<=3

     +---------------------------------------------------------------------+
  1. | study | d0 |  n0 | d1  |  n1  | d2  |  n2  | _design  |       _y_1  |
     |     1 |  9 | 140 | 23  | 140  | 10  | 138  |   A C D  |   1.051293  |
     |---------------------------------------------------------------------|
     |      _y_2 |    _S_1_1 |    _S_1_2 |    _S_2_2 | _contr~1 | _contr~2 |
     | .12852757 | .17076997 |  .1187447 |  .2265572 |    C - A |    D - A |
     +---------------------------------------------------------------------+

     +---------------------------------------------------------------------+
  2. | study | d0 |  n0 | d1  |  n1  | d2  |  n2  | _design  |       _y_1  |
     |     2 | 11 |  78 | 12  |  85  | 29  | 170  |   B C D  |  .00124456  |
     |---------------------------------------------------------------------|
     |      _y_2 |    _S_1_1 |    _S_1_2 |    _S_2_2 | _contr~1 | _contr~2 |
     | .22533329 | .20286643 | .10583446 | .14740942 |    C - B |    D - B |
     +---------------------------------------------------------------------+

     +---------------------------------------------------------------------+
  3. | study | d0 |  n0 | d1  |  n1  | d2  |  n2  | _design  |       _y_1  |
     |     3 | 79 | 702 | 77  | 694  |  .  |   .  |     A B  | -.01596494  |
     |---------------------------------------------------------------------|
     |      _y_2 |    _S_1_1 |    _S_1_2 |    _S_2_2 | _contr~1 | _contr~2 |
     |         . | .02887112 |         . |         . |    B - A |          |
     +---------------------------------------------------------------------+

. 
. cf _all using z, verbose

. 
. 
. // check network meta: aug & std, multi-arm trials
. use smoking, clear
(Smoking data from Lu & Ades (2006))

. keep study trt d n

. network setup d n, studyvar(stud) trtvar(trt) format(aug) ref(Self help)
Treatments used
   A:                                  No contact
   B (reference):                      Self help
   C:                                  Individual counselling
   D:                                  Group counselling

Measure                                Log odds ratio

Studies
   ID variable:                        study
   Number used:                        24
   IDs with zero cells:                9 20
   - count added to all their cells:   .5
   IDs with augmented reference arm:   1 6 7 8 9 10 11 12 13 14 15 16 17 18 19 
> 20 23 24
   - observations added:               0.00001
   - mean in augmented observations:   study-specific mean

Network information                    
   Components:                         1 (connected)
   D.f. for inconsistency:             7
   D.f. for heterogeneity:             16

Current data
   Data format:                        augmented
   Design variable:                    _design
   Estimate variables:                 _y*
   Variance variables:                 _S*
   Command to list the data:           list study _y* _S*, noo sepby(_design)

. network table

----------------------------------------------------------------
          |               Treatment and Statistic               
          | - Self h -    - No con -    - Indivi -    - Group  -
    study |    d     n       d     n       d     n       d     n
----------+-----------------------------------------------------
        1 |                  9   140      23   140      10   138
        2 |   11    78                    12    85      29   170
        3 |   77   694      79   702                            
        4 |   21   535      18   671                            
        5 |   19   146       8   116                            
        6 |                 75   731     363   714              
        7 |                  2   106       9   205              
        8 |                 58   549     237  1561              
        9 |                 .5    34     9.5    49              
       10 |                  3   100      31    98              
       11 |                  1    31      26    95              
       12 |                  6    39      17    77              
       13 |                 95  1107     134  1031              
       14 |                 15   187      35   504              
       15 |                 78   584      73   675              
       16 |                 69  1177      54   888              
       17 |                 64   642     107   761              
       18 |                  5    62       8    90              
       19 |                 20   234      34   237              
       20 |                 .5    21                   9.5    21
       21 |   20    49                    16    43              
       22 |    7    66                                  32   127
       23 |                               12    76      20    74
       24 |                                9    55       3    26
----------------------------------------------------------------

. 
. network meta c, print(bscov)
Command is: mvmeta _y _S , print(bscov) bscovariance(exch 0.5) longparm suppres
> s(uv mm) vars(_y_A _y_C _y_D)
Note: using method reml
Note: using variables _y_A _y_C _y_D
Note: 24 observations on 3 variables
Note: variance-covariance matrix is proportional to .5*I(3)+.5*J(3,3,1)

initial:       log likelihood = -174.66976
rescale:       log likelihood = -174.66976
rescale eq:    log likelihood = -174.45531
Iteration 0:   log likelihood = -174.45531  
Iteration 1:   log likelihood = -173.04376  
Iteration 2:   log likelihood = -173.01544  
Iteration 3:   log likelihood = -173.01509  
Iteration 4:   log likelihood = -173.01509  

Multivariate meta-analysis
Variance-covariance matrix = proportional .5*I(3)+.5*J(3,3,1)
Method = reml                                  Number of dimensions    =     3
Restricted log likelihood = -173.01509         Number of observations  =    24
------------------------------------------------------------------------------
             |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
_y_A         |
       _cons |   -.398449    .331104    -1.20   0.229    -1.047401     .250503
-------------+----------------------------------------------------------------
_y_C         |
       _cons |   .3039067   .3405169     0.89   0.372    -.3634943    .9713076
-------------+----------------------------------------------------------------
_y_D         |
       _cons |   .4674414   .4074051     1.15   0.251     -.331058    1.265941
------------------------------------------------------------------------------

Estimated between-studies covariance matrix Sigma:
           _y_A       _y_C       _y_D
_y_A  .45490558
_y_C  .22745279  .45490558
_y_D  .22745279  .22745279  .45490558
mvmeta command stored as F9

. local tau = [tau]_b[_cons]

. 
. network compare
Table of log odds ratio and its standard error for Treatment vs. Comparator:
-------------------------------------------
           |           Treatment           
Comparator |      A       B       C       D
-----------+-------------------------------
         A |          0.398   0.702   0.866
           |          0.331   0.199   0.376
           | 
         B | -0.398           0.304   0.467
           |  0.331           0.341   0.407
           | 
         C | -0.702  -0.304           0.164
           |  0.199   0.341           0.355
           | 
         D | -0.866  -0.467  -0.164        
           |  0.376   0.407   0.355        
-------------------------------------------

. network compare, eform format(%6.2f) saving(z) replace level(99)
Table of exponentiated log odds ratio (and its 99% CI) for Treatment vs. Compar
> ator:
---------------------------------------------------------------
           |                     Treatment                     
Comparator |           A            B            C            D
-----------+---------------------------------------------------
         A |                     1.49         2.02         2.38
           |              (0.63,3.49)  (1.21,3.37)  (0.90,6.27)
           | 
         B |        0.67                      1.36         1.60
           | (0.29,1.58)               (0.56,3.26)  (0.56,4.56)
           | 
         C |        0.50         0.74                      1.18
           | (0.30,0.83)  (0.31,1.77)               (0.47,2.94)
           | 
         D |        0.42         0.63         0.85             
           | (0.16,1.11)  (0.22,1.79)  (0.34,2.12)             
---------------------------------------------------------------

. preserve

. network compare, clear
Table of log odds ratio and its standard error for Treatment vs. Comparator:
-------------------------------------------
           |           Treatment           
Comparator |      A       B       C       D
-----------+-------------------------------
         A |          0.398   0.702   0.866
           |          0.331   0.199   0.376
           | 
         B | -0.398           0.304   0.467
           |  0.331           0.341   0.407
           | 
         C | -0.702  -0.304           0.164
           |  0.199   0.341           0.355
           | 
         D | -0.866  -0.467  -0.164        
           |  0.376   0.407   0.355        
-------------------------------------------
Comparison data are now loaded into memory
Use F9 to redisplay them

. restore

. 
. 
. network convert st
Converting augmented to standard ...

. network meta c, print(bscov)
Command is: mvmeta _y _S , print(bscov) bscovariance(exch 0.5) commonparm nocon
> stant suppress(uv mm) eq(_y_1: _trtdiff1_A _trtdiff1_C _trtdiff1_D, _y_2: _tr
> tdiff2_A _trtdiff2_C _trtdiff2_D) vars(_y_1 _y_2)
Note: using method reml
Note: regressing _y_1 on _trtdiff1_A _trtdiff1_C _trtdiff1_D
Note: regressing _y_2 on _trtdiff2_A _trtdiff2_C _trtdiff2_D
Note: 24 observations on 2 variables
Note: variance-covariance matrix is proportional to .5*I(2)+.5*J(2,2,1)

initial:       log likelihood = -34.471727
rescale:       log likelihood = -34.471727
rescale eq:    log likelihood = -34.259312
Iteration 0:   log likelihood = -34.259312  
Iteration 1:   log likelihood =  -32.84443  
Iteration 2:   log likelihood = -32.817175  
Iteration 3:   log likelihood = -32.817057  
Iteration 4:   log likelihood = -32.817057  

Multivariate meta-analysis
Variance-covariance matrix = proportional .5*I(2)+.5*J(2,2,1)
Method = reml                                  Number of dimensions    =     2
Restricted log likelihood = -32.817057         Number of observations  =    24
------------------------------------------------------------------------------
             |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
_y_1         |
 _trtdiff1_A |  -.3984487   .3311044    -1.20   0.229    -1.047401     .250504
 _trtdiff1_C |   .3039069   .3405171     0.89   0.372    -.3634944    .9713082
 _trtdiff1_D |   .4674415   .4074053     1.15   0.251    -.3310581    1.265941
------------------------------------------------------------------------------
The above coefficients also apply to the following equations:
    _y_2: _trtdiff2_A _trtdiff2_C _trtdiff2_D 

Estimated between-studies covariance matrix Sigma:
           _y_1       _y_2
_y_1  .45490489
_y_2  .22745245  .45490489
mvmeta command stored as F9

. local reldiff = 100*([tau]_b[_cons]/`tau'-1)

. di "reldiff = " `reldiff' "% (" [tau]_b[_cons] " vs. " `tau' ")"
reldiff = -.00007588% (.67446638 vs. .67446689)

. if abs(`reldiff')>0.01 exit 99

. 
. 
. network convert aug
Converting standard to augmented ...

. network meta c, print(bscov)
Command is: mvmeta _y _S , print(bscov) bscovariance(exch 0.5) longparm suppres
> s(uv mm) vars(_y_A _y_C _y_D)
Note: using method reml
Note: using variables _y_A _y_C _y_D
Note: 24 observations on 3 variables
Note: variance-covariance matrix is proportional to .5*I(3)+.5*J(3,3,1)

initial:       log likelihood = -154.62907
rescale:       log likelihood = -154.62907
rescale eq:    log likelihood = -154.41452
Iteration 0:   log likelihood = -154.41452  
Iteration 1:   log likelihood = -153.00296  
Iteration 2:   log likelihood = -152.97448  
Iteration 3:   log likelihood = -152.97434  
Iteration 4:   log likelihood = -152.97434  

Multivariate meta-analysis
Variance-covariance matrix = proportional .5*I(3)+.5*J(3,3,1)
Method = reml                                  Number of dimensions    =     3
Restricted log likelihood = -152.97434         Number of observations  =    24
------------------------------------------------------------------------------
             |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
_y_A         |
       _cons |  -.3984419   .3311004    -1.20   0.229    -1.047387    .2505029
-------------+----------------------------------------------------------------
_y_C         |
       _cons |   .3039126   .3405134     0.89   0.372    -.3634815    .9713067
-------------+----------------------------------------------------------------
_y_D         |
       _cons |   .4674453   .4074029     1.15   0.251    -.3310497     1.26594
------------------------------------------------------------------------------

Estimated between-studies covariance matrix Sigma:
           _y_A       _y_C       _y_D
_y_A  .45490132
_y_C  .22745066  .45490132
_y_D  .22745066  .22745066  .45490132
mvmeta command stored as F9

. local reldiff = 100*([tau]_b[_cons]/`tau'-1)

. di "reldiff = " `reldiff' "% (" [tau]_b[_cons] " vs. " `tau' ")"
reldiff = -.00046882% (.67446373 vs. .67446689)

. if abs(`reldiff')>0.01 exit 99

. 
. 
. network meta i, print(bscov)
Command is: mvmeta _y _S , print(bscov) bscovariance(exch 0.5) longparm suppres
> s(uv mm) eq(_y_C: des_ACD des_BC des_BCD, _y_D: des_AD des_BCD des_BD des_CD)
>  vars(_y_A _y_C _y_D)
Note: using method reml
Note: regressing _y_A on (nothing)
Note: regressing _y_C on des_ACD des_BC des_BCD
Note: regressing _y_D on des_AD des_BCD des_BD des_CD
Note: 24 observations on 3 variables
Note: variance-covariance matrix is proportional to .5*I(3)+.5*J(3,3,1)

initial:       log likelihood = -144.53879
rescale:       log likelihood = -144.53879
rescale eq:    log likelihood = -144.53879
Iteration 0:   log likelihood = -144.53879  
Iteration 1:   log likelihood = -143.81158  
Iteration 2:   log likelihood = -143.81088  
Iteration 3:   log likelihood = -143.81088  

Multivariate meta-analysis
Variance-covariance matrix = proportional .5*I(3)+.5*J(3,3,1)
Method = reml                                  Number of dimensions    =     3
Restricted log likelihood = -143.81088         Number of observations  =    24
------------------------------------------------------------------------------
             |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
_y_A         |
       _cons |  -.3300531   .4675715    -0.71   0.480    -1.246476    .5863702
-------------+----------------------------------------------------------------
_y_C         |
     des_ACD |   .3468153   .8821468     0.39   0.694    -1.382161    2.075791
      des_BC |  -.5261101   1.004547    -0.52   0.600    -2.494986    1.442766
     des_BCD |   -.373181   1.013884    -0.37   0.713    -2.360358    1.613996
       _cons |   .3744255   .5223142     0.72   0.473    -.6492916    1.398143
-------------+----------------------------------------------------------------
_y_D         |
      des_AD |   3.393989   1.890006     1.80   0.073    -.3103538    7.098332
     des_BCD |   .4268579   1.302748     0.33   0.743    -2.126482    2.980198
      des_BD |   1.245011   1.323377     0.94   0.347     -1.34876    3.838782
      des_CD |    .817883   1.123168     0.73   0.466    -1.383485    3.019251
       _cons |  -.2015246   .9987298    -0.20   0.840    -2.158999     1.75595
------------------------------------------------------------------------------

Estimated between-studies covariance matrix Sigma:
           _y_A       _y_C       _y_D
_y_A  .55228287
_y_C  .27614144  .55228287
_y_D  .27614144  .27614144  .55228287

Testing for inconsistency:
 ( 1)  [_y_C]des_ACD = 0
 ( 2)  [_y_D]des_AD = 0
 ( 3)  [_y_C]des_BC = 0
 ( 4)  [_y_C]des_BCD = 0
 ( 5)  [_y_D]des_BCD = 0
 ( 6)  [_y_D]des_BD = 0
 ( 7)  [_y_D]des_CD = 0

           chi2(  7) =    5.11
         Prob > chi2 =    0.6464
mvmeta command stored as F9; test command stored as F8

. local tau = [tau]_b[_cons]

. 
. network convert st
Converting augmented to standard ...

. network meta i, print(bscov)
Command is: mvmeta _y _S , print(bscov) bscovariance(exch 0.5) commonparm nocon
> stant suppress(uv mm) eq(_y_1: _trtdiff1_A _trtdiff1_C _trtdiff1_D _trtdiff1_
> C_des_ACD _trtdiff1_D_des_AD _trtdiff1_C_des_BC _trtdiff1_C_des_BCD _trtdiff1
> _D_des_BCD _trtdiff1_D_des_BD _trtdiff1_D_des_CD, _y_2: _trtdiff2_A _trtdiff2
> _C _trtdiff2_D _trtdiff2_C_des_ACD _trtdiff2_D_des_AD _trtdiff2_C_des_BC _trt
> diff2_C_des_BCD _trtdiff2_D_des_BCD _trtdiff2_D_des_BD _trtdiff2_D_des_CD) va
> rs(_y_1 _y_2)
Note: using method reml
Note: regressing _y_1 on _trtdiff1_A _trtdiff1_C _trtdiff1_D _trtdiff1_C_des_AC
> D _trtdiff1_D_des_AD _trtdiff1_C_des_BC _trtdiff1_C_des_BCD _trtdiff1_D_des_B
> CD _trtdiff1_D_des_BD _trtdiff1_D_des_CD
Note: regressing _y_2 on _trtdiff2_A _trtdiff2_C _trtdiff2_D _trtdiff2_C_des_AC
> D _trtdiff2_D_des_AD _trtdiff2_C_des_BC _trtdiff2_C_des_BCD _trtdiff2_D_des_B
> CD _trtdiff2_D_des_BD _trtdiff2_D_des_CD
Note: 24 observations on 2 variables
Note: variance-covariance matrix is proportional to .5*I(2)+.5*J(2,2,1)

initial:       log likelihood = -24.381433
rescale:       log likelihood = -24.381433
rescale eq:    log likelihood = -24.381433
Iteration 0:   log likelihood = -24.381433  
Iteration 1:   log likelihood = -23.654259  
Iteration 2:   log likelihood = -23.653575  
Iteration 3:   log likelihood = -23.653575  

Multivariate meta-analysis
Variance-covariance matrix = proportional .5*I(2)+.5*J(2,2,1)
Method = reml                                  Number of dimensions    =     2
Restricted log likelihood = -23.653575         Number of observations  =    24
------------------------------------------------------------------------------
             |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
_y_1         |
 _trtdiff1_A |  -.3300634   .4675836    -0.71   0.480     -1.24651    .5863837
 _trtdiff1_C |   .3744161   .5223271     0.72   0.473    -.6493263    1.398158
 _trtdiff1_D |  -.2015358   .9987404    -0.20   0.840    -2.159031    1.755959
~1_C_des_ACD |   .3468136   .8821522     0.39   0.694    -1.382173      2.0758
_trtdiff1~AD |   3.393989    1.89001     1.80   0.073    -.3103628    7.098341
_trtdiff1~BC |  -.5261006   1.004558    -0.52   0.600    -2.494998    1.442796
~1_C_des_BCD |  -.3731715   1.013895    -0.37   0.713    -2.360369    1.614026
~1_D_des_BCD |   .4268691    1.30276     0.33   0.743    -2.126493    2.980231
_trtdiff1~BD |   1.245022   1.323388     0.94   0.347    -1.348771    3.838815
_~1_D_des_CD |   .8178847   1.123174     0.73   0.466    -1.383496    3.019265
------------------------------------------------------------------------------
The above coefficients also apply to the following equations:
    _y_2: _trtdiff2_A _trtdiff2_C _trtdiff2_D _trtdiff2_C_des_ACD _trtdiff2_D_d
> es_AD _trtdiff2_C_des_BC _trtdiff2_C_des_BCD _trtdiff2_D_des_BCD _trtdiff2_D_
> des_BD _trtdiff2_D_des_CD 

Estimated between-studies covariance matrix Sigma:
           _y_1       _y_2
_y_1  .55229068
_y_2  .27614534  .55229068

Testing for inconsistency:
 ( 1)  [_y_1]_trtdiff1_C_des_ACD = 0
 ( 2)  [_y_1]_trtdiff1_D_des_AD = 0
 ( 3)  [_y_1]_trtdiff1_C_des_BC = 0
 ( 4)  [_y_1]_trtdiff1_C_des_BCD = 0
 ( 5)  [_y_1]_trtdiff1_D_des_BCD = 0
 ( 6)  [_y_1]_trtdiff1_D_des_BD = 0
 ( 7)  [_y_1]_trtdiff1_D_des_CD = 0

           chi2(  7) =    5.11
         Prob > chi2 =    0.6464
mvmeta command stored as F9; test command stored as F8

. local reldiff = 100*([tau]_b[_cons]/`tau'-1)

. di "reldiff = " `reldiff' "% (" [tau]_b[_cons] " vs. " `tau' ")"
reldiff = .00070686% (.74316262 vs. .74315737)

. if abs(`reldiff')>0.01 exit 99

.         // tau = 0.55296504
. 
. 
. network convert aug
Converting standard to augmented ...

. network meta i, print(bscov)
Command is: mvmeta _y _S , print(bscov) bscovariance(exch 0.5) longparm suppres
> s(uv mm) eq(_y_C: des_ACD des_BC des_BCD, _y_D: des_AD des_BCD des_BD des_CD)
>  vars(_y_A _y_C _y_D)
Note: using method reml
Note: regressing _y_A on (nothing)
Note: regressing _y_C on des_ACD des_BC des_BCD
Note: regressing _y_D on des_AD des_BCD des_BD des_CD
Note: 24 observations on 3 variables
Note: variance-covariance matrix is proportional to .5*I(3)+.5*J(3,3,1)

initial:       log likelihood = -144.53879
rescale:       log likelihood = -144.53879
rescale eq:    log likelihood = -144.53879
Iteration 0:   log likelihood = -144.53879  
Iteration 1:   log likelihood = -143.81158  
Iteration 2:   log likelihood = -143.81088  
Iteration 3:   log likelihood = -143.81088  

Multivariate meta-analysis
Variance-covariance matrix = proportional .5*I(3)+.5*J(3,3,1)
Method = reml                                  Number of dimensions    =     3
Restricted log likelihood = -143.81088         Number of observations  =    24
------------------------------------------------------------------------------
             |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
_y_A         |
       _cons |  -.3300531   .4675715    -0.71   0.480    -1.246476    .5863702
-------------+----------------------------------------------------------------
_y_C         |
     des_ACD |   .3468153   .8821468     0.39   0.694    -1.382161    2.075791
      des_BC |  -.5261101   1.004547    -0.52   0.600    -2.494986    1.442766
     des_BCD |   -.373181   1.013884    -0.37   0.713    -2.360358    1.613996
       _cons |   .3744255   .5223142     0.72   0.473    -.6492916    1.398143
-------------+----------------------------------------------------------------
_y_D         |
      des_AD |   3.393989   1.890006     1.80   0.073    -.3103538    7.098332
     des_BCD |   .4268579   1.302748     0.33   0.743    -2.126482    2.980198
      des_BD |   1.245011   1.323377     0.94   0.347     -1.34876    3.838782
      des_CD |    .817883   1.123168     0.73   0.466    -1.383485    3.019251
       _cons |  -.2015246   .9987298    -0.20   0.840    -2.158999     1.75595
------------------------------------------------------------------------------

Estimated between-studies covariance matrix Sigma:
           _y_A       _y_C       _y_D
_y_A  .55228287
_y_C  .27614144  .55228287
_y_D  .27614144  .27614144  .55228287

Testing for inconsistency:
 ( 1)  [_y_C]des_ACD = 0
 ( 2)  [_y_D]des_AD = 0
 ( 3)  [_y_C]des_BC = 0
 ( 4)  [_y_C]des_BCD = 0
 ( 5)  [_y_D]des_BCD = 0
 ( 6)  [_y_D]des_BD = 0
 ( 7)  [_y_D]des_CD = 0

           chi2(  7) =    5.11
         Prob > chi2 =    0.6464
mvmeta command stored as F9; test command stored as F8

. local reldiff = 100*([tau]_b[_cons]/`tau'-1)

. di "reldiff = " `reldiff' "% (" [tau]_b[_cons] " vs. " `tau' ")"
reldiff = 0% (.74315737 vs. .74315737)

. if abs(`reldiff')>0.01 exit 99

. 
. 
. * change reference treatment
. use smoking, clear
(Smoking data from Lu & Ades (2006))

. keep study trt d n

. network setup d n, studyvar(stud) trtvar(trt) format(aug) ref(Individual coun
> selling)
Treatments used
   A:                                  No contact
   B:                                  Self help
   C (reference):                      Individual counselling
   D:                                  Group counselling

Measure                                Log odds ratio

Studies
   ID variable:                        study
   Number used:                        24
   IDs with zero cells:                9 20
   - count added to all their cells:   .5
   IDs with augmented reference arm:   3 4 5 20 22
   - observations added:               0.00001
   - mean in augmented observations:   study-specific mean

Network information                    
   Components:                         1 (connected)
   D.f. for inconsistency:             7
   D.f. for heterogeneity:             16

Current data
   Data format:                        augmented
   Design variable:                    _design
   Estimate variables:                 _y*
   Variance variables:                 _S*
   Command to list the data:           list study _y* _S*, noo sepby(_design)

. network meta i, print(bscov)
Command is: mvmeta _y _S , print(bscov) bscovariance(exch 0.5) longparm suppres
> s(uv mm) eq(_y_A: des_ACD, _y_B: des_BC des_BCD, _y_D: des_AD des_BCD des_BD 
> des_CD) vars(_y_A _y_B _y_D)
Note: using method reml
Note: regressing _y_A on des_ACD
Note: regressing _y_B on des_BC des_BCD
Note: regressing _y_D on des_AD des_BCD des_BD des_CD
Note: 24 observations on 3 variables
Note: variance-covariance matrix is proportional to .5*I(3)+.5*J(3,3,1)

initial:       log likelihood = -63.602216
rescale:       log likelihood = -63.602216
rescale eq:    log likelihood = -63.602216
Iteration 0:   log likelihood = -63.602216  
Iteration 1:   log likelihood = -62.875022  
Iteration 2:   log likelihood = -62.874357  
Iteration 3:   log likelihood = -62.874357  

Multivariate meta-analysis
Variance-covariance matrix = proportional .5*I(3)+.5*J(3,3,1)
Method = reml                                  Number of dimensions    =     3
Restricted log likelihood = -62.874357         Number of observations  =    24
------------------------------------------------------------------------------
             |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
_y_A         |
     des_ACD |  -.3468134    .882152    -0.39   0.694    -2.075799    1.382173
       _cons |  -.7044796   .2347999    -3.00   0.003    -1.164679   -.2442802
-------------+----------------------------------------------------------------
_y_B         |
      des_BC |   .5261009   1.004558     0.52   0.600    -1.442796    2.494998
     des_BCD |   .3731717   1.013895     0.37   0.713    -1.614026    2.360369
       _cons |  -.3744163   .5223268    -0.72   0.473    -1.398158    .6493254
-------------+----------------------------------------------------------------
_y_D         |
      des_AD |   3.740795    1.88694     1.98   0.047     .0424613    7.439128
     des_BCD |   1.146854   1.184494     0.97   0.333    -1.174712     3.46842
      des_BD |   1.591835   1.318646     1.21   0.227    -.9926633    4.176334
      des_CD |   1.164698   1.068675     1.09   0.276    -.9298657    3.259262
       _cons |  -.9227655   .8438772    -1.09   0.274    -2.576734    .7312035
------------------------------------------------------------------------------

Estimated between-studies covariance matrix Sigma:
           _y_A       _y_B       _y_D
_y_A  .55229114
_y_B  .27614557  .55229114
_y_D  .27614557  .27614557  .55229114

Testing for inconsistency:
 ( 1)  [_y_A]des_ACD = 0
 ( 2)  [_y_D]des_AD = 0
 ( 3)  [_y_B]des_BC = 0
 ( 4)  [_y_B]des_BCD = 0
 ( 5)  [_y_D]des_BCD = 0
 ( 6)  [_y_D]des_BD = 0
 ( 7)  [_y_D]des_CD = 0

           chi2(  7) =    5.11
         Prob > chi2 =    0.6464
mvmeta command stored as F9; test command stored as F8

. local reldiff = 100*([tau]_b[_cons]/`tau'-1)

. di "reldiff = " `reldiff' "% (" [tau]_b[_cons] " vs. " `tau' ")"
reldiff = .00074839% (.74316293 vs. .74315737)

. if abs(`reldiff')>0.01 exit 99

. 
. 
. // check network meta: aug, std & pairs, only two-arm trials
. use "coronary artery disease pairwise", clear

. network import, tr(t1 t2) eff(logOR) study(study) stderr(se) 
Importing from pairs format
Reference treatment: BMS
All treatments: BMS DES MT PTCA

. 
. network meta c, z
Warning: can't check for disconnected network
Warning: can't check df for inconsistency
Warning: can't check df for heterogeneity
Command is: metareg logOR _trtdiff_DES _trtdiff_MT _trtdiff_PTCA , z wsse(selog
> OR) noconstant

Meta-regression                                       Number of obs  =      62
REML estimate of between-study variance               tau2           =       0
% residual variation due to heterogeneity             I-squared_res  =   0.00%
Joint test for all covariates                         Model chi2(3)  =    0.95
Without Knapp-Hartung modification                    Prob > chi2    =  0.8126
------------------------------------------------------------------------------
       logOR |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
_trtdiff_DES |  -.0804465   .2060468    -0.39   0.696    -.4842909    .3233979
 _trtdiff_MT |  -.0804069   .0995168    -0.81   0.419    -.2754563    .1146426
_trtdiff_P~A |   .0007112   .1243693     0.01   0.995    -.2430482    .2444706
------------------------------------------------------------------------------
mvmeta command stored as F9

. 
. network conv st
Converting pairs to standard ...

. network meta c, nounc print(bscov)
Warning: can't check for disconnected network
Warning: can't check df for inconsistency
Warning: can't check df for heterogeneity
Command is: mvmeta logOR _S , nounc print(bscov) bscovariance(exch 0.5) commonp
> arm noconstant suppress(uv mm) eq(logOR_1: _trtdiff1_DES _trtdiff1_MT _trtdif
> f1_PTCA) vars(logOR_1)
Note: using method reml
Note: regressing logOR_1 on _trtdiff1_DES _trtdiff1_MT _trtdiff1_PTCA
Note: 62 observations on 1 variables
Note: variance-covariance matrix is proportional to .5*I(1)+.5*J(1,1,1)

initial:       log likelihood = -92.637963
rescale:       log likelihood = -80.586716
rescale eq:    log likelihood = -80.368328
Iteration 0:   log likelihood = -80.368328  
Iteration 1:   log likelihood =  -80.15459  
Iteration 2:   log likelihood = -80.154586  

Multivariate meta-analysis
Variance-covariance matrix = proportional .5*I(1)+.5*J(1,1,1)
Method = reml                                  Number of dimensions    =     1
Restricted log likelihood = -80.154586         Number of observations  =    62
------------------------------------------------------------------------------
             |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
logOR_1      |
_trtdiff1_~S |  -.0804466   .2060468    -0.39   0.696    -.4842909    .3233978
_trtdiff1_MT |  -.0804065   .0995168    -0.81   0.419     -.275456    .1146429
_trtdiff1_~A |   .0007113   .1243693     0.01   0.995    -.2430481    .2444707
------------------------------------------------------------------------------
Note: these standard errors ignore uncertainty in Sigma.

Estimated between-studies covariance matrix Sigma:
           logOR_1
logOR_1  1.117e-16
mvmeta command stored as F9

. network compare
Table of (unidentified measure) and its standard error for Treatment vs. Compar
> ator:
-------------------------------------------
           |           Treatment           
Comparator |    BMS     DES      MT    PTCA
-----------+-------------------------------
       BMS |         -0.080  -0.080   0.001
           |          0.206   0.100   0.124
           | 
       DES |  0.080           0.000   0.081
           |  0.206           0.229   0.241
           | 
        MT |  0.080  -0.000           0.081
           |  0.100   0.229           0.122
           | 
      PTCA | -0.001  -0.081  -0.081        
           |  0.124   0.241   0.122        
-------------------------------------------

. 
. network conv aug
Converting standard to augmented ...

. network meta c, nounc print(bscov)
Warning: can't check for disconnected network
Warning: can't check df for inconsistency
Warning: can't check df for heterogeneity
Command is: mvmeta logOR _S , nounc print(bscov) bscovariance(exch 0.5) longpar
> m suppress(uv mm) vars(logOR_DES logOR_MT logOR_PTCA)
Note: using method reml
Note: using variables logOR_DES logOR_MT logOR_PTCA
Note: 62 observations on 3 variables
Note: variance-covariance matrix is proportional to .5*I(3)+.5*J(3,3,1)

initial:       log likelihood = -159.39203
rescale:       log likelihood = -147.34073
rescale eq:    log likelihood = -146.93803
Iteration 0:   log likelihood = -146.93803  
Iteration 1:   log likelihood = -146.90884  
Iteration 2:   log likelihood =  -146.9086  
Iteration 3:   log likelihood =  -146.9086  

Multivariate meta-analysis
Variance-covariance matrix = proportional .5*I(3)+.5*J(3,3,1)
Method = reml                                  Number of dimensions    =     3
Restricted log likelihood = -146.9086          Number of observations  =    62
------------------------------------------------------------------------------
             |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
logOR_DES    |
       _cons |  -.0804465   .2060468    -0.39   0.696    -.4842909    .3233979
-------------+----------------------------------------------------------------
logOR_MT     |
       _cons |  -.0804068   .0995168    -0.81   0.419    -.2754561    .1146426
-------------+----------------------------------------------------------------
logOR_PTCA   |
       _cons |   .0007112   .1243693     0.01   0.995    -.2430482    .2444706
------------------------------------------------------------------------------
Note: these standard errors ignore uncertainty in Sigma.

Estimated between-studies covariance matrix Sigma:
             logOR_DES    logOR_MT  logOR_PTCA
 logOR_DES   2.301e-17
  logOR_MT   1.150e-17   2.301e-17
logOR_PTCA   1.150e-17   1.150e-17   2.301e-17
mvmeta command stored as F9

. 
. network conv pairs
Converting augmented to pairs ...

. network meta i, z
Warning: can't check for disconnected network
Warning: can't check df for inconsistency
Warning: can't check df for heterogeneity
Command is: metareg logOR _trtdiff_DES _trtdiff_MT _trtdiff_PTCA _trtdiff_PTCA_
> des_MTPTCA , z wsse(selogOR) noconstant

Meta-regression                                       Number of obs  =      62
REML estimate of between-study variance               tau2           =       0
% residual variation due to heterogeneity             I-squared_res  =   0.00%
Joint test for all covariates                         Model chi2(4)  =    1.62
Without Knapp-Hartung modification                    Prob > chi2    =  0.8058
------------------------------------------------------------------------------
       logOR |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
_trtdiff_DES |  -.0804465   .2060468    -0.39   0.696    -.4842909    .3233979
 _trtdiff_MT |  -.0405719   .1108774    -0.37   0.714    -.2578876    .1767438
_trtdi~_PTCA |  -.0867013    .164247    -0.53   0.598    -.4086195     .235217
_trtdi~TPTCA |   .2048885   .2514604     0.81   0.415    -.2879648    .6977417
------------------------------------------------------------------------------

Testing for inconsistency:
 ( 1)  _trtdiff_PTCA_des_MTPTCA = 0

           chi2(  1) =    0.66
         Prob > chi2 =    0.4152
mvmeta command stored as F9; test command stored as F8

. 
. network conv st
Converting pairs to standard ...

. network meta i, nounc print(bscov)
Warning: can't check for disconnected network
Warning: can't check df for inconsistency
Warning: can't check df for heterogeneity
Command is: mvmeta logOR _S , nounc print(bscov) bscovariance(exch 0.5) commonp
> arm noconstant suppress(uv mm) eq(logOR_1: _trtdiff1_DES _trtdiff1_MT _trtdif
> f1_PTCA _trtdiff1_PTCA_des_MTPTCA) vars(logOR_1)
Note: using method reml
Note: regressing logOR_1 on _trtdiff1_DES _trtdiff1_MT _trtdiff1_PTCA _trtdiff1
> _PTCA_des_MTPTCA
Note: 62 observations on 1 variables
Note: variance-covariance matrix is proportional to .5*I(1)+.5*J(1,1,1)

initial:       log likelihood = -91.762224
rescale:       log likelihood = -81.007946
rescale eq:    log likelihood = -80.777554
Iteration 0:   log likelihood = -80.777554  
Iteration 1:   log likelihood = -80.330406  
Iteration 2:   log likelihood = -80.284174  
Iteration 3:   log likelihood = -80.284173  

Multivariate meta-analysis
Variance-covariance matrix = proportional .5*I(1)+.5*J(1,1,1)
Method = reml                                  Number of dimensions    =     1
Restricted log likelihood = -80.284173         Number of observations  =    62
------------------------------------------------------------------------------
             |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
logOR_1      |
_trtdiff1_~S |  -.0804465   .2060468    -0.39   0.696    -.4842909    .3233979
_trtdiff1_MT |   -.040572   .1108774    -0.37   0.714    -.2578877    .1767437
_trtdi~_PTCA |  -.0867012    .164247    -0.53   0.598    -.4086195     .235217
_trtdi~TPTCA |   .2048881   .2514604     0.81   0.415    -.2879652    .6977413
------------------------------------------------------------------------------
Note: these standard errors ignore uncertainty in Sigma.

Estimated between-studies covariance matrix Sigma:
           logOR_1
logOR_1  5.661e-15

Testing for inconsistency:
 ( 1)  [logOR_1]_trtdiff1_PTCA_des_MTPTCA = 0

           chi2(  1) =    0.66
         Prob > chi2 =    0.4152
mvmeta command stored as F9; test command stored as F8

. 
. network conv aug
Converting standard to augmented ...

. network meta i, nounc print(bscov)
Warning: can't check for disconnected network
Warning: can't check df for inconsistency
Warning: can't check df for heterogeneity
Command is: mvmeta logOR _S , nounc print(bscov) bscovariance(exch 0.5) longpar
> m suppress(uv mm) eq(logOR_PTCA: des_MTPTCA) vars(logOR_DES logOR_MT logOR_PT
> CA)
Note: using method reml
Note: regressing logOR_DES on (nothing)
Note: regressing logOR_MT on (nothing)
Note: regressing logOR_PTCA on des_MTPTCA
Note: 62 observations on 3 variables
Note: variance-covariance matrix is proportional to .5*I(3)+.5*J(3,3,1)

initial:       log likelihood =  -158.5163
rescale:       log likelihood = -147.76196
rescale eq:    log likelihood = -147.10745
Iteration 0:   log likelihood = -147.10745  
Iteration 1:   log likelihood =  -147.0382  
Iteration 2:   log likelihood = -147.03819  

Multivariate meta-analysis
Variance-covariance matrix = proportional .5*I(3)+.5*J(3,3,1)
Method = reml                                  Number of dimensions    =     3
Restricted log likelihood = -147.03819         Number of observations  =    62
------------------------------------------------------------------------------
             |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
logOR_DES    |
       _cons |  -.0804471   .2060468    -0.39   0.696    -.4842915    .3233973
-------------+----------------------------------------------------------------
logOR_MT     |
       _cons |  -.0405726   .1108773    -0.37   0.714    -.2578882    .1767429
-------------+----------------------------------------------------------------
logOR_PTCA   |
  des_MTPTCA |   .2048839   .2514603     0.81   0.415    -.2879693    .6977371
       _cons |  -.0867008    .164247    -0.53   0.598     -.408619    .2352175
------------------------------------------------------------------------------
Note: these standard errors ignore uncertainty in Sigma.

Estimated between-studies covariance matrix Sigma:
             logOR_DES    logOR_MT  logOR_PTCA
 logOR_DES   7.134e-12
  logOR_MT   3.567e-12   7.134e-12
logOR_PTCA   3.567e-12   3.567e-12   7.134e-12

Testing for inconsistency:
 ( 1)  [logOR_PTCA]des_MTPTCA = 0

           chi2(  1) =    0.66
         Prob > chi2 =    0.4152
mvmeta command stored as F9; test command stored as F8

. 
. 
. // forest plot
. 
. use "coronary artery disease pairwise", clear

. network import, tr(t1 t2) eff(logOR) study(study) stderr(se) measure(mean dif
> f)
Importing from pairs format
Reference treatment: BMS
All treatments: BMS DES MT PTCA

. network conv aug
Converting pairs to augmented ...

. network meta c, 
Warning: can't check for disconnected network
Warning: can't check df for inconsistency
Warning: can't check df for heterogeneity
Command is: mvmeta logOR _S , bscovariance(exch 0.5) longparm suppress(uv mm) v
> ars(logOR_DES logOR_MT logOR_PTCA)
Note: using method reml
Note: using variables logOR_DES logOR_MT logOR_PTCA
Note: 62 observations on 3 variables
Note: variance-covariance matrix is proportional to .5*I(3)+.5*J(3,3,1)

initial:       log likelihood = -159.39203
rescale:       log likelihood = -147.34073
rescale eq:    log likelihood = -146.93803
Iteration 0:   log likelihood = -146.93803  
Iteration 1:   log likelihood = -146.90884  
Iteration 2:   log likelihood =  -146.9086  
Iteration 3:   log likelihood =  -146.9086  

Multivariate meta-analysis
Variance-covariance matrix = proportional .5*I(3)+.5*J(3,3,1)
Method = reml                                  Number of dimensions    =     3
Restricted log likelihood = -146.9086          Number of observations  =    62
------------------------------------------------------------------------------
             |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
logOR_DES    |
       _cons |  -.0804465   .2060468    -0.39   0.696    -.4842909    .3233979
-------------+----------------------------------------------------------------
logOR_MT     |
       _cons |  -.0804068   .0995168    -0.81   0.419    -.2754561    .1146426
-------------+----------------------------------------------------------------
logOR_PTCA   |
       _cons |   .0007112   .1243693     0.01   0.995    -.2430482    .2444706
------------------------------------------------------------------------------

Estimated between-studies SDs and correlation matrix:
                    SD   logOR_DES    logOR_MT  logOR_PTCA
 logOR_DES   4.797e-09           1           .           .
  logOR_MT   4.797e-09          .5           1           .
logOR_PTCA   4.797e-09          .5          .5           1
mvmeta command stored as F9

. network compare
Table of mean diff and its standard error for Treatment vs. Comparator:
-------------------------------------------
           |           Treatment           
Comparator |    BMS     DES      MT    PTCA
-----------+-------------------------------
       BMS |         -0.080  -0.080   0.001
           |          0.206   0.100   0.124
           | 
       DES |  0.080           0.000   0.081
           |  0.206           0.229   0.241
           | 
        MT |  0.080  -0.000           0.081
           |  0.100   0.229           0.122
           | 
      PTCA | -0.001  -0.081  -0.081        
           |  0.124   0.241   0.122        
-------------------------------------------

. network meta i, 
Warning: can't check for disconnected network
Warning: can't check df for inconsistency
Warning: can't check df for heterogeneity
Command is: mvmeta logOR _S , bscovariance(exch 0.5) longparm suppress(uv mm) e
> q(logOR_PTCA: des_MTPTCA) vars(logOR_DES logOR_MT logOR_PTCA)
Note: using method reml
Note: regressing logOR_DES on (nothing)
Note: regressing logOR_MT on (nothing)
Note: regressing logOR_PTCA on des_MTPTCA
Note: 62 observations on 3 variables
Note: variance-covariance matrix is proportional to .5*I(3)+.5*J(3,3,1)

initial:       log likelihood =  -158.5163
rescale:       log likelihood = -147.76196
rescale eq:    log likelihood = -147.10745
Iteration 0:   log likelihood = -147.10745  
Iteration 1:   log likelihood =  -147.0382  
Iteration 2:   log likelihood = -147.03819  

Multivariate meta-analysis
Variance-covariance matrix = proportional .5*I(3)+.5*J(3,3,1)
Method = reml                                  Number of dimensions    =     3
Restricted log likelihood = -147.03819         Number of observations  =    62
------------------------------------------------------------------------------
             |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
logOR_DES    |
       _cons |  -.0804471   .2060468    -0.39   0.696    -.4842915    .3233973
-------------+----------------------------------------------------------------
logOR_MT     |
       _cons |  -.0405726   .1108773    -0.37   0.714    -.2578882    .1767429
-------------+----------------------------------------------------------------
logOR_PTCA   |
  des_MTPTCA |   .2048839   .2514603     0.81   0.415    -.2879693    .6977371
       _cons |  -.0867008    .164247    -0.53   0.598     -.408619    .2352175
------------------------------------------------------------------------------

Estimated between-studies SDs and correlation matrix:
                    SD   logOR_DES    logOR_MT  logOR_PTCA
 logOR_DES   2.671e-06           1           .           .
  logOR_MT   2.671e-06          .5           1           .
logOR_PTCA   2.671e-06          .5          .5           1

Testing for inconsistency:
 ( 1)  [logOR_PTCA]des_MTPTCA = 0

           chi2(  1) =    0.66
         Prob > chi2 =    0.4152
mvmeta command stored as F9; test command stored as F8

. network forest, msize(*0.2)

. 
. 
. // Invented data to test network setup for quantitative data
. 
. clear

. input study str1 trt sbp sbpsd count

         study        trt        sbp      sbpsd      count
  1. 1 A 50 10 100
  2. 1 B 60 10 100
  3. 1 C 62 10 100
  4. 2 A 70 10 100
  5. 2 B 75 10 100
  6. 3 A 60 10  25
  7. 3 C 55 10  25
  8. end

. l

     +-----------------------------------+
     | study   trt   sbp   sbpsd   count |
     |-----------------------------------|
  1. |     1     A    50      10     100 |
  2. |     1     B    60      10     100 |
  3. |     1     C    62      10     100 |
  4. |     2     A    70      10     100 |
  5. |     2     B    75      10     100 |
     |-----------------------------------|
  6. |     3     A    60      10      25 |
  7. |     3     C    55      10      25 |
     +-----------------------------------+

. save zquant, replace
file zquant.dta saved

. network setup sbp sbpsd count, stud(study) trt(trt) smd
Treatments used
   A (reference):                      A
   B:                                  B
   C:                                  C

Measure                                Standardised mean difference
   Standard deviation pooling:         on

Studies
   ID variable:                        study
   Number used:                        3

Network information                    
   Components:                         1 (connected)
   D.f. for inconsistency:             2
   D.f. for heterogeneity:             0

Current data
   Data format:                        augmented
   Design variable:                    _design
   Estimate variables:                 _y*
   Variance variables:                 _S*
   Command to list the data:           list study _y* _S*, noo sepby(_design)

. list study _y* _S*, noo sepby(_design)

  +--------------------------------------------------------------------+
  | study        _y_B         _y_C      _S_B_B      _S_C_C      _S_B_C |
  |--------------------------------------------------------------------|
  |     1   .99747229    1.1969667   .02168497   .02242635   .01202196 |
  |--------------------------------------------------------------------|
  |     2   .49810326            .   .02063211           .           . |
  |--------------------------------------------------------------------|
  |     3           .   -.49213973           .   .08261818           . |
  +--------------------------------------------------------------------+

. network table

-----------------------------------------------------------------------------
          |                      Treatment and Statistic                     
          | -------- A --------    -------- B --------    -------- C --------
    study |   sbp  sbpsd  count      sbp  sbpsd  count      sbp  sbpsd  count
----------+------------------------------------------------------------------
        1 |    50     10    100       60     10    100       62     10    100
        2 |    70     10    100       75     10    100                       
        3 |    60     10     25                              55     10     25
-----------------------------------------------------------------------------

. network query
         studyvar                study
         design                  _design
         ref                     A
         trtlistnoref            B C
         trtnameA                A
         trtnameB                B
         trtnameC                C
         maxarms                 3
         measure                 Standardised mean difference
         outcome                 quantitative
         dim                     2
         format                  augmented
         mean                    sbp
         sd                      sbpsd
         n                       count
         nmiss                   
         y                       _y
         S                       _S
         component               
         MNAR                    
         testcons_type           
         testcons_stat           
         testcons_df             
         testcons_p              
         metavars                
         consistency_fitted      
         inconsistency_fitted    
         plot_location           
         ncomponents             1
         df_inconsistency        2
         df_heterogeneity        0

. network meta c, force
Warning: heterogeneity model requested, but your data contain no potential sour
> ce of heterogeneity
Consider using the fixed option
Command is: mvmeta _y _S , bscovariance(exch 0.5) longparm suppress(uv mm) vars
> (_y_B _y_C)
Note: using method reml
Note: using variables _y_B _y_C
Note: 3 observations on 2 variables
Note: variance-covariance matrix is proportional to .5*I(2)+.5*J(2,2,1)

initial:       log likelihood = -3.2153481
rescale:       log likelihood = -3.2153481
rescale eq:    log likelihood = -3.2153481
Iteration 0:   log likelihood = -3.2153481  
Iteration 1:   log likelihood = -3.1440565  
Iteration 2:   log likelihood =  -3.142873  
Iteration 3:   log likelihood = -3.1428684  
Iteration 4:   log likelihood = -3.1428684  

Multivariate meta-analysis
Variance-covariance matrix = proportional .5*I(2)+.5*J(2,2,1)
Method = reml                                  Number of dimensions    =     2
Restricted log likelihood = -3.1428684         Number of observations  =     3
------------------------------------------------------------------------------
             |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
_y_B         |
       _cons |   .5482048   .5599685     0.98   0.328    -.5493133    1.645723
-------------+----------------------------------------------------------------
_y_C         |
       _cons |   .3755333   .5715054     0.66   0.511    -.7445968    1.495663
------------------------------------------------------------------------------

Estimated between-studies SDs and correlation matrix:
             SD       _y_B       _y_C
_y_B  .80539762          1          .
_y_C  .80539762         .5          1
mvmeta command stored as F9

. network compare
Table of standardised mean difference and its standard error for Treatment vs. 
> Comparator:
-----------------------------------
           |       Treatment       
Comparator |      A       B       C
-----------+-----------------------
         A |          0.548   0.376
           |          0.560   0.572
           | 
         B | -0.548          -0.173
           |  0.560           0.673
           | 
         C | -0.376   0.173        
           |  0.572   0.673        
-----------------------------------

. 
. // Check everything works for all formats and refcats
. 
. foreach format in augmented standard pairs {
  2.         foreach ref in "No contact" "Self help" "Individual counselling" "
> Group counselling" {
  3.                 di as input "Loop 1: format `format', ref `ref'"
  4.                 use smoking, clear
  5.                 keep study trt d n
  6.                 network setup d n, studyvar(stud) trtvar(trt) format(`form
> at') ref(`ref')
  7.                 network table
  8.                 network pattern
  9.                 local force = cond("`format'"=="pairs","force","")
 10.                 network meta c, i2 `force'
 11.                 network meta i, `force'
 12.                 network query
 13.                 network forest, name(forest_`format', replace)
 14.                 if "`format'"=="augmented" network meta i, luades `force'
 15.                 if "`format'"=="augmented" network sidesplit B C, show nos
> ymm 
 16.                 if "`format'"=="augmented" network sidesplit all, tau
 17.                 network unset
 18.         }
 19. }
Loop 1: format augmented, ref No contact
(Smoking data from Lu & Ades (2006))
Treatments used
   A (reference):                      No contact
   B:                                  Self help
   C:                                  Individual counselling
   D:                                  Group counselling

Measure                                Log odds ratio

Studies
   ID variable:                        study
   Number used:                        24
   IDs with zero cells:                9 20
   - count added to all their cells:   .5
   IDs with augmented reference arm:   2 21 22 23 24
   - observations added:               0.00001
   - mean in augmented observations:   study-specific mean

Network information                    
   Components:                         1 (connected)
   D.f. for inconsistency:             7
   D.f. for heterogeneity:             16

Current data
   Data format:                        augmented
   Design variable:                    _design
   Estimate variables:                 _y*
   Variance variables:                 _S*
   Command to list the data:           list study _y* _S*, noo sepby(_design)

----------------------------------------------------------------
          |               Treatment and Statistic               
          | - No con -    - Self h -    - Indivi -    - Group  -
    study |    d     n       d     n       d     n       d     n
----------+-----------------------------------------------------
        1 |    9   140                    23   140      10   138
        2 |                 11    78      12    85      29   170
        3 |   79   702      77   694                            
        4 |   18   671      21   535                            
        5 |    8   116      19   146                            
        6 |   75   731                   363   714              
        7 |    2   106                     9   205              
        8 |   58   549                   237  1561              
        9 |   .5    34                   9.5    49              
       10 |    3   100                    31    98              
       11 |    1    31                    26    95              
       12 |    6    39                    17    77              
       13 |   95  1107                   134  1031              
       14 |   15   187                    35   504              
       15 |   78   584                    73   675              
       16 |   69  1177                    54   888              
       17 |   64   642                   107   761              
       18 |    5    62                     8    90              
       19 |   20   234                    34   237              
       20 |   .5    21                                 9.5    21
       21 |                 20    49      16    43              
       22 |                  7    66                    32   127
       23 |                               12    76      20    74
       24 |                                9    55       3    26
----------------------------------------------------------------
Command is: mvmeta _y _S , i2 bscovariance(exch 0.5) longparm suppress(uv mm) v
> ars(_y_B _y_C _y_D)
Note: using method reml
Note: using variables _y_B _y_C _y_D
Note: 24 observations on 3 variables
Note: variance-covariance matrix is proportional to .5*I(3)+.5*J(3,3,1)

initial:       log likelihood = -72.419237
rescale:       log likelihood = -72.419237
rescale eq:    log likelihood = -72.206817
Iteration 0:   log likelihood = -72.206817  
Iteration 1:   log likelihood = -70.791949  
Iteration 2:   log likelihood = -70.764767  
Iteration 3:   log likelihood = -70.764565  
Iteration 4:   log likelihood = -70.764565  

Multivariate meta-analysis
Variance-covariance matrix = proportional .5*I(3)+.5*J(3,3,1)
Method = reml                                  Number of dimensions    =     3
Restricted log likelihood = -70.764565         Number of observations  =    24
------------------------------------------------------------------------------
             |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
_y_B         |
       _cons |   .3984484   .3311037     1.20   0.229    -.2505029      1.0474
-------------+----------------------------------------------------------------
_y_C         |
       _cons |   .7023554   .1991078     3.53   0.000     .3121112      1.0926
-------------+----------------------------------------------------------------
_y_D         |
       _cons |   .8658897   .3762911     2.30   0.021     .1283727    1.603407
------------------------------------------------------------------------------

Estimated between-studies SDs and correlation matrix:
             SD       _y_B       _y_C       _y_D
_y_B  .67446625          1          .          .
_y_C  .67446625         .5          1          .
_y_D  .67446625         .5         .5          1
Method of moments failed when mvmeta ran, so I^2 cannot be computed
mvmeta command stored as F9
Command is: mvmeta _y _S , bscovariance(exch 0.5) longparm suppress(uv mm) eq(_
> y_C: des_ACD des_BC des_BCD, _y_D: des_AD des_BCD des_BD des_CD) vars(_y_B _y
> _C _y_D)
Note: using method reml
Note: regressing _y_B on (nothing)
Note: regressing _y_C on des_ACD des_BC des_BCD
Note: regressing _y_D on des_AD des_BCD des_BD des_CD
Note: 24 observations on 3 variables
Note: variance-covariance matrix is proportional to .5*I(3)+.5*J(3,3,1)

initial:       log likelihood = -62.328944
rescale:       log likelihood = -62.328944
rescale eq:    log likelihood = -62.328944
Iteration 0:   log likelihood = -62.328944  
Iteration 1:   log likelihood = -61.601801  
Iteration 2:   log likelihood = -61.601084  
Iteration 3:   log likelihood = -61.601084  

Multivariate meta-analysis
Variance-covariance matrix = proportional .5*I(3)+.5*J(3,3,1)
Method = reml                                  Number of dimensions    =     3
Restricted log likelihood = -61.601084         Number of observations  =    24
------------------------------------------------------------------------------
             |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
_y_B         |
       _cons |   .3300627   .4675832     0.71   0.480    -.5863836    1.246509
-------------+----------------------------------------------------------------
_y_C         |
     des_ACD |   .3468138   .8821519     0.39   0.694    -1.382172      2.0758
      des_BC |  -.5261013   1.004557    -0.52   0.600    -2.494997    1.442794
     des_BCD |  -.3731722   1.013894    -0.37   0.713    -2.360369    1.614024
       _cons |   .7044792   .2348011     3.00   0.003     .2442774    1.164681
-------------+----------------------------------------------------------------
_y_D         |
      des_AD |   3.393989    1.89001     1.80   0.073    -.3103625    7.098341
     des_BCD |   .4268682   1.302759     0.33   0.743    -2.126493    2.980229
      des_BD |   1.245021   1.323387     0.94   0.347    -1.348771    3.838812
      des_CD |   .8178841   1.123174     0.73   0.466    -1.383496    3.019264
       _cons |   .1285276   .8825235     0.15   0.884    -1.601187    1.858242
------------------------------------------------------------------------------

Estimated between-studies SDs and correlation matrix:
             SD       _y_B       _y_C       _y_D
_y_B  .74316243          1          .          .
_y_C  .74316243         .5          1          .
_y_D  .74316243         .5         .5          1

Testing for inconsistency:
 ( 1)  [_y_C]des_ACD = 0
 ( 2)  [_y_D]des_AD = 0
 ( 3)  [_y_C]des_BC = 0
 ( 4)  [_y_C]des_BCD = 0
 ( 5)  [_y_D]des_BCD = 0
 ( 6)  [_y_D]des_BD = 0
 ( 7)  [_y_D]des_CD = 0

           chi2(  7) =    5.11
         Prob > chi2 =    0.6464
mvmeta command stored as F9; test command stored as F8
         studyvar                study
         design                  _design
         ref                     A
         trtlistnoref            B C D
         trtnameA                No contact
         trtnameB                Self help
         trtnameC                Individual counselling
         trtnameD                Group counselling
         maxarms                 3
         measure                 Log odds ratio
         outcome                 count
         dim                     3
         format                  augmented
         d                       d
         n                       n
         nmiss                   
         y                       _y
         S                       _S
         component               
         MNAR                    
         testcons_type           chi2
         testcons_stat           5.111148252724886
         testcons_df             7
         testcons_p              .6464012896534372
         metavars                des_AB des_AC des_ACD des_AD des_BC des_BCD de
> s_BD des_CD
         consistency_fitted      _network_consistency
         inconsistency_fitted    _network_inconsistency
         plot_location           
         ncomponents             1
         df_inconsistency        7
         df_heterogeneity        16
Command is: mvmeta _y _S , bscovariance(exch 0.5) longparm suppress(uv mm) eq(_
> y_C: groupB, _y_D: groupB groupC) vars(_y_B _y_C _y_D)
Note: using method reml
Note: regressing _y_B on (nothing)
Note: regressing _y_C on groupB
Note: regressing _y_D on groupB groupC
Note: 24 observations on 3 variables
Note: variance-covariance matrix is proportional to .5*I(3)+.5*J(3,3,1)

initial:       log likelihood = -69.372953
rescale:       log likelihood = -69.372953
rescale eq:    log likelihood = -69.372953
Iteration 0:   log likelihood = -69.372953  
Iteration 1:   log likelihood =   -68.3523  
Iteration 2:   log likelihood = -68.343651  
Iteration 3:   log likelihood = -68.343387  
Iteration 4:   log likelihood = -68.343387  

Multivariate meta-analysis
Variance-covariance matrix = proportional .5*I(3)+.5*J(3,3,1)
Method = reml                                  Number of dimensions    =     3
Restricted log likelihood = -68.343387         Number of observations  =    24
------------------------------------------------------------------------------
             |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
_y_B         |
       _cons |   .3281294    .453105     0.72   0.469    -.5599401    1.216199
-------------+----------------------------------------------------------------
_y_C         |
      groupB |  -.3791068   .7621959    -0.50   0.619    -1.872983     1.11477
       _cons |    .750535   .2200046     3.41   0.001      .319334    1.181736
-------------+----------------------------------------------------------------
_y_D         |
      groupB |   .3527131   .9962383     0.35   0.723    -1.599878    2.305304
      groupC |   .4562861   .9409527     0.48   0.628    -1.387947     2.30052
       _cons |   .5410252   .6899917     0.78   0.433    -.8113336    1.893384
------------------------------------------------------------------------------

Estimated between-studies SDs and correlation matrix:
             SD       _y_B       _y_C       _y_D
_y_B  .71606206          1          .          .
_y_C  .71606206         .5          1          .
_y_D  .71606206         .5         .5          1

Testing for inconsistency:
 ( 1)  [_y_C]groupB = 0
 ( 2)  [_y_D]groupB = 0
 ( 3)  [_y_D]groupC = 0

           chi2(  3) =    0.67
         Prob > chi2 =    0.8803
mvmeta command stored as F9; test command stored as F8
(fitting model splitting side B C)
Command is: mvmeta _y _S  , bscovariance(exch 0.5)  eq(_y_B: _trtdiffB _trtdiff
> C _trtdiffD _trtdiffincoB, _y_C: _trtdiffzero _trtdiffone _trtdiffzero _trtdi
> ffincoC, _y_D: _trtdiffzero _trtdiffzero _trtdiffone _trtdiffincoD) commonpar
> m noconst network(sidesplit) suppress(uv mm)
Note: using method reml
Note: regressing _y_B on _trtdiffB _trtdiffC _trtdiffD _trtdiffincoB
Note: regressing _y_C on _trtdiffzero _trtdiffone _trtdiffzero _trtdiffincoC
Note: regressing _y_D on _trtdiffzero _trtdiffzero _trtdiffone _trtdiffincoD
Note: 24 observations on 3 variables
Note: variance-covariance matrix is proportional to .5*I(3)+.5*J(3,3,1)

initial:       log likelihood = -71.527657
rescale:       log likelihood = -71.527657
rescale eq:    log likelihood = -71.527657
Iteration 0:   log likelihood = -71.527657  
Iteration 1:   log likelihood = -70.223418  (not concave)
Iteration 2:   log likelihood = -70.090968  
Iteration 3:   log likelihood = -70.086173  
Iteration 4:   log likelihood = -70.085996  
Iteration 5:   log likelihood = -70.085996  

Multivariate meta-analysis
Variance-covariance matrix = proportional .5*I(3)+.5*J(3,3,1)
Method = reml                                  Number of dimensions    =     3
Restricted log likelihood = -70.085996         Number of observations  =    24
------------------------------------------------------------------------------
             |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
_y_B         |
   _trtdiffB |   .2901809   .3755108     0.77   0.440    -.4458067    1.026169
   _trtdiffC |   .7357615   .2076331     3.54   0.000     .3288082    1.142715
   _trtdiffD |    .799008   .3967841     2.01   0.044     .0213255    1.576691
_trtdiffin~B |  -.4195993   .6350905    -0.66   0.509    -1.664354    .8251553
------------------------------------------------------------------------------
The above coefficients also apply to the following equations:
    _y_C: _trtdiffzero _trtdiffone _trtdiffzero _trtdiffincoC 
    _y_D: _trtdiffzero _trtdiffzero _trtdiffone _trtdiffincoD 

Estimated between-studies SDs and correlation matrix:
             SD       _y_B       _y_C       _y_D
_y_B  .68799617          1          .          .
_y_C  .68799617         .5          1          .
_y_D  .68799617         .5         .5          1

Results splitting B C:
------------------------------------------------------------------------------
             |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
      direct |   .0259812   .5452741     0.05   0.962    -1.042736    1.094699
    indirect |   .4455805    .406421     1.10   0.273      -.35099    1.242151
  difference |  -.4195993   .6350905    -0.66   0.509    -1.664354    .8251553
------------------------------------------------------------------------------

Side    Direct                Indirect              Difference                 
>    tau
        Coef.      Std. Err.  Coef.      Std. Err.  Coef.      Std. Err.  P>|z|
A B      .3266968   .4431873   .5101185   .5274795  -.1834217   .6881712  0.790
>     .6974406
A C      .7215198    .213236   .5736351   .6371487   .1478847    .667592  0.825
>     .6923614
A D      .8201394   .7576188   .8893863   .4420002   -.069247    .874375  0.937
>      .691252
B C     -.0756829   .5752541   .5163243   .4300301  -.5920072   .7180018  0.410
>     .6845005
B D      .6231378   .5693373   .2974684   .6041449   .3256693   .8305242  0.695
>     .6898184
C D      -.075668   .4111039   .8722691   .7066294  -.9479372    .816191  0.245
>     .6780787
Loop 1: format augmented, ref Self help
(Smoking data from Lu & Ades (2006))
Treatments used
   A:                                  No contact
   B (reference):                      Self help
   C:                                  Individual counselling
   D:                                  Group counselling

Measure                                Log odds ratio

Studies
   ID variable:                        study
   Number used:                        24
   IDs with zero cells:                9 20
   - count added to all their cells:   .5
   IDs with augmented reference arm:   1 6 7 8 9 10 11 12 13 14 15 16 17 18 19 
> 20 23 24
   - observations added:               0.00001
   - mean in augmented observations:   study-specific mean

Network information                    
   Components:                         1 (connected)
   D.f. for inconsistency:             7
   D.f. for heterogeneity:             16

Current data
   Data format:                        augmented
   Design variable:                    _design
   Estimate variables:                 _y*
   Variance variables:                 _S*
   Command to list the data:           list study _y* _S*, noo sepby(_design)

----------------------------------------------------------------
          |               Treatment and Statistic               
          | - Self h -    - No con -    - Indivi -    - Group  -
    study |    d     n       d     n       d     n       d     n
----------+-----------------------------------------------------
        1 |                  9   140      23   140      10   138
        2 |   11    78                    12    85      29   170
        3 |   77   694      79   702                            
        4 |   21   535      18   671                            
        5 |   19   146       8   116                            
        6 |                 75   731     363   714              
        7 |                  2   106       9   205              
        8 |                 58   549     237  1561              
        9 |                 .5    34     9.5    49              
       10 |                  3   100      31    98              
       11 |                  1    31      26    95              
       12 |                  6    39      17    77              
       13 |                 95  1107     134  1031              
       14 |                 15   187      35   504              
       15 |                 78   584      73   675              
       16 |                 69  1177      54   888              
       17 |                 64   642     107   761              
       18 |                  5    62       8    90              
       19 |                 20   234      34   237              
       20 |                 .5    21                   9.5    21
       21 |   20    49                    16    43              
       22 |    7    66                                  32   127
       23 |                               12    76      20    74
       24 |                                9    55       3    26
----------------------------------------------------------------
Command is: mvmeta _y _S , i2 bscovariance(exch 0.5) longparm suppress(uv mm) v
> ars(_y_A _y_C _y_D)
Note: using method reml
Note: using variables _y_A _y_C _y_D
Note: 24 observations on 3 variables
Note: variance-covariance matrix is proportional to .5*I(3)+.5*J(3,3,1)

initial:       log likelihood = -174.66976
rescale:       log likelihood = -174.66976
rescale eq:    log likelihood = -174.45531
Iteration 0:   log likelihood = -174.45531  
Iteration 1:   log likelihood = -173.04376  
Iteration 2:   log likelihood = -173.01544  
Iteration 3:   log likelihood = -173.01509  
Iteration 4:   log likelihood = -173.01509  

Multivariate meta-analysis
Variance-covariance matrix = proportional .5*I(3)+.5*J(3,3,1)
Method = reml                                  Number of dimensions    =     3
Restricted log likelihood = -173.01509         Number of observations  =    24
------------------------------------------------------------------------------
             |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
_y_A         |
       _cons |   -.398449    .331104    -1.20   0.229    -1.047401     .250503
-------------+----------------------------------------------------------------
_y_C         |
       _cons |   .3039067   .3405169     0.89   0.372    -.3634943    .9713076
-------------+----------------------------------------------------------------
_y_D         |
       _cons |   .4674414   .4074051     1.15   0.251     -.331058    1.265941
------------------------------------------------------------------------------

Estimated between-studies SDs and correlation matrix:
             SD       _y_A       _y_C       _y_D
_y_A  .67446689          1          .          .
_y_C  .67446689         .5          1          .
_y_D  .67446689         .5         .5          1
Method of moments failed when mvmeta ran, so I^2 cannot be computed
mvmeta command stored as F9
Command is: mvmeta _y _S , bscovariance(exch 0.5) longparm suppress(uv mm) eq(_
> y_C: des_ACD des_BC des_BCD, _y_D: des_AD des_BCD des_BD des_CD) vars(_y_A _y
> _C _y_D)
Note: using method reml
Note: regressing _y_A on (nothing)
Note: regressing _y_C on des_ACD des_BC des_BCD
Note: regressing _y_D on des_AD des_BCD des_BD des_CD
Note: 24 observations on 3 variables
Note: variance-covariance matrix is proportional to .5*I(3)+.5*J(3,3,1)

initial:       log likelihood = -164.57948
rescale:       log likelihood = -164.57948
rescale eq:    log likelihood = -164.57948
Iteration 0:   log likelihood = -164.57948  
Iteration 1:   log likelihood = -163.85231  
Iteration 2:   log likelihood = -163.85162  
Iteration 3:   log likelihood = -163.85162  

Multivariate meta-analysis
Variance-covariance matrix = proportional .5*I(3)+.5*J(3,3,1)
Method = reml                                  Number of dimensions    =     3
Restricted log likelihood = -163.85162         Number of observations  =    24
------------------------------------------------------------------------------
             |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
_y_A         |
       _cons |  -.3300654    .467585    -0.71   0.480    -1.246515    .5863844
-------------+----------------------------------------------------------------
_y_C         |
     des_ACD |    .346806   .8821564     0.39   0.694    -1.382189    2.075801
      des_BC |   -.526105   1.004562    -0.52   0.600     -2.49501      1.4428
     des_BCD |  -.3731752   1.013899    -0.37   0.713    -2.360381     1.61403
       _cons |   .3744215   .5223287     0.72   0.473    -.6493238    1.398167
-------------+----------------------------------------------------------------
_y_D         |
      des_AD |   3.393982   1.890011     1.80   0.073    -.3103718    7.098336
     des_BCD |   .4268754   1.302765     0.33   0.743    -2.126498    2.980248
      des_BD |   1.245028   1.323394     0.94   0.347    -1.348775    3.838832
      des_CD |    .817888   1.123179     0.73   0.466    -1.383502    3.019278
       _cons |  -.2015401   .9987444    -0.20   0.840    -2.159043    1.755963
------------------------------------------------------------------------------

Estimated between-studies SDs and correlation matrix:
             SD       _y_A       _y_C       _y_D
_y_A  .74316722          1          .          .
_y_C  .74316722         .5          1          .
_y_D  .74316722         .5         .5          1

Testing for inconsistency:
 ( 1)  [_y_C]des_ACD = 0
 ( 2)  [_y_D]des_AD = 0
 ( 3)  [_y_C]des_BC = 0
 ( 4)  [_y_C]des_BCD = 0
 ( 5)  [_y_D]des_BCD = 0
 ( 6)  [_y_D]des_BD = 0
 ( 7)  [_y_D]des_CD = 0

           chi2(  7) =    5.11
         Prob > chi2 =    0.6464
mvmeta command stored as F9; test command stored as F8
         studyvar                study
         design                  _design
         ref                     B
         trtlistnoref            A C D
         trtnameA                No contact
         trtnameB                Self help
         trtnameC                Individual counselling
         trtnameD                Group counselling
         maxarms                 3
         measure                 Log odds ratio
         outcome                 count
         dim                     3
         format                  augmented
         d                       d
         n                       n
         nmiss                   
         y                       _y
         S                       _S
         component               
         MNAR                    
         testcons_type           chi2
         testcons_stat           5.111107024920219
         testcons_df             7
         testcons_p              .6464063180968607
         metavars                des_AB des_AC des_ACD des_AD des_BC des_BCD de
> s_BD des_CD
         consistency_fitted      _network_consistency
         inconsistency_fitted    _network_inconsistency
         plot_location           
         ncomponents             1
         df_inconsistency        7
         df_heterogeneity        16
Command is: mvmeta _y _S , bscovariance(exch 0.5) longparm suppress(uv mm) eq(_
> y_C: groupA, _y_D: groupA groupC) vars(_y_A _y_C _y_D)
Note: using method reml
Note: regressing _y_A on (nothing)
Note: regressing _y_C on groupA
Note: regressing _y_D on groupA groupC
Note: 24 observations on 3 variables
Note: variance-covariance matrix is proportional to .5*I(3)+.5*J(3,3,1)

initial:       log likelihood = -171.62348
rescale:       log likelihood = -171.62348
rescale eq:    log likelihood = -171.62348
Iteration 0:   log likelihood = -171.62348  
Iteration 1:   log likelihood =  -170.6025  (not concave)
Iteration 2:   log likelihood = -170.59811  
Iteration 3:   log likelihood = -170.59406  
Iteration 4:   log likelihood = -170.59391  
Iteration 5:   log likelihood = -170.59391  

Multivariate meta-analysis
Variance-covariance matrix = proportional .5*I(3)+.5*J(3,3,1)
Method = reml                                  Number of dimensions    =     3
Restricted log likelihood = -170.59391         Number of observations  =    24
------------------------------------------------------------------------------
             |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
_y_A         |
       _cons |  -.3281296    .453103    -0.72   0.469    -1.216195     .559936
-------------+----------------------------------------------------------------
_y_C         |
      groupA |   .3791038   .7621928     0.50   0.619    -1.114767    1.872974
       _cons |   .0432984   .5728156     0.08   0.940      -1.0794    1.165996
-------------+----------------------------------------------------------------
_y_D         |
      groupA |  -.3527178   .9962294    -0.35   0.723    -2.305292    1.599856
      groupC |  -.2755298   .9246668    -0.30   0.766    -2.087843    1.536784
       _cons |   .5656078   .5623417     1.01   0.315    -.5365617    1.667777
------------------------------------------------------------------------------

Estimated between-studies SDs and correlation matrix:
            SD      _y_A      _y_C      _y_D
_y_A  .7160595         1         .         .
_y_C  .7160595        .5         1         .
_y_D  .7160595        .5        .5         1

Testing for inconsistency:
 ( 1)  [_y_C]groupA = 0
 ( 2)  [_y_D]groupA = 0
 ( 3)  [_y_D]groupC = 0

           chi2(  3) =    0.67
         Prob > chi2 =    0.8803
mvmeta command stored as F9; test command stored as F8
(fitting model splitting side B C)
Command is: mvmeta _y _S  , bscovariance(exch 0.5)  eq(_y_A: _trtdiffA _trtdiff
> C _trtdiffD _trtdiffincoA, _y_C: _trtdiffzero _trtdiffone _trtdiffzero _trtdi
> ffincoC, _y_D: _trtdiffzero _trtdiffzero _trtdiffone _trtdiffincoD) commonpar
> m noconst network(sidesplit) suppress(uv mm)
Note: using method reml
Note: regressing _y_A on _trtdiffA _trtdiffC _trtdiffD _trtdiffincoA
Note: regressing _y_C on _trtdiffzero _trtdiffone _trtdiffzero _trtdiffincoC
Note: regressing _y_D on _trtdiffzero _trtdiffzero _trtdiffone _trtdiffincoD
Note: 24 observations on 3 variables
Note: variance-covariance matrix is proportional to .5*I(3)+.5*J(3,3,1)

initial:       log likelihood = -173.77819
rescale:       log likelihood = -173.77819
rescale eq:    log likelihood = -173.77819
Iteration 0:   log likelihood = -173.77819  
Iteration 1:   log likelihood = -172.47344  (not concave)
Iteration 2:   log likelihood = -172.36205  (not concave)
Iteration 3:   log likelihood = -172.33689  
Iteration 4:   log likelihood = -172.33652  
Iteration 5:   log likelihood = -172.33652  

Multivariate meta-analysis
Variance-covariance matrix = proportional .5*I(3)+.5*J(3,3,1)
Method = reml                                  Number of dimensions    =     3
Restricted log likelihood = -172.33652         Number of observations  =    24
------------------------------------------------------------------------------
             |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
_y_A         |
   _trtdiffA |  -.2901819   .3755108    -0.77   0.440     -1.02617    .4458058
   _trtdiffC |   .4455796   .4064206     1.10   0.273    -.3509901    1.242149
   _trtdiffD |   .5088267   .4179624     1.22   0.223    -.3103645    1.328018
_trtdiffin~A |  -.4195983   .6350905    -0.66   0.509    -1.664353    .8251561
------------------------------------------------------------------------------
The above coefficients also apply to the following equations:
    _y_C: _trtdiffzero _trtdiffone _trtdiffzero _trtdiffincoC 
    _y_D: _trtdiffzero _trtdiffzero _trtdiffone _trtdiffincoD 

Estimated between-studies SDs and correlation matrix:
             SD       _y_A       _y_C       _y_D
_y_A  .68799609          1          .          .
_y_C  .68799609         .5          1          .
_y_D  .68799609         .5         .5          1

Results splitting B C:
------------------------------------------------------------------------------
             |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
      direct |   .0259813    .545274     0.05   0.962    -1.042736    1.094699
    indirect |   .4455796   .4064206     1.10   0.273    -.3509901    1.242149
  difference |  -.4195983   .6350905    -0.66   0.509    -1.664353    .8251561
------------------------------------------------------------------------------

Side    Direct                Indirect              Difference                 
>    tau
        Coef.      Std. Err.  Coef.      Std. Err.  Coef.      Std. Err.  P>|z|
B C     -.0756829    .575254    .516323   .4300292   -.592006   .7180012  0.410
>     .6845004
B D      .6231378   .5693367   .2974683   .6041444   .3256695   .8305234  0.695
>     .6898174
A B      .3266969   .4431872   .5101193   .5274786  -.1834225   .6881704  0.790
>     .6974403
A C      .7215202   .2132339   .5736358   .6371442   .1478844    .667589  0.825
>     .6923577
A D      .8201259   .7576192   .8893879   .4419993   -.069262   .8743739  0.937
>     .6912495
C D      -.075668   .4111037   .8722699   .7066295  -.9479379   .8161912  0.245
>     .6780782
Loop 1: format augmented, ref Individual counselling
(Smoking data from Lu & Ades (2006))
Treatments used
   A:                                  No contact
   B:                                  Self help
   C (reference):                      Individual counselling
   D:                                  Group counselling

Measure                                Log odds ratio

Studies
   ID variable:                        study
   Number used:                        24
   IDs with zero cells:                9 20
   - count added to all their cells:   .5
   IDs with augmented reference arm:   3 4 5 20 22
   - observations added:               0.00001
   - mean in augmented observations:   study-specific mean

Network information                    
   Components:                         1 (connected)
   D.f. for inconsistency:             7
   D.f. for heterogeneity:             16

Current data
   Data format:                        augmented
   Design variable:                    _design
   Estimate variables:                 _y*
   Variance variables:                 _S*
   Command to list the data:           list study _y* _S*, noo sepby(_design)

----------------------------------------------------------------
          |               Treatment and Statistic               
          | - Indivi -    - No con -    - Self h -    - Group  -
    study |    d     n       d     n       d     n       d     n
----------+-----------------------------------------------------
        1 |   23   140       9   140                    10   138
        2 |   12    85                    11    78      29   170
        3 |                 79   702      77   694              
        4 |                 18   671      21   535              
        5 |                  8   116      19   146              
        6 |  363   714      75   731                            
        7 |    9   205       2   106                            
        8 |  237  1561      58   549                            
        9 |  9.5    49      .5    34                            
       10 |   31    98       3   100                            
       11 |   26    95       1    31                            
       12 |   17    77       6    39                            
       13 |  134  1031      95  1107                            
       14 |   35   504      15   187                            
       15 |   73   675      78   584                            
       16 |   54   888      69  1177                            
       17 |  107   761      64   642                            
       18 |    8    90       5    62                            
       19 |   34   237      20   234                            
       20 |                 .5    21                   9.5    21
       21 |   16    43                    20    49              
       22 |                                7    66      32   127
       23 |   12    76                                  20    74
       24 |    9    55                                   3    26
----------------------------------------------------------------
Command is: mvmeta _y _S , i2 bscovariance(exch 0.5) longparm suppress(uv mm) v
> ars(_y_A _y_B _y_D)
Note: using method reml
Note: using variables _y_A _y_B _y_D
Note: 24 observations on 3 variables
Note: variance-covariance matrix is proportional to .5*I(3)+.5*J(3,3,1)

initial:       log likelihood = -73.692505
rescale:       log likelihood = -73.692505
rescale eq:    log likelihood = -73.457281
Iteration 0:   log likelihood = -73.457281  
Iteration 1:   log likelihood = -72.060279  
Iteration 2:   log likelihood = -72.038047  
Iteration 3:   log likelihood = -72.037834  
Iteration 4:   log likelihood = -72.037833  

Multivariate meta-analysis
Variance-covariance matrix = proportional .5*I(3)+.5*J(3,3,1)
Method = reml                                  Number of dimensions    =     3
Restricted log likelihood = -72.037833         Number of observations  =    24
------------------------------------------------------------------------------
             |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
_y_A         |
       _cons |  -.7023556   .1991102    -3.53   0.000    -1.092604   -.3121068
-------------+----------------------------------------------------------------
_y_B         |
       _cons |  -.3039068   .3405171    -0.89   0.372    -.9713081    .3634945
-------------+----------------------------------------------------------------
_y_D         |
       _cons |   .1635347    .354741     0.46   0.645    -.5317449    .8588144
------------------------------------------------------------------------------

Estimated between-studies SDs and correlation matrix:
             SD       _y_A       _y_B       _y_D
_y_A  .67446642          1          .          .
_y_B  .67446642         .5          1          .
_y_D  .67446642         .5         .5          1
Method of moments failed when mvmeta ran, so I^2 cannot be computed
mvmeta command stored as F9
Command is: mvmeta _y _S , bscovariance(exch 0.5) longparm suppress(uv mm) eq(_
> y_A: des_ACD, _y_B: des_BC des_BCD, _y_D: des_AD des_BCD des_BD des_CD) vars(
> _y_A _y_B _y_D)
Note: using method reml
Note: regressing _y_A on des_ACD
Note: regressing _y_B on des_BC des_BCD
Note: regressing _y_D on des_AD des_BCD des_BD des_CD
Note: 24 observations on 3 variables
Note: variance-covariance matrix is proportional to .5*I(3)+.5*J(3,3,1)

initial:       log likelihood = -63.602216
rescale:       log likelihood = -63.602216
rescale eq:    log likelihood = -63.602216
Iteration 0:   log likelihood = -63.602216  
Iteration 1:   log likelihood = -62.875022  
Iteration 2:   log likelihood = -62.874357  
Iteration 3:   log likelihood = -62.874357  

Multivariate meta-analysis
Variance-covariance matrix = proportional .5*I(3)+.5*J(3,3,1)
Method = reml                                  Number of dimensions    =     3
Restricted log likelihood = -62.874357         Number of observations  =    24
------------------------------------------------------------------------------
             |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
_y_A         |
     des_ACD |  -.3468134    .882152    -0.39   0.694    -2.075799    1.382173
       _cons |  -.7044796   .2347999    -3.00   0.003    -1.164679   -.2442802
-------------+----------------------------------------------------------------
_y_B         |
      des_BC |   .5261009   1.004558     0.52   0.600    -1.442796    2.494998
     des_BCD |   .3731717   1.013895     0.37   0.713    -1.614026    2.360369
       _cons |  -.3744163   .5223268    -0.72   0.473    -1.398158    .6493254
-------------+----------------------------------------------------------------
_y_D         |
      des_AD |   3.740795    1.88694     1.98   0.047     .0424613    7.439128
     des_BCD |   1.146854   1.184494     0.97   0.333    -1.174712     3.46842
      des_BD |   1.591835   1.318646     1.21   0.227    -.9926633    4.176334
      des_CD |   1.164698   1.068675     1.09   0.276    -.9298657    3.259262
       _cons |  -.9227655   .8438772    -1.09   0.274    -2.576734    .7312035
------------------------------------------------------------------------------

Estimated between-studies SDs and correlation matrix:
             SD       _y_A       _y_B       _y_D
_y_A  .74316293          1          .          .
_y_B  .74316293         .5          1          .
_y_D  .74316293         .5         .5          1

Testing for inconsistency:
 ( 1)  [_y_A]des_ACD = 0
 ( 2)  [_y_D]des_AD = 0
 ( 3)  [_y_B]des_BC = 0
 ( 4)  [_y_B]des_BCD = 0
 ( 5)  [_y_D]des_BCD = 0
 ( 6)  [_y_D]des_BD = 0
 ( 7)  [_y_D]des_CD = 0

           chi2(  7) =    5.11
         Prob > chi2 =    0.6464
mvmeta command stored as F9; test command stored as F8
         studyvar                study
         design                  _design
         ref                     C
         trtlistnoref            A B D
         trtnameA                No contact
         trtnameB                Self help
         trtnameC                Individual counselling
         trtnameD                Group counselling
         maxarms                 3
         measure                 Log odds ratio
         outcome                 count
         dim                     3
         format                  augmented
         d                       d
         n                       n
         nmiss                   
         y                       _y
         S                       _S
         component               
         MNAR                    
         testcons_type           chi2
         testcons_stat           5.111138974643357
         testcons_df             7
         testcons_p              .6464024212756598
         metavars                des_AB des_AC des_ACD des_AD des_BC des_BCD de
> s_BD des_CD
         consistency_fitted      _network_consistency
         inconsistency_fitted    _network_inconsistency
         plot_location           
         ncomponents             1
         df_inconsistency        7
         df_heterogeneity        16
Command is: mvmeta _y _S , bscovariance(exch 0.5) longparm suppress(uv mm) eq(_
> y_B: groupA, _y_D: groupA groupB) vars(_y_A _y_B _y_D)
Note: using method reml
Note: regressing _y_A on (nothing)
Note: regressing _y_B on groupA
Note: regressing _y_D on groupA groupB
Note: 24 observations on 3 variables
Note: variance-covariance matrix is proportional to .5*I(3)+.5*J(3,3,1)

initial:       log likelihood = -68.652402
rescale:       log likelihood = -68.652402
rescale eq:    log likelihood = -68.545967
Iteration 0:   log likelihood = -68.545967  
Iteration 1:   log likelihood = -67.201752  
Iteration 2:   log likelihood = -67.188295  
Iteration 3:   log likelihood = -67.187853  
Iteration 4:   log likelihood = -67.187852  

Multivariate meta-analysis
Variance-covariance matrix = proportional .5*I(3)+.5*J(3,3,1)
Method = reml                                  Number of dimensions    =     3
Restricted log likelihood = -67.187852         Number of observations  =    24
------------------------------------------------------------------------------
             |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
_y_A         |
       _cons |  -.6878408   .2096055    -3.28   0.001     -1.09866   -.2770216
-------------+----------------------------------------------------------------
_y_B         |
      groupA |  -.3395013   .7234293    -0.47   0.639    -1.757397    1.078394
       _cons |  -.0228113   .5423876    -0.04   0.966    -1.085871    1.040249
-------------+----------------------------------------------------------------
_y_D         |
      groupA |   2.890453   1.700941     1.70   0.089    -.4433301    6.224236
      groupB |   1.076459    1.01023     1.07   0.287    -.9035557    3.056474
       _cons |  -.0557847   .3928698    -0.14   0.887    -.8257953    .7142259
------------------------------------------------------------------------------

Estimated between-studies SDs and correlation matrix:
             SD       _y_A       _y_B       _y_D
_y_A  .68305795          1          .          .
_y_B  .68305795         .5          1          .
_y_D  .68305795         .5         .5          1

Testing for inconsistency:
 ( 1)  [_y_B]groupA = 0
 ( 2)  [_y_D]groupA = 0
 ( 3)  [_y_D]groupB = 0

           chi2(  3) =    3.89
         Prob > chi2 =    0.2733
mvmeta command stored as F9; test command stored as F8
(fitting model splitting side B C)
Command is: mvmeta _y _S  , bscovariance(exch 0.5)  eq(_y_A: _trtdiffA _trtdiff
> B _trtdiffD _trtdiffincoA, _y_B: _trtdiffzero _trtdiffone _trtdiffzero _trtdi
> ffincoB, _y_D: _trtdiffzero _trtdiffzero _trtdiffone _trtdiffincoD) commonpar
> m noconst network(sidesplit) suppress(uv mm)
Note: using method reml
Note: regressing _y_A on _trtdiffA _trtdiffB _trtdiffD _trtdiffincoA
Note: regressing _y_B on _trtdiffzero _trtdiffone _trtdiffzero _trtdiffincoB
Note: regressing _y_D on _trtdiffzero _trtdiffzero _trtdiffone _trtdiffincoD
Note: 24 observations on 3 variables
Note: variance-covariance matrix is proportional to .5*I(3)+.5*J(3,3,1)

initial:       log likelihood = -72.800925
rescale:       log likelihood = -72.800925
rescale eq:    log likelihood = -72.800925
Iteration 0:   log likelihood = -72.800925  
Iteration 1:   log likelihood = -71.496641  (not concave)
Iteration 2:   log likelihood = -71.372709  
Iteration 3:   log likelihood = -71.362646  
Iteration 4:   log likelihood = -71.359267  
Iteration 5:   log likelihood = -71.359266  

Multivariate meta-analysis
Variance-covariance matrix = proportional .5*I(3)+.5*J(3,3,1)
Method = reml                                  Number of dimensions    =     3
Restricted log likelihood = -71.359266         Number of observations  =    24
------------------------------------------------------------------------------
             |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
_y_A         |
   _trtdiffA |  -.7357615   .2076367    -3.54   0.000    -1.142722   -.3288012
   _trtdiffB |  -.4455801   .4064212    -1.10   0.273    -1.242151    .3509909
   _trtdiffD |   .0632471    .391031     0.16   0.872    -.7031596    .8296537
_trtdiffin~A |  -.4195987   .6350907    -0.66   0.509    -1.664354    .8251561
------------------------------------------------------------------------------
The above coefficients also apply to the following equations:
    _y_B: _trtdiffzero _trtdiffone _trtdiffzero _trtdiffincoB 
    _y_D: _trtdiffzero _trtdiffzero _trtdiffone _trtdiffincoD 

Estimated between-studies SDs and correlation matrix:
             SD       _y_A       _y_B       _y_D
_y_A  .68799611          1          .          .
_y_B  .68799611         .5          1          .
_y_D  .68799611         .5         .5          1

Results splitting B C:
------------------------------------------------------------------------------
             |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
      direct |   .0259814   .5452741     0.05   0.962    -1.042736    1.094699
    indirect |   .4455801   .4064212     1.10   0.273    -.3509909    1.242151
  difference |  -.4195987   .6350907    -0.66   0.509    -1.664354    .8251561
------------------------------------------------------------------------------

Side    Direct                Indirect              Difference                 
>    tau
        Coef.      Std. Err.  Coef.      Std. Err.  Coef.      Std. Err.  P>|z|
C D     -.0756679   .4111038   .8722693   .7066273  -.9479372   .8161888  0.245
>     .6780785
A C      .7215198   .2132358   .5736362   .6371487   .1478836   .6675923  0.825
>     .6923615
A B      .3266967   .4431859   .5101206   .5274784   -.183424   .6881694  0.790
>     .6974379
A D      .8201396   .7576232   .8893867   .4420007  -.0692471   .8743774  0.937
>     .6912521
B C     -.0756829   .5752542    .516324   .4300299  -.5920069   .7180018  0.410
>     .6845007
B D      .6231378   .5693372   .2974687   .6041442   .3256691   .8305238  0.695
>     .6898184
Loop 1: format augmented, ref Group counselling
(Smoking data from Lu & Ades (2006))
Treatments used
   A:                                  No contact
   B:                                  Self help
   C:                                  Individual counselling
   D (reference):                      Group counselling

Measure                                Log odds ratio

Studies
   ID variable:                        study
   Number used:                        24
   IDs with zero cells:                9 20
   - count added to all their cells:   .5
   IDs with augmented reference arm:   3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18
>  19 21
   - observations added:               0.00001
   - mean in augmented observations:   study-specific mean

Network information                    
   Components:                         1 (connected)
   D.f. for inconsistency:             7
   D.f. for heterogeneity:             16

Current data
   Data format:                        augmented
   Design variable:                    _design
   Estimate variables:                 _y*
   Variance variables:                 _S*
   Command to list the data:           list study _y* _S*, noo sepby(_design)

----------------------------------------------------------------
          |               Treatment and Statistic               
          | - Group  -    - No con -    - Self h -    - Indivi -
    study |    d     n       d     n       d     n       d     n
----------+-----------------------------------------------------
        1 |   10   138       9   140                    23   140
        2 |   29   170                    11    78      12    85
        3 |                 79   702      77   694              
        4 |                 18   671      21   535              
        5 |                  8   116      19   146              
        6 |                 75   731                   363   714
        7 |                  2   106                     9   205
        8 |                 58   549                   237  1561
        9 |                 .5    34                   9.5    49
       10 |                  3   100                    31    98
       11 |                  1    31                    26    95
       12 |                  6    39                    17    77
       13 |                 95  1107                   134  1031
       14 |                 15   187                    35   504
       15 |                 78   584                    73   675
       16 |                 69  1177                    54   888
       17 |                 64   642                   107   761
       18 |                  5    62                     8    90
       19 |                 20   234                    34   237
       20 |  9.5    21      .5    21                            
       21 |                               20    49      16    43
       22 |   32   127                     7    66              
       23 |   20    74                                  12    76
       24 |    3    26                                   9    55
----------------------------------------------------------------
Command is: mvmeta _y _S , i2 bscovariance(exch 0.5) longparm suppress(uv mm) v
> ars(_y_A _y_B _y_C)
Note: using method reml
Note: using variables _y_A _y_B _y_C
Note: 24 observations on 3 variables
Note: variance-covariance matrix is proportional to .5*I(3)+.5*J(3,3,1)

initial:       log likelihood = -175.48222
rescale:       log likelihood = -175.48222
rescale eq:    log likelihood = -175.26979
Iteration 0:   log likelihood = -175.26979  
Iteration 1:   log likelihood = -173.85457  
Iteration 2:   log likelihood = -173.83443  
Iteration 3:   log likelihood =  -173.8276  
Iteration 4:   log likelihood = -173.82754  
Iteration 5:   log likelihood = -173.82754  

Multivariate meta-analysis
Variance-covariance matrix = proportional .5*I(3)+.5*J(3,3,1)
Method = reml                                  Number of dimensions    =     3
Restricted log likelihood = -173.82754         Number of observations  =    24
------------------------------------------------------------------------------
             |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
_y_A         |
       _cons |  -.8658901   .3762925    -2.30   0.021     -1.60341   -.1283702
-------------+----------------------------------------------------------------
_y_B         |
       _cons |  -.4674411   .4074058    -1.15   0.251    -1.265942    .3310597
-------------+----------------------------------------------------------------
_y_C         |
       _cons |  -.1635339   .3547413    -0.46   0.645    -.8588142    .5317463
------------------------------------------------------------------------------

Estimated between-studies SDs and correlation matrix:
             SD       _y_A       _y_B       _y_C
_y_A  .67446848          1          .          .
_y_B  .67446848         .5          1          .
_y_C  .67446848         .5         .5          1
Method of moments failed when mvmeta ran, so I^2 cannot be computed
mvmeta command stored as F9
Command is: mvmeta _y _S , bscovariance(exch 0.5) longparm suppress(uv mm) eq(_
> y_A: des_AD, _y_B: des_BC des_BCD des_BD, _y_C: des_AC des_BCD des_CD) vars(_
> y_A _y_B _y_C)
Note: using method reml
Note: regressing _y_A on des_AD
Note: regressing _y_B on des_BC des_BCD des_BD
Note: regressing _y_C on des_AC des_BCD des_CD
Note: 24 observations on 3 variables
Note: variance-covariance matrix is proportional to .5*I(3)+.5*J(3,3,1)

initial:       log likelihood = -165.39193
rescale:       log likelihood = -165.39193
rescale eq:    log likelihood = -165.39193
Iteration 0:   log likelihood = -165.39193  
Iteration 1:   log likelihood = -164.66499  
Iteration 2:   log likelihood = -164.66407  
Iteration 3:   log likelihood = -164.66407  

Multivariate meta-analysis
Variance-covariance matrix = proportional .5*I(3)+.5*J(3,3,1)
Method = reml                                  Number of dimensions    =     3
Restricted log likelihood = -164.66407         Number of observations  =    24
------------------------------------------------------------------------------
             |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
_y_A         |
      des_AD |  -3.393984   1.890007    -1.80   0.073    -7.098329     .310361
       _cons |  -.1285329   .8825166    -0.15   0.884    -1.858234    1.601168
-------------+----------------------------------------------------------------
_y_B         |
      des_BC |   .8729149   1.295376     0.67   0.500    -1.665975    3.411805
     des_BCD |  -.4268637   1.302754    -0.33   0.743    -2.980215    2.126487
      des_BD |  -1.245017   1.323382    -0.94   0.347    -3.838799    1.348765
       _cons |   .2015304   .9987337     0.20   0.840    -1.755952    2.159013
-------------+----------------------------------------------------------------
_y_C         |
      des_AC |  -.3468155   .8821493    -0.39   0.694    -2.075796    1.382165
     des_BCD |   -1.14685   1.184491    -0.97   0.333    -3.468411     1.17471
      des_CD |  -1.164695   1.068672    -1.09   0.276    -3.259253    .9298642
       _cons |   .9227616   .8438742     1.09   0.274    -.7312014    2.576725
------------------------------------------------------------------------------

Estimated between-studies SDs and correlation matrix:
             SD       _y_A       _y_B       _y_C
_y_A  .74316177          1          .          .
_y_B  .74316177         .5          1          .
_y_C  .74316177         .5         .5          1

Testing for inconsistency:
 ( 1)  [_y_C]des_AC = 0
 ( 2)  [_y_A]des_AD = 0
 ( 3)  [_y_B]des_BC = 0
 ( 4)  [_y_C]des_BCD = 0
 ( 5)  [_y_B]des_BCD = 0
 ( 6)  [_y_B]des_BD = 0
 ( 7)  [_y_C]des_CD = 0

           chi2(  7) =    5.11
         Prob > chi2 =    0.6464
mvmeta command stored as F9; test command stored as F8
         studyvar                study
         design                  _design
         ref                     D
         trtlistnoref            A B C
         trtnameA                No contact
         trtnameB                Self help
         trtnameC                Individual counselling
         trtnameD                Group counselling
         maxarms                 3
         measure                 Log odds ratio
         outcome                 count
         dim                     3
         format                  augmented
         d                       d
         n                       n
         nmiss                   
         y                       _y
         S                       _S
         component               
         MNAR                    
         testcons_type           chi2
         testcons_stat           5.111151435422201
         testcons_df             7
         testcons_p              .6464009014685791
         metavars                des_AB des_AC des_ACD des_AD des_BC des_BCD de
> s_BD des_CD
         consistency_fitted      _network_consistency
         inconsistency_fitted    _network_inconsistency
         plot_location           
         ncomponents             1
         df_inconsistency        7
         df_heterogeneity        16
Command is: mvmeta _y _S , bscovariance(exch 0.5) longparm suppress(uv mm) eq(_
> y_B: groupA, _y_C: groupA groupB) vars(_y_A _y_B _y_C)
Note: using method reml
Note: regressing _y_A on (nothing)
Note: regressing _y_B on groupA
Note: regressing _y_C on groupA groupB
Note: 24 observations on 3 variables
Note: variance-covariance matrix is proportional to .5*I(3)+.5*J(3,3,1)

initial:       log likelihood = -172.32926
rescale:       log likelihood = -172.32926
rescale eq:    log likelihood = -172.32926
Iteration 0:   log likelihood = -172.32926  
Iteration 1:   log likelihood = -171.40797  
Iteration 2:   log likelihood = -171.40736  
Iteration 3:   log likelihood = -171.40736  

Multivariate meta-analysis
Variance-covariance matrix = proportional .5*I(3)+.5*J(3,3,1)
Method = reml                                  Number of dimensions    =     3
Restricted log likelihood = -171.40736         Number of observations  =    24
------------------------------------------------------------------------------
             |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
_y_A         |
       _cons |  -1.144646   .7148474    -1.60   0.109    -2.545722    .2564288
-------------+----------------------------------------------------------------
_y_B         |
      groupA |  -.2844934    1.00278    -0.28   0.777    -2.249906    1.680919
       _cons |  -.5307349   .5709473    -0.93   0.353    -1.649771    .5883012
-------------+----------------------------------------------------------------
_y_C         |
      groupA |  -.3727423   .7589939    -0.49   0.623    -1.860343    1.114858
      groupB |  -.6129134   1.064739    -0.58   0.565    -2.699764    1.473937
       _cons |  -.0695057   .4253421    -0.16   0.870    -.9031608    .7641495
------------------------------------------------------------------------------

Estimated between-studies SDs and correlation matrix:
             SD       _y_A       _y_B       _y_C
_y_A  .73386008          1          .          .
_y_B  .73386008         .5          1          .
_y_C  .73386008         .5         .5          1

Testing for inconsistency:
 ( 1)  [_y_B]groupA = 0
 ( 2)  [_y_C]groupA = 0
 ( 3)  [_y_C]groupB = 0

           chi2(  3) =    0.60
         Prob > chi2 =    0.8971
mvmeta command stored as F9; test command stored as F8
(fitting model splitting side B C)
Command is: mvmeta _y _S  , bscovariance(exch 0.5)  eq(_y_A: _trtdiffA _trtdiff
> B _trtdiffC _trtdiffincoA, _y_B: _trtdiffzero _trtdiffone _trtdiffzero _trtdi
> ffincoB, _y_C: _trtdiffzero _trtdiffzero _trtdiffone _trtdiffincoC) commonpar
> m noconst network(sidesplit) suppress(uv mm)
Note: using method reml
Note: regressing _y_A on _trtdiffA _trtdiffB _trtdiffC _trtdiffincoA
Note: regressing _y_B on _trtdiffzero _trtdiffone _trtdiffzero _trtdiffincoB
Note: regressing _y_C on _trtdiffzero _trtdiffzero _trtdiffone _trtdiffincoC
Note: 24 observations on 3 variables
Note: variance-covariance matrix is proportional to .5*I(3)+.5*J(3,3,1)

initial:       log likelihood = -174.59064
rescale:       log likelihood = -174.59064
rescale eq:    log likelihood = -174.59064
Iteration 0:   log likelihood = -174.59064  
Iteration 1:   log likelihood =  -173.2882  
Iteration 2:   log likelihood = -173.26475  
Iteration 3:   log likelihood = -173.20145  (not concave)
Iteration 4:   log likelihood = -173.15022  
Iteration 5:   log likelihood = -173.14897  
Iteration 6:   log likelihood = -173.14897  

Multivariate meta-analysis
Variance-covariance matrix = proportional .5*I(3)+.5*J(3,3,1)
Method = reml                                  Number of dimensions    =     3
Restricted log likelihood = -173.14897         Number of observations  =    24
------------------------------------------------------------------------------
             |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
_y_A         |
   _trtdiffA |  -.7990075   .3967854    -2.01   0.044    -1.576693   -.0213224
   _trtdiffB |  -.5088264   .4179625    -1.22   0.223    -1.328018     .310365
   _trtdiffC |   -.063246   .3910305    -0.16   0.872    -.8296517    .7031597
_trtdiffin~A |  -.4195991   .6350905    -0.66   0.509    -1.664354    .8251554
------------------------------------------------------------------------------
The above coefficients also apply to the following equations:
    _y_B: _trtdiffzero _trtdiffone _trtdiffzero _trtdiffincoB 
    _y_C: _trtdiffzero _trtdiffzero _trtdiffone _trtdiffincoC 

Estimated between-studies SDs and correlation matrix:
             SD       _y_A       _y_B       _y_C
_y_A  .68799606          1          .          .
_y_B  .68799606         .5          1          .
_y_C  .68799606         .5         .5          1

Results splitting B C:
------------------------------------------------------------------------------
             |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
      direct |   .0259813    .545274     0.05   0.962    -1.042736    1.094699
    indirect |   .4455804   .4064211     1.10   0.273    -.3509902    1.242151
  difference |  -.4195991   .6350905    -0.66   0.509    -1.664354    .8251554
------------------------------------------------------------------------------

Side    Direct                Indirect              Difference                 
>    tau
        Coef.      Std. Err.  Coef.      Std. Err.  Coef.      Std. Err.  P>|z|
A D      .8201393   .7576244   .8893853   .4420001  -.0692461   .8743777  0.937
>      .691252
A B      .3266968   .4431874   .5101188   .5274799   -.183422   .6881714  0.790
>     .6974406
A C      .7215198   .2132346   .5736358   .6371463    .147884   .6675915  0.825
>     .6923614
B D      .6231378   .5693373   .2974673   .6041443   .3256706   .8305237  0.695
>     .6898184
B C     -.0756829   .5752544   .5163243   .4300302  -.5920072   .7180021  0.410
>     .6845009
C D      -.075668   .4111037   .8722606   .7066256  -.9479286   .8161875  0.245
>     .6780784
Loop 1: format standard, ref No contact
(Smoking data from Lu & Ades (2006))
Treatments used
   A (reference):                      No contact
   B:                                  Self help
   C:                                  Individual counselling
   D:                                  Group counselling

Measure                                Log odds ratio

Studies
   ID variable:                        study
   Number used:                        24
   IDs with zero cells:                9 20
   - count added to all their cells:   .5

Network information                    
   Components:                         1 (connected)
   D.f. for inconsistency:             7
   D.f. for heterogeneity:             16

Current data
   Data format:                        standard
   Design variable:                    _design
   Estimate variables:                 _y*
   Variance variables:                 _S*
   Contrast variables:                 _contrast*
   Command to list the data:           list study _design _contrast* _y* _S*, n
> oo sepby(_design)

----------------------------------------------------------------
          |               Treatment and Statistic               
          | - No con -    - Self h -    - Indivi -    - Group  -
    study |    d     n       d     n       d     n       d     n
----------+-----------------------------------------------------
        1 |    9   140                    23   140      10   138
        2 |                 11    78      12    85      29   170
        3 |   79   702      77   694                            
        4 |   18   671      21   535                            
        5 |    8   116      19   146                            
        6 |   75   731                   363   714              
        7 |    2   106                     9   205              
        8 |   58   549                   237  1561              
        9 |   .5    34                   9.5    49              
       10 |    3   100                    31    98              
       11 |    1    31                    26    95              
       12 |    6    39                    17    77              
       13 |   95  1107                   134  1031              
       14 |   15   187                    35   504              
       15 |   78   584                    73   675              
       16 |   69  1177                    54   888              
       17 |   64   642                   107   761              
       18 |    5    62                     8    90              
       19 |   20   234                    34   237              
       20 |   .5    21                                 9.5    21
       21 |                 20    49      16    43              
       22 |                  7    66                    32   127
       23 |                               12    76      20    74
       24 |                                9    55       3    26
----------------------------------------------------------------
Warning: i2 option is not meaningful in standard format
Command is: mvmeta _y _S , i2 bscovariance(exch 0.5) commonparm noconstant supp
> ress(uv mm) eq(_y_1: _trtdiff1_B _trtdiff1_C _trtdiff1_D, _y_2: _trtdiff2_B _
> trtdiff2_C _trtdiff2_D) vars(_y_1 _y_2)
Note: using method reml
Note: regressing _y_1 on _trtdiff1_B _trtdiff1_C _trtdiff1_D
Note: regressing _y_2 on _trtdiff2_B _trtdiff2_C _trtdiff2_D
Note: 24 observations on 2 variables
Note: variance-covariance matrix is proportional to .5*I(2)+.5*J(2,2,1)

initial:       log likelihood = -34.471727
rescale:       log likelihood = -34.471727
rescale eq:    log likelihood = -34.259312
Iteration 0:   log likelihood = -34.259312  
Iteration 1:   log likelihood = -32.844434  
Iteration 2:   log likelihood = -32.817175  
Iteration 3:   log likelihood = -32.817057  
Iteration 4:   log likelihood = -32.817057  

Multivariate meta-analysis
Variance-covariance matrix = proportional .5*I(2)+.5*J(2,2,1)
Method = reml                                  Number of dimensions    =     2
Restricted log likelihood = -32.817057         Number of observations  =    24
------------------------------------------------------------------------------
             |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
_y_1         |
 _trtdiff1_B |   .3984487   .3311044     1.20   0.229     -.250504    1.047401
 _trtdiff1_C |   .7023556   .1991095     3.53   0.000     .3121081    1.092603
 _trtdiff1_D |   .8658902   .3762928     2.30   0.021     .1283699    1.603411
------------------------------------------------------------------------------
The above coefficients also apply to the following equations:
    _y_2: _trtdiff2_B _trtdiff2_C _trtdiff2_D 

Estimated between-studies SDs and correlation matrix:
             SD       _y_1       _y_2
_y_1  .67446638          1          .
_y_2  .67446638         .5          1
Method of moments failed when mvmeta ran, so I^2 cannot be computed
mvmeta command stored as F9
Command is: mvmeta _y _S , bscovariance(exch 0.5) commonparm noconstant suppres
> s(uv mm) eq(_y_1: _trtdiff1_B _trtdiff1_C _trtdiff1_D _trtdiff1_C_des_ACD _tr
> tdiff1_D_des_AD _trtdiff1_C_des_BC _trtdiff1_C_des_BCD _trtdiff1_D_des_BCD _t
> rtdiff1_D_des_BD _trtdiff1_D_des_CD, _y_2: _trtdiff2_B _trtdiff2_C _trtdiff2_
> D _trtdiff2_C_des_ACD _trtdiff2_D_des_AD _trtdiff2_C_des_BC _trtdiff2_C_des_B
> CD _trtdiff2_D_des_BCD _trtdiff2_D_des_BD _trtdiff2_D_des_CD) vars(_y_1 _y_2)
Note: using method reml
Note: regressing _y_1 on _trtdiff1_B _trtdiff1_C _trtdiff1_D _trtdiff1_C_des_AC
> D _trtdiff1_D_des_AD _trtdiff1_C_des_BC _trtdiff1_C_des_BCD _trtdiff1_D_des_B
> CD _trtdiff1_D_des_BD _trtdiff1_D_des_CD
Note: regressing _y_2 on _trtdiff2_B _trtdiff2_C _trtdiff2_D _trtdiff2_C_des_AC
> D _trtdiff2_D_des_AD _trtdiff2_C_des_BC _trtdiff2_C_des_BCD _trtdiff2_D_des_B
> CD _trtdiff2_D_des_BD _trtdiff2_D_des_CD
Note: 24 observations on 2 variables
Note: variance-covariance matrix is proportional to .5*I(2)+.5*J(2,2,1)

initial:       log likelihood = -24.381433
rescale:       log likelihood = -24.381433
rescale eq:    log likelihood = -24.381433
Iteration 0:   log likelihood = -24.381433  
Iteration 1:   log likelihood = -23.654263  
Iteration 2:   log likelihood = -23.653575  
Iteration 3:   log likelihood = -23.653575  

Multivariate meta-analysis
Variance-covariance matrix = proportional .5*I(2)+.5*J(2,2,1)
Method = reml                                  Number of dimensions    =     2
Restricted log likelihood = -23.653575         Number of observations  =    24
------------------------------------------------------------------------------
             |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
_y_1         |
 _trtdiff1_B |   .3300634   .4675836     0.71   0.480    -.5863837     1.24651
 _trtdiff1_C |   .7044794   .2348016     3.00   0.003     .2442767    1.164682
 _trtdiff1_D |   .1285276   .8825236     0.15   0.884    -1.601187    1.858242
~1_C_des_ACD |   .3468136   .8821522     0.39   0.694    -1.382173      2.0758
_trtdiff1~AD |   3.393989    1.89001     1.80   0.073    -.3103627    7.098341
_trtdiff1~BC |  -.5261006   1.004558    -0.52   0.600    -2.494998    1.442796
~1_C_des_BCD |  -.3731715   1.013895    -0.37   0.713    -2.360369    1.614026
~1_D_des_BCD |   .4268691    1.30276     0.33   0.743    -2.126493    2.980231
_trtdiff1~BD |   1.245022   1.323388     0.94   0.347    -1.348771    3.838815
_~1_D_des_CD |   .8178847   1.123174     0.73   0.466    -1.383496    3.019265
------------------------------------------------------------------------------
The above coefficients also apply to the following equations:
    _y_2: _trtdiff2_B _trtdiff2_C _trtdiff2_D _trtdiff2_C_des_ACD _trtdiff2_D_d
> es_AD _trtdiff2_C_des_BC _trtdiff2_C_des_BCD _trtdiff2_D_des_BCD _trtdiff2_D_
> des_BD _trtdiff2_D_des_CD 

Estimated between-studies SDs and correlation matrix:
             SD       _y_1       _y_2
_y_1  .74316262          1          .
_y_2  .74316262         .5          1

Testing for inconsistency:
 ( 1)  [_y_1]_trtdiff1_C_des_ACD = 0
 ( 2)  [_y_1]_trtdiff1_D_des_AD = 0
 ( 3)  [_y_1]_trtdiff1_C_des_BC = 0
 ( 4)  [_y_1]_trtdiff1_C_des_BCD = 0
 ( 5)  [_y_1]_trtdiff1_D_des_BCD = 0
 ( 6)  [_y_1]_trtdiff1_D_des_BD = 0
 ( 7)  [_y_1]_trtdiff1_D_des_CD = 0

           chi2(  7) =    5.11
         Prob > chi2 =    0.6464
mvmeta command stored as F9; test command stored as F8
         studyvar                study
         design                  _design
         ref                     A
         trtlistnoref            B C D
         trtnameA                No contact
         trtnameB                Self help
         trtnameC                Individual counselling
         trtnameD                Group counselling
         maxarms                 3
         measure                 Log odds ratio
         outcome                 count
         dim                     2
         format                  standard
         d                       d
         n                       n
         nmiss                   
         y                       _y
         S                       _S
         contrast                _contrast
         trtdiff                 _trtdiff
         component               
         MNAR                    
         testcons_type           chi2
         testcons_stat           5.111146886440846
         testcons_df             7
         testcons_p              .6464014562953568
         metavars                _trtdiff1_B _trtdiff1_C _trtdiff1_D _trtdiff2_
> B _trtdiff2_C _trtdiff2_D des_AB des_AC des_ACD des_AD des_BC des_BCD des_BD 
> des_CD _trtdiff1_C_des_ACD _trtdiff2_C_des_ACD _trtdiff1_D_des_AD _trtdiff2_D
> _des_AD _trtdiff1_C_des_BC _trtdiff2_C_des_BC _trtdiff1_C_des_BCD _trtdiff2_C
> _des_BCD _trtdiff1_D_des_BCD _trtdiff2_D_des_BCD _trtdiff1_D_des_BD _trtdiff2
> _D_des_BD _trtdiff1_D_des_CD _trtdiff2_D_des_CD
         consistency_fitted      _network_consistency
         inconsistency_fitted    _network_inconsistency
         plot_location           
         ncomponents             1
         df_inconsistency        7
         df_heterogeneity        16
Loop 1: format standard, ref Self help
(Smoking data from Lu & Ades (2006))
Treatments used
   A:                                  No contact
   B (reference):                      Self help
   C:                                  Individual counselling
   D:                                  Group counselling

Measure                                Log odds ratio

Studies
   ID variable:                        study
   Number used:                        24
   IDs with zero cells:                9 20
   - count added to all their cells:   .5

Network information                    
   Components:                         1 (connected)
   D.f. for inconsistency:             7
   D.f. for heterogeneity:             16

Current data
   Data format:                        standard
   Design variable:                    _design
   Estimate variables:                 _y*
   Variance variables:                 _S*
   Contrast variables:                 _contrast*
   Command to list the data:           list study _design _contrast* _y* _S*, n
> oo sepby(_design)

----------------------------------------------------------------
          |               Treatment and Statistic               
          | - Self h -    - No con -    - Indivi -    - Group  -
    study |    d     n       d     n       d     n       d     n
----------+-----------------------------------------------------
        1 |                  9   140      23   140      10   138
        2 |   11    78                    12    85      29   170
        3 |   77   694      79   702                            
        4 |   21   535      18   671                            
        5 |   19   146       8   116                            
        6 |                 75   731     363   714              
        7 |                  2   106       9   205              
        8 |                 58   549     237  1561              
        9 |                 .5    34     9.5    49              
       10 |                  3   100      31    98              
       11 |                  1    31      26    95              
       12 |                  6    39      17    77              
       13 |                 95  1107     134  1031              
       14 |                 15   187      35   504              
       15 |                 78   584      73   675              
       16 |                 69  1177      54   888              
       17 |                 64   642     107   761              
       18 |                  5    62       8    90              
       19 |                 20   234      34   237              
       20 |                 .5    21                   9.5    21
       21 |   20    49                    16    43              
       22 |    7    66                                  32   127
       23 |                               12    76      20    74
       24 |                                9    55       3    26
----------------------------------------------------------------
Warning: i2 option is not meaningful in standard format
Command is: mvmeta _y _S , i2 bscovariance(exch 0.5) commonparm noconstant supp
> ress(uv mm) eq(_y_1: _trtdiff1_A _trtdiff1_C _trtdiff1_D, _y_2: _trtdiff2_A _
> trtdiff2_C _trtdiff2_D) vars(_y_1 _y_2)
Note: using method reml
Note: regressing _y_1 on _trtdiff1_A _trtdiff1_C _trtdiff1_D
Note: regressing _y_2 on _trtdiff2_A _trtdiff2_C _trtdiff2_D
Note: 24 observations on 2 variables
Note: variance-covariance matrix is proportional to .5*I(2)+.5*J(2,2,1)

initial:       log likelihood = -34.471727
rescale:       log likelihood = -34.471727
rescale eq:    log likelihood = -34.259312
Iteration 0:   log likelihood = -34.259312  
Iteration 1:   log likelihood =  -32.84443  
Iteration 2:   log likelihood = -32.817175  
Iteration 3:   log likelihood = -32.817057  
Iteration 4:   log likelihood = -32.817057  

Multivariate meta-analysis
Variance-covariance matrix = proportional .5*I(2)+.5*J(2,2,1)
Method = reml                                  Number of dimensions    =     2
Restricted log likelihood = -32.817057         Number of observations  =    24
------------------------------------------------------------------------------
             |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
_y_1         |
 _trtdiff1_A |  -.3984487   .3311044    -1.20   0.229    -1.047401     .250504
 _trtdiff1_C |   .3039069   .3405171     0.89   0.372    -.3634944    .9713082
 _trtdiff1_D |   .4674415   .4074053     1.15   0.251    -.3310581    1.265941
------------------------------------------------------------------------------
The above coefficients also apply to the following equations:
    _y_2: _trtdiff2_A _trtdiff2_C _trtdiff2_D 

Estimated between-studies SDs and correlation matrix:
             SD       _y_1       _y_2
_y_1  .67446638          1          .
_y_2  .67446638         .5          1
Method of moments failed when mvmeta ran, so I^2 cannot be computed
mvmeta command stored as F9
Command is: mvmeta _y _S , bscovariance(exch 0.5) commonparm noconstant suppres
> s(uv mm) eq(_y_1: _trtdiff1_A _trtdiff1_C _trtdiff1_D _trtdiff1_C_des_ACD _tr
> tdiff1_D_des_AD _trtdiff1_C_des_BC _trtdiff1_C_des_BCD _trtdiff1_D_des_BCD _t
> rtdiff1_D_des_BD _trtdiff1_D_des_CD, _y_2: _trtdiff2_A _trtdiff2_C _trtdiff2_
> D _trtdiff2_C_des_ACD _trtdiff2_D_des_AD _trtdiff2_C_des_BC _trtdiff2_C_des_B
> CD _trtdiff2_D_des_BCD _trtdiff2_D_des_BD _trtdiff2_D_des_CD) vars(_y_1 _y_2)
Note: using method reml
Note: regressing _y_1 on _trtdiff1_A _trtdiff1_C _trtdiff1_D _trtdiff1_C_des_AC
> D _trtdiff1_D_des_AD _trtdiff1_C_des_BC _trtdiff1_C_des_BCD _trtdiff1_D_des_B
> CD _trtdiff1_D_des_BD _trtdiff1_D_des_CD
Note: regressing _y_2 on _trtdiff2_A _trtdiff2_C _trtdiff2_D _trtdiff2_C_des_AC
> D _trtdiff2_D_des_AD _trtdiff2_C_des_BC _trtdiff2_C_des_BCD _trtdiff2_D_des_B
> CD _trtdiff2_D_des_BD _trtdiff2_D_des_CD
Note: 24 observations on 2 variables
Note: variance-covariance matrix is proportional to .5*I(2)+.5*J(2,2,1)

initial:       log likelihood = -24.381433
rescale:       log likelihood = -24.381433
rescale eq:    log likelihood = -24.381433
Iteration 0:   log likelihood = -24.381433  
Iteration 1:   log likelihood = -23.654259  
Iteration 2:   log likelihood = -23.653575  
Iteration 3:   log likelihood = -23.653575  

Multivariate meta-analysis
Variance-covariance matrix = proportional .5*I(2)+.5*J(2,2,1)
Method = reml                                  Number of dimensions    =     2
Restricted log likelihood = -23.653575         Number of observations  =    24
------------------------------------------------------------------------------
             |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
_y_1         |
 _trtdiff1_A |  -.3300634   .4675836    -0.71   0.480     -1.24651    .5863837
 _trtdiff1_C |   .3744161   .5223271     0.72   0.473    -.6493263    1.398158
 _trtdiff1_D |  -.2015358   .9987403    -0.20   0.840    -2.159031    1.755959
~1_C_des_ACD |   .3468136   .8821522     0.39   0.694    -1.382173      2.0758
_trtdiff1~AD |   3.393989    1.89001     1.80   0.073    -.3103627    7.098341
_trtdiff1~BC |  -.5261006   1.004558    -0.52   0.600    -2.494997    1.442796
~1_C_des_BCD |  -.3731715   1.013895    -0.37   0.713    -2.360369    1.614026
~1_D_des_BCD |   .4268691   1.302759     0.33   0.743    -2.126493    2.980231
_trtdiff1~BD |   1.245022   1.323388     0.94   0.347     -1.34877    3.838815
_~1_D_des_CD |   .8178847   1.123174     0.73   0.466    -1.383496    3.019265
------------------------------------------------------------------------------
The above coefficients also apply to the following equations:
    _y_2: _trtdiff2_A _trtdiff2_C _trtdiff2_D _trtdiff2_C_des_ACD _trtdiff2_D_d
> es_AD _trtdiff2_C_des_BC _trtdiff2_C_des_BCD _trtdiff2_D_des_BCD _trtdiff2_D_
> des_BD _trtdiff2_D_des_CD 

Estimated between-studies SDs and correlation matrix:
             SD       _y_1       _y_2
_y_1  .74316262          1          .
_y_2  .74316262         .5          1

Testing for inconsistency:
 ( 1)  [_y_1]_trtdiff1_C_des_ACD = 0
 ( 2)  [_y_1]_trtdiff1_D_des_AD = 0
 ( 3)  [_y_1]_trtdiff1_C_des_BC = 0
 ( 4)  [_y_1]_trtdiff1_C_des_BCD = 0
 ( 5)  [_y_1]_trtdiff1_D_des_BCD = 0
 ( 6)  [_y_1]_trtdiff1_D_des_BD = 0
 ( 7)  [_y_1]_trtdiff1_D_des_CD = 0

           chi2(  7) =    5.11
         Prob > chi2 =    0.6464
mvmeta command stored as F9; test command stored as F8
         studyvar                study
         design                  _design
         ref                     B
         trtlistnoref            A C D
         trtnameA                No contact
         trtnameB                Self help
         trtnameC                Individual counselling
         trtnameD                Group counselling
         maxarms                 3
         measure                 Log odds ratio
         outcome                 count
         dim                     2
         format                  standard
         d                       d
         n                       n
         nmiss                   
         y                       _y
         S                       _S
         contrast                _contrast
         trtdiff                 _trtdiff
         component               
         MNAR                    
         testcons_type           chi2
         testcons_stat           5.111146959368493
         testcons_df             7
         testcons_p              .6464014474005717
         metavars                _trtdiff1_A _trtdiff1_C _trtdiff1_D _trtdiff2_
> A _trtdiff2_C _trtdiff2_D des_AB des_AC des_ACD des_AD des_BC des_BCD des_BD 
> des_CD _trtdiff1_C_des_ACD _trtdiff2_C_des_ACD _trtdiff1_D_des_AD _trtdiff2_D
> _des_AD _trtdiff1_C_des_BC _trtdiff2_C_des_BC _trtdiff1_C_des_BCD _trtdiff2_C
> _des_BCD _trtdiff1_D_des_BCD _trtdiff2_D_des_BCD _trtdiff1_D_des_BD _trtdiff2
> _D_des_BD _trtdiff1_D_des_CD _trtdiff2_D_des_CD
         consistency_fitted      _network_consistency
         inconsistency_fitted    _network_inconsistency
         plot_location           
         ncomponents             1
         df_inconsistency        7
         df_heterogeneity        16
Loop 1: format standard, ref Individual counselling
(Smoking data from Lu & Ades (2006))
Treatments used
   A:                                  No contact
   B:                                  Self help
   C (reference):                      Individual counselling
   D:                                  Group counselling

Measure                                Log odds ratio

Studies
   ID variable:                        study
   Number used:                        24
   IDs with zero cells:                9 20
   - count added to all their cells:   .5

Network information                    
   Components:                         1 (connected)
   D.f. for inconsistency:             7
   D.f. for heterogeneity:             16

Current data
   Data format:                        standard
   Design variable:                    _design
   Estimate variables:                 _y*
   Variance variables:                 _S*
   Contrast variables:                 _contrast*
   Command to list the data:           list study _design _contrast* _y* _S*, n
> oo sepby(_design)

----------------------------------------------------------------
          |               Treatment and Statistic               
          | - Indivi -    - No con -    - Self h -    - Group  -
    study |    d     n       d     n       d     n       d     n
----------+-----------------------------------------------------
        1 |   23   140       9   140                    10   138
        2 |   12    85                    11    78      29   170
        3 |                 79   702      77   694              
        4 |                 18   671      21   535              
        5 |                  8   116      19   146              
        6 |  363   714      75   731                            
        7 |    9   205       2   106                            
        8 |  237  1561      58   549                            
        9 |  9.5    49      .5    34                            
       10 |   31    98       3   100                            
       11 |   26    95       1    31                            
       12 |   17    77       6    39                            
       13 |  134  1031      95  1107                            
       14 |   35   504      15   187                            
       15 |   73   675      78   584                            
       16 |   54   888      69  1177                            
       17 |  107   761      64   642                            
       18 |    8    90       5    62                            
       19 |   34   237      20   234                            
       20 |                 .5    21                   9.5    21
       21 |   16    43                    20    49              
       22 |                                7    66      32   127
       23 |   12    76                                  20    74
       24 |    9    55                                   3    26
----------------------------------------------------------------
Warning: i2 option is not meaningful in standard format
Command is: mvmeta _y _S , i2 bscovariance(exch 0.5) commonparm noconstant supp
> ress(uv mm) eq(_y_1: _trtdiff1_A _trtdiff1_B _trtdiff1_D, _y_2: _trtdiff2_A _
> trtdiff2_B _trtdiff2_D) vars(_y_1 _y_2)
Note: using method reml
Note: regressing _y_1 on _trtdiff1_A _trtdiff1_B _trtdiff1_D
Note: regressing _y_2 on _trtdiff2_A _trtdiff2_B _trtdiff2_D
Note: 24 observations on 2 variables
Note: variance-covariance matrix is proportional to .5*I(2)+.5*J(2,2,1)

initial:       log likelihood = -34.471727
rescale:       log likelihood = -34.471727
rescale eq:    log likelihood = -34.259312
Iteration 0:   log likelihood = -34.259312  
Iteration 1:   log likelihood = -32.844428  
Iteration 2:   log likelihood = -32.817175  
Iteration 3:   log likelihood = -32.817057  
Iteration 4:   log likelihood = -32.817057  

Multivariate meta-analysis
Variance-covariance matrix = proportional .5*I(2)+.5*J(2,2,1)
Method = reml                                  Number of dimensions    =     2
Restricted log likelihood = -32.817057         Number of observations  =    24
------------------------------------------------------------------------------
             |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
_y_1         |
 _trtdiff1_A |  -.7023556   .1991095    -3.53   0.000    -1.092603   -.3121081
 _trtdiff1_B |  -.3039069   .3405171    -0.89   0.372    -.9713082    .3634944
 _trtdiff1_D |   .1635346    .354741     0.46   0.645     -.531745    .8588143
------------------------------------------------------------------------------
The above coefficients also apply to the following equations:
    _y_2: _trtdiff2_A _trtdiff2_B _trtdiff2_D 

Estimated between-studies SDs and correlation matrix:
             SD       _y_1       _y_2
_y_1  .67446638          1          .
_y_2  .67446638         .5          1
Method of moments failed when mvmeta ran, so I^2 cannot be computed
mvmeta command stored as F9
Command is: mvmeta _y _S , bscovariance(exch 0.5) commonparm noconstant suppres
> s(uv mm) eq(_y_1: _trtdiff1_A _trtdiff1_B _trtdiff1_D _trtdiff1_A_des_ACD _tr
> tdiff1_D_des_AD _trtdiff1_B_des_BC _trtdiff1_B_des_BCD _trtdiff1_D_des_BCD _t
> rtdiff1_D_des_BD _trtdiff1_D_des_CD, _y_2: _trtdiff2_A _trtdiff2_B _trtdiff2_
> D _trtdiff2_A_des_ACD _trtdiff2_D_des_AD _trtdiff2_B_des_BC _trtdiff2_B_des_B
> CD _trtdiff2_D_des_BCD _trtdiff2_D_des_BD _trtdiff2_D_des_CD) vars(_y_1 _y_2)
Note: using method reml
Note: regressing _y_1 on _trtdiff1_A _trtdiff1_B _trtdiff1_D _trtdiff1_A_des_AC
> D _trtdiff1_D_des_AD _trtdiff1_B_des_BC _trtdiff1_B_des_BCD _trtdiff1_D_des_B
> CD _trtdiff1_D_des_BD _trtdiff1_D_des_CD
Note: regressing _y_2 on _trtdiff2_A _trtdiff2_B _trtdiff2_D _trtdiff2_A_des_AC
> D _trtdiff2_D_des_AD _trtdiff2_B_des_BC _trtdiff2_B_des_BCD _trtdiff2_D_des_B
> CD _trtdiff2_D_des_BD _trtdiff2_D_des_CD
Note: 24 observations on 2 variables
Note: variance-covariance matrix is proportional to .5*I(2)+.5*J(2,2,1)

initial:       log likelihood = -24.381433
rescale:       log likelihood = -24.381433
rescale eq:    log likelihood = -24.381433
Iteration 0:   log likelihood = -24.381433  
Iteration 1:   log likelihood = -23.654258  
Iteration 2:   log likelihood = -23.653575  
Iteration 3:   log likelihood = -23.653575  

Multivariate meta-analysis
Variance-covariance matrix = proportional .5*I(2)+.5*J(2,2,1)
Method = reml                                  Number of dimensions    =     2
Restricted log likelihood = -23.653575         Number of observations  =    24
------------------------------------------------------------------------------
             |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
_y_1         |
 _trtdiff1_A |  -.7044794   .2348016    -3.00   0.003    -1.164682   -.2442767
 _trtdiff1_B |  -.3744161   .5223272    -0.72   0.473    -1.398158    .6493264
 _trtdiff1_D |  -.9227655    .843877    -1.09   0.274    -2.576734    .7312031
~1_A_des_ACD |  -.3468136   .8821522    -0.39   0.694      -2.0758    1.382173
_trtdiff1~AD |   3.740803   1.886942     1.98   0.047      .042464    7.439142
_trtdiff1_~C |   .5261006   1.004558     0.52   0.600    -1.442796    2.494998
~1_B_des_BCD |   .3731715   1.013895     0.37   0.713    -1.614026    2.360369
~1_D_des_BCD |   1.146854   1.184494     0.97   0.333    -1.174711     3.46842
_trtdiff1~BD |   1.591836   1.318646     1.21   0.227    -.9926631    4.176334
_~1_D_des_CD |   1.164698   1.068675     1.09   0.276    -.9298656    3.259262
------------------------------------------------------------------------------
The above coefficients also apply to the following equations:
    _y_2: _trtdiff2_A _trtdiff2_B _trtdiff2_D _trtdiff2_A_des_ACD _trtdiff2_D_d
> es_AD _trtdiff2_B_des_BC _trtdiff2_B_des_BCD _trtdiff2_D_des_BCD _trtdiff2_D_
> des_BD _trtdiff2_D_des_CD 

Estimated between-studies SDs and correlation matrix:
             SD       _y_1       _y_2
_y_1  .74316262          1          .
_y_2  .74316262         .5          1

Testing for inconsistency:
 ( 1)  [_y_1]_trtdiff1_A_des_ACD = 0
 ( 2)  [_y_1]_trtdiff1_D_des_AD = 0
 ( 3)  [_y_1]_trtdiff1_B_des_BC = 0
 ( 4)  [_y_1]_trtdiff1_B_des_BCD = 0
 ( 5)  [_y_1]_trtdiff1_D_des_BCD = 0
 ( 6)  [_y_1]_trtdiff1_D_des_BD = 0
 ( 7)  [_y_1]_trtdiff1_D_des_CD = 0

           chi2(  7) =    5.11
         Prob > chi2 =    0.6464
mvmeta command stored as F9; test command stored as F8
         studyvar                study
         design                  _design
         ref                     C
         trtlistnoref            A B D
         trtnameA                No contact
         trtnameB                Self help
         trtnameC                Individual counselling
         trtnameD                Group counselling
         maxarms                 3
         measure                 Log odds ratio
         outcome                 count
         dim                     2
         format                  standard
         d                       d
         n                       n
         nmiss                   
         y                       _y
         S                       _S
         contrast                _contrast
         trtdiff                 _trtdiff
         component               
         MNAR                    
         testcons_type           chi2
         testcons_stat           5.111146908002072
         testcons_df             7
         testcons_p              .6464014536655932
         metavars                _trtdiff1_A _trtdiff1_B _trtdiff1_D _trtdiff2_
> A _trtdiff2_B _trtdiff2_D des_AB des_AC des_ACD des_AD des_BC des_BCD des_BD 
> des_CD _trtdiff1_A_des_ACD _trtdiff2_A_des_ACD _trtdiff1_D_des_AD _trtdiff2_D
> _des_AD _trtdiff1_B_des_BC _trtdiff2_B_des_BC _trtdiff1_B_des_BCD _trtdiff2_B
> _des_BCD _trtdiff1_D_des_BCD _trtdiff2_D_des_BCD _trtdiff1_D_des_BD _trtdiff2
> _D_des_BD _trtdiff1_D_des_CD _trtdiff2_D_des_CD
         consistency_fitted      _network_consistency
         inconsistency_fitted    _network_inconsistency
         plot_location           
         ncomponents             1
         df_inconsistency        7
         df_heterogeneity        16
Loop 1: format standard, ref Group counselling
(Smoking data from Lu & Ades (2006))
Treatments used
   A:                                  No contact
   B:                                  Self help
   C:                                  Individual counselling
   D (reference):                      Group counselling

Measure                                Log odds ratio

Studies
   ID variable:                        study
   Number used:                        24
   IDs with zero cells:                9 20
   - count added to all their cells:   .5

Network information                    
   Components:                         1 (connected)
   D.f. for inconsistency:             7
   D.f. for heterogeneity:             16

Current data
   Data format:                        standard
   Design variable:                    _design
   Estimate variables:                 _y*
   Variance variables:                 _S*
   Contrast variables:                 _contrast*
   Command to list the data:           list study _design _contrast* _y* _S*, n
> oo sepby(_design)

----------------------------------------------------------------
          |               Treatment and Statistic               
          | - Group  -    - No con -    - Self h -    - Indivi -
    study |    d     n       d     n       d     n       d     n
----------+-----------------------------------------------------
        1 |   10   138       9   140                    23   140
        2 |   29   170                    11    78      12    85
        3 |                 79   702      77   694              
        4 |                 18   671      21   535              
        5 |                  8   116      19   146              
        6 |                 75   731                   363   714
        7 |                  2   106                     9   205
        8 |                 58   549                   237  1561
        9 |                 .5    34                   9.5    49
       10 |                  3   100                    31    98
       11 |                  1    31                    26    95
       12 |                  6    39                    17    77
       13 |                 95  1107                   134  1031
       14 |                 15   187                    35   504
       15 |                 78   584                    73   675
       16 |                 69  1177                    54   888
       17 |                 64   642                   107   761
       18 |                  5    62                     8    90
       19 |                 20   234                    34   237
       20 |  9.5    21      .5    21                            
       21 |                               20    49      16    43
       22 |   32   127                     7    66              
       23 |   20    74                                  12    76
       24 |    3    26                                   9    55
----------------------------------------------------------------
Warning: i2 option is not meaningful in standard format
Command is: mvmeta _y _S , i2 bscovariance(exch 0.5) commonparm noconstant supp
> ress(uv mm) eq(_y_1: _trtdiff1_A _trtdiff1_B _trtdiff1_C, _y_2: _trtdiff2_A _
> trtdiff2_B _trtdiff2_C) vars(_y_1 _y_2)
Note: using method reml
Note: regressing _y_1 on _trtdiff1_A _trtdiff1_B _trtdiff1_C
Note: regressing _y_2 on _trtdiff2_A _trtdiff2_B _trtdiff2_C
Note: 24 observations on 2 variables
Note: variance-covariance matrix is proportional to .5*I(2)+.5*J(2,2,1)

initial:       log likelihood = -34.471727
rescale:       log likelihood = -34.471727
rescale eq:    log likelihood = -34.259312
Iteration 0:   log likelihood = -34.259312  
Iteration 1:   log likelihood = -32.844423  
Iteration 2:   log likelihood = -32.817174  
Iteration 3:   log likelihood = -32.817057  
Iteration 4:   log likelihood = -32.817057  

Multivariate meta-analysis
Variance-covariance matrix = proportional .5*I(2)+.5*J(2,2,1)
Method = reml                                  Number of dimensions    =     2
Restricted log likelihood = -32.817057         Number of observations  =    24
------------------------------------------------------------------------------
             |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
_y_1         |
 _trtdiff1_A |  -.8658902   .3762928    -2.30   0.021    -1.603411   -.1283699
 _trtdiff1_B |  -.4674415   .4074053    -1.15   0.251    -1.265941    .3310581
 _trtdiff1_C |  -.1635346    .354741    -0.46   0.645    -.8588143     .531745
------------------------------------------------------------------------------
The above coefficients also apply to the following equations:
    _y_2: _trtdiff2_A _trtdiff2_B _trtdiff2_C 

Estimated between-studies SDs and correlation matrix:
             SD       _y_1       _y_2
_y_1  .67446638          1          .
_y_2  .67446638         .5          1
Method of moments failed when mvmeta ran, so I^2 cannot be computed
mvmeta command stored as F9
Command is: mvmeta _y _S , bscovariance(exch 0.5) commonparm noconstant suppres
> s(uv mm) eq(_y_1: _trtdiff1_A _trtdiff1_B _trtdiff1_C _trtdiff1_C_des_AC _trt
> diff1_A_des_AD _trtdiff1_B_des_BC _trtdiff1_C_des_BCD _trtdiff1_B_des_BCD _tr
> tdiff1_B_des_BD _trtdiff1_C_des_CD, _y_2: _trtdiff2_A _trtdiff2_B _trtdiff2_C
>  _trtdiff2_C_des_AC _trtdiff2_A_des_AD _trtdiff2_B_des_BC _trtdiff2_C_des_BCD
>  _trtdiff2_B_des_BCD _trtdiff2_B_des_BD _trtdiff2_C_des_CD) vars(_y_1 _y_2)
Note: using method reml
Note: regressing _y_1 on _trtdiff1_A _trtdiff1_B _trtdiff1_C _trtdiff1_C_des_AC
>  _trtdiff1_A_des_AD _trtdiff1_B_des_BC _trtdiff1_C_des_BCD _trtdiff1_B_des_BC
> D _trtdiff1_B_des_BD _trtdiff1_C_des_CD
Note: regressing _y_2 on _trtdiff2_A _trtdiff2_B _trtdiff2_C _trtdiff2_C_des_AC
>  _trtdiff2_A_des_AD _trtdiff2_B_des_BC _trtdiff2_C_des_BCD _trtdiff2_B_des_BC
> D _trtdiff2_B_des_BD _trtdiff2_C_des_CD
Note: 24 observations on 2 variables
Note: variance-covariance matrix is proportional to .5*I(2)+.5*J(2,2,1)

initial:       log likelihood = -24.381433
rescale:       log likelihood = -24.381433
rescale eq:    log likelihood = -24.381433
Iteration 0:   log likelihood = -24.381433  
Iteration 1:   log likelihood = -23.654262  
Iteration 2:   log likelihood = -23.653575  
Iteration 3:   log likelihood = -23.653575  

Multivariate meta-analysis
Variance-covariance matrix = proportional .5*I(2)+.5*J(2,2,1)
Method = reml                                  Number of dimensions    =     2
Restricted log likelihood = -23.653575         Number of observations  =    24
------------------------------------------------------------------------------
             |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
_y_1         |
 _trtdiff1_A |  -.1285276   .8825236    -0.15   0.884    -1.858242    1.601187
 _trtdiff1_B |   .2015358   .9987404     0.20   0.840    -1.755959    2.159031
 _trtdiff1_C |   .9227655    .843877     1.09   0.274    -.7312031    2.576734
_trtdiff1~AC |  -.3468136   .8821521    -0.39   0.694      -2.0758    1.382173
_trtdiff1~AD |  -3.393989    1.89001    -1.80   0.073    -7.098341    .3103628
_trtdiff1~BC |   .8729143   1.295379     0.67   0.500    -1.665981     3.41181
~1_C_des_BCD |  -1.146854   1.184494    -0.97   0.333     -3.46842    1.174711
~1_B_des_BCD |  -.4268691    1.30276    -0.33   0.743    -2.980231    2.126493
_trtdiff1~BD |  -1.245022   1.323388    -0.94   0.347    -3.838815    1.348771
_~1_C_des_CD |  -1.164698   1.068675    -1.09   0.276    -3.259262    .9298656
------------------------------------------------------------------------------
The above coefficients also apply to the following equations:
    _y_2: _trtdiff2_A _trtdiff2_B _trtdiff2_C _trtdiff2_C_des_AC _trtdiff2_A_de
> s_AD _trtdiff2_B_des_BC _trtdiff2_C_des_BCD _trtdiff2_B_des_BCD _trtdiff2_B_d
> es_BD _trtdiff2_C_des_CD 

Estimated between-studies SDs and correlation matrix:
             SD       _y_1       _y_2
_y_1  .74316262          1          .
_y_2  .74316262         .5          1

Testing for inconsistency:
 ( 1)  [_y_1]_trtdiff1_C_des_AC = 0
 ( 2)  [_y_1]_trtdiff1_A_des_AD = 0
 ( 3)  [_y_1]_trtdiff1_B_des_BC = 0
 ( 4)  [_y_1]_trtdiff1_C_des_BCD = 0
 ( 5)  [_y_1]_trtdiff1_B_des_BCD = 0
 ( 6)  [_y_1]_trtdiff1_B_des_BD = 0
 ( 7)  [_y_1]_trtdiff1_C_des_CD = 0

           chi2(  7) =    5.11
         Prob > chi2 =    0.6464
mvmeta command stored as F9; test command stored as F8
         studyvar                study
         design                  _design
         ref                     D
         trtlistnoref            A B C
         trtnameA                No contact
         trtnameB                Self help
         trtnameC                Individual counselling
         trtnameD                Group counselling
         maxarms                 3
         measure                 Log odds ratio
         outcome                 count
         dim                     2
         format                  standard
         d                       d
         n                       n
         nmiss                   
         y                       _y
         S                       _S
         contrast                _contrast
         trtdiff                 _trtdiff
         component               
         MNAR                    
         testcons_type           chi2
         testcons_stat           5.111146981011002
         testcons_df             7
         testcons_p              .6464014447608941
         metavars                _trtdiff1_A _trtdiff1_B _trtdiff1_C _trtdiff2_
> A _trtdiff2_B _trtdiff2_C des_AB des_AC des_ACD des_AD des_BC des_BCD des_BD 
> des_CD _trtdiff1_C_des_AC _trtdiff2_C_des_AC _trtdiff1_A_des_AD _trtdiff2_A_d
> es_AD _trtdiff1_B_des_BC _trtdiff2_B_des_BC _trtdiff1_C_des_BCD _trtdiff2_C_d
> es_BCD _trtdiff1_B_des_BCD _trtdiff2_B_des_BCD _trtdiff1_B_des_BD _trtdiff2_B
> _des_BD _trtdiff1_C_des_CD _trtdiff2_C_des_CD
         consistency_fitted      _network_consistency
         inconsistency_fitted    _network_inconsistency
         plot_location           
         ncomponents             1
         df_inconsistency        7
         df_heterogeneity        16
Loop 1: format pairs, ref No contact
(Smoking data from Lu & Ades (2006))
Treatments used
   A (reference):                      No contact
   B:                                  Self help
   C:                                  Individual counselling
   D:                                  Group counselling

Measure                                Log odds ratio

Studies
   ID variable:                        study
   Number used:                        24
   IDs with zero cells:                9 20
   - count added to all their cells:   .5

Network information                    
   Components:                         1 (connected)
   D.f. for inconsistency:             7
   D.f. for heterogeneity:             16

Current data
   Data format:                        pairs
   Design variable:                    _design
   Estimate variable:                  _y
   Standard error variable:            _stderr
   Contrast variable:                  _contrast
   Command to list the data:           list study _design _contrast _y* _stderr
> *, noo sepby(_design)

----------------------------------------------------------------
          |               Treatment and Statistic               
          | - No con -    - Self h -    - Indivi -    - Group  -
    study |    d     n       d     n       d     n       d     n
----------+-----------------------------------------------------
        1 |    9   140                    23   140      10   138
        2 |                 11    78      12    85      29   170
        3 |   79   702      77   694                            
        4 |   18   671      21   535                            
        5 |    8   116      19   146                            
        6 |   75   731                   363   714              
        7 |    2   106                     9   205              
        8 |   58   549                   237  1561              
        9 |   .5    34                   9.5    49              
       10 |    3   100                    31    98              
       11 |    1    31                    26    95              
       12 |    6    39                    17    77              
       13 |   95  1107                   134  1031              
       14 |   15   187                    35   504              
       15 |   78   584                    73   675              
       16 |   69  1177                    54   888              
       17 |   64   642                   107   761              
       18 |    5    62                     8    90              
       19 |   20   234                    34   237              
       20 |   .5    21                                 9.5    21
       21 |                 20    49      16    43              
       22 |                  7    66                    32   127
       23 |                               12    76      20    74
       24 |                                9    55       3    26
----------------------------------------------------------------
Warning: i2 option is not available in pairs format
The data contain multi-arm trials - this analysis in pairs format is wrong
Command is: metareg _y _trtdiff_B _trtdiff_C _trtdiff_D , wsse(_stderr) noconst
> ant

Meta-regression                                       Number of obs  =      28
REML estimate of between-study variance               tau2           =   .4242
% residual variation due to heterogeneity             I-squared_res  =  87.93%
Joint test for all covariates                         Model F(3,25)  =    4.53
With Knapp-Hartung modification                       Prob > F       =  0.0114
------------------------------------------------------------------------------
          _y |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
  _trtdiff_B |    .392741   .3214905     1.22   0.233    -.2693811    1.054863
  _trtdiff_C |   .6945398   .1946246     3.57   0.001     .2937029    1.095377
  _trtdiff_D |   .7620687   .3456505     2.20   0.037     .0501882    1.473949
------------------------------------------------------------------------------
mvmeta command stored as F9
The data contain multi-arm trials - this analysis in pairs format is wrong
Command is: metareg _y _trtdiff_B _trtdiff_C _trtdiff_D _trtdiff_C_des_ACD _trt
> diff_D_des_AD _trtdiff_C_des_BC _trtdiff_C_des_BCD _trtdiff_D_des_BCD _trtdif
> f_D_des_BD _trtdiff_D_des_CD , wsse(_stderr) noconstant

Meta-regression                                       Number of obs  =      28
REML estimate of between-study variance               tau2           =   .4714
% residual variation due to heterogeneity             I-squared_res  =  90.48%
Joint test for all covariates                         Model F(10,18) =    1.94
With Knapp-Hartung modification                       Prob > F       =  0.1068
------------------------------------------------------------------------------
          _y |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
  _trtdiff_B |   .3258176   .4483121     0.73   0.477    -.6160511    1.267686
  _trtdiff_C |    .691554   .2225266     3.11   0.006     .2240429    1.159065
  _trtdiff_D |   .1285276   .6884116     0.19   0.854    -1.317772    1.574827
_trtdiff~ACD |    .359739   .7103875     0.51   0.619     -1.13273    1.852208
_trtdiff_~AD |   3.393989   1.823511     1.86   0.079    -.4370652    7.225044
_trtdiff_C~C |   -.517421   .9692517    -0.53   0.600    -2.553743    1.518901
_t~C_des_BCD |  -.3644918   .8415135    -0.43   0.670    -2.132446    1.403462
_t~D_des_BCD |   .4226233   1.055391     0.40   0.694    -1.794672    2.639918
_trtdiff_~BD |   1.240776   1.175714     1.06   0.305    -1.229307     3.71086
_trtdiff~_CD |   .8153816   .9644367     0.85   0.409    -1.210825    2.841588
------------------------------------------------------------------------------

Testing for inconsistency:
 ( 1)  _trtdiff_C_des_ACD = 0
 ( 2)  _trtdiff_D_des_AD = 0
 ( 3)  _trtdiff_C_des_BC = 0
 ( 4)  _trtdiff_C_des_BCD = 0
 ( 5)  _trtdiff_D_des_BCD = 0
 ( 6)  _trtdiff_D_des_BD = 0
 ( 7)  _trtdiff_D_des_CD = 0

       F(  7,    18) =    0.88
            Prob > F =    0.5441
mvmeta command stored as F9; test command stored as F8
         studyvar                study
         design                  _design
         ref                     A
         trtlistnoref            B C D
         trtnameA                No contact
         trtnameB                Self help
         trtnameC                Individual counselling
         trtnameD                Group counselling
         maxarms                 3
         measure                 Log odds ratio
         outcome                 count
         dim                     1
         format                  pairs
         d                       d
         n                       n
         nmiss                   
         y                       _y
         stderr                  _stderr
         contrast                _contrast
         t1                      _t1
         t2                      _t2
         trtdiff                 _trtdiff
         component               
         MNAR                    
         testcons_type           F
         testcons_stat           .8755670810732992
         testcons_df             7,18
         testcons_p              .5441279256880023
         metavars                _trtdiff_B _trtdiff_C _trtdiff_D des_AB des_AC
>  des_ACD des_AD des_BC des_BCD des_BD des_CD _trtdiff_C_des_ACD _trtdiff_D_de
> s_AD _trtdiff_C_des_BC _trtdiff_C_des_BCD _trtdiff_D_des_BCD _trtdiff_D_des_B
> D _trtdiff_D_des_CD
         consistency_fitted      _network_consistency
         inconsistency_fitted    _network_inconsistency
         plot_location           
         ncomponents             1
         df_inconsistency        7
         df_heterogeneity        16
Loop 1: format pairs, ref Self help
(Smoking data from Lu & Ades (2006))
Treatments used
   A:                                  No contact
   B (reference):                      Self help
   C:                                  Individual counselling
   D:                                  Group counselling

Measure                                Log odds ratio

Studies
   ID variable:                        study
   Number used:                        24
   IDs with zero cells:                9 20
   - count added to all their cells:   .5

Network information                    
   Components:                         1 (connected)
   D.f. for inconsistency:             7
   D.f. for heterogeneity:             16

Current data
   Data format:                        pairs
   Design variable:                    _design
   Estimate variable:                  _y
   Standard error variable:            _stderr
   Contrast variable:                  _contrast
   Command to list the data:           list study _design _contrast _y* _stderr
> *, noo sepby(_design)

----------------------------------------------------------------
          |               Treatment and Statistic               
          | - Self h -    - No con -    - Indivi -    - Group  -
    study |    d     n       d     n       d     n       d     n
----------+-----------------------------------------------------
        1 |                  9   140      23   140      10   138
        2 |   11    78                    12    85      29   170
        3 |   77   694      79   702                            
        4 |   21   535      18   671                            
        5 |   19   146       8   116                            
        6 |                 75   731     363   714              
        7 |                  2   106       9   205              
        8 |                 58   549     237  1561              
        9 |                 .5    34     9.5    49              
       10 |                  3   100      31    98              
       11 |                  1    31      26    95              
       12 |                  6    39      17    77              
       13 |                 95  1107     134  1031              
       14 |                 15   187      35   504              
       15 |                 78   584      73   675              
       16 |                 69  1177      54   888              
       17 |                 64   642     107   761              
       18 |                  5    62       8    90              
       19 |                 20   234      34   237              
       20 |                 .5    21                   9.5    21
       21 |   20    49                    16    43              
       22 |    7    66                                  32   127
       23 |                               12    76      20    74
       24 |                                9    55       3    26
----------------------------------------------------------------
Warning: i2 option is not available in pairs format
The data contain multi-arm trials - this analysis in pairs format is wrong
Command is: metareg _y _trtdiff_A _trtdiff_C _trtdiff_D , wsse(_stderr) noconst
> ant

Meta-regression                                       Number of obs  =      28
REML estimate of between-study variance               tau2           =   .4242
% residual variation due to heterogeneity             I-squared_res  =  87.93%
Joint test for all covariates                         Model F(3,25)  =    4.53
With Knapp-Hartung modification                       Prob > F       =  0.0114
------------------------------------------------------------------------------
          _y |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
  _trtdiff_A |   -.392741   .3214905    -1.22   0.233    -1.054863    .2693811
  _trtdiff_C |   .3017989    .327707     0.92   0.366    -.3731263     .976724
  _trtdiff_D |   .3693277   .3799084     0.97   0.340    -.4131084    1.151764
------------------------------------------------------------------------------
mvmeta command stored as F9
The data contain multi-arm trials - this analysis in pairs format is wrong
Command is: metareg _y _trtdiff_A _trtdiff_C _trtdiff_D _trtdiff_C_des_ACD _trt
> diff_D_des_AD _trtdiff_C_des_BC _trtdiff_C_des_BCD _trtdiff_D_des_BCD _trtdif
> f_D_des_BD _trtdiff_D_des_CD , wsse(_stderr) noconstant

Meta-regression                                       Number of obs  =      28
REML estimate of between-study variance               tau2           =   .4714
% residual variation due to heterogeneity             I-squared_res  =  90.48%
Joint test for all covariates                         Model F(10,18) =    1.94
With Knapp-Hartung modification                       Prob > F       =  0.1068
------------------------------------------------------------------------------
          _y |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
  _trtdiff_A |  -.3258176   .4483121    -0.73   0.477    -1.267686    .6160511
  _trtdiff_C |   .3657364   .5005015     0.73   0.474    -.6857783    1.417251
  _trtdiff_D |    -.19729   .8215195    -0.24   0.813    -1.923238    1.528658
_trtdiff~ACD |    .359739   .7103875     0.51   0.619     -1.13273    1.852208
_trtdiff_~AD |   3.393989   1.823511     1.86   0.079    -.4370652    7.225044
_trtdiff_C~C |   -.517421   .9692517    -0.53   0.600    -2.553743    1.518901
_t~C_des_BCD |  -.3644918   .8415135    -0.43   0.670    -2.132446    1.403462
_t~D_des_BCD |   .4226233   1.055391     0.40   0.694    -1.794672    2.639918
_trtdiff_~BD |   1.240776   1.175714     1.06   0.305    -1.229307     3.71086
_trtdiff~_CD |   .8153816   .9644367     0.85   0.409    -1.210825    2.841588
------------------------------------------------------------------------------

Testing for inconsistency:
 ( 1)  _trtdiff_C_des_ACD = 0
 ( 2)  _trtdiff_D_des_AD = 0
 ( 3)  _trtdiff_C_des_BC = 0
 ( 4)  _trtdiff_C_des_BCD = 0
 ( 5)  _trtdiff_D_des_BCD = 0
 ( 6)  _trtdiff_D_des_BD = 0
 ( 7)  _trtdiff_D_des_CD = 0

       F(  7,    18) =    0.88
            Prob > F =    0.5441
mvmeta command stored as F9; test command stored as F8
         studyvar                study
         design                  _design
         ref                     B
         trtlistnoref            A C D
         trtnameA                No contact
         trtnameB                Self help
         trtnameC                Individual counselling
         trtnameD                Group counselling
         maxarms                 3
         measure                 Log odds ratio
         outcome                 count
         dim                     1
         format                  pairs
         d                       d
         n                       n
         nmiss                   
         y                       _y
         stderr                  _stderr
         contrast                _contrast
         t1                      _t1
         t2                      _t2
         trtdiff                 _trtdiff
         component               
         MNAR                    
         testcons_type           F
         testcons_stat           .8755670827015756
         testcons_df             7,18
         testcons_p              .5441279245656216
         metavars                _trtdiff_A _trtdiff_C _trtdiff_D des_AB des_AC
>  des_ACD des_AD des_BC des_BCD des_BD des_CD _trtdiff_C_des_ACD _trtdiff_D_de
> s_AD _trtdiff_C_des_BC _trtdiff_C_des_BCD _trtdiff_D_des_BCD _trtdiff_D_des_B
> D _trtdiff_D_des_CD
         consistency_fitted      _network_consistency
         inconsistency_fitted    _network_inconsistency
         plot_location           
         ncomponents             1
         df_inconsistency        7
         df_heterogeneity        16
Loop 1: format pairs, ref Individual counselling
(Smoking data from Lu & Ades (2006))
Treatments used
   A:                                  No contact
   B:                                  Self help
   C (reference):                      Individual counselling
   D:                                  Group counselling

Measure                                Log odds ratio

Studies
   ID variable:                        study
   Number used:                        24
   IDs with zero cells:                9 20
   - count added to all their cells:   .5

Network information                    
   Components:                         1 (connected)
   D.f. for inconsistency:             7
   D.f. for heterogeneity:             16

Current data
   Data format:                        pairs
   Design variable:                    _design
   Estimate variable:                  _y
   Standard error variable:            _stderr
   Contrast variable:                  _contrast
   Command to list the data:           list study _design _contrast _y* _stderr
> *, noo sepby(_design)

----------------------------------------------------------------
          |               Treatment and Statistic               
          | - Indivi -    - No con -    - Self h -    - Group  -
    study |    d     n       d     n       d     n       d     n
----------+-----------------------------------------------------
        1 |   23   140       9   140                    10   138
        2 |   12    85                    11    78      29   170
        3 |                 79   702      77   694              
        4 |                 18   671      21   535              
        5 |                  8   116      19   146              
        6 |  363   714      75   731                            
        7 |    9   205       2   106                            
        8 |  237  1561      58   549                            
        9 |  9.5    49      .5    34                            
       10 |   31    98       3   100                            
       11 |   26    95       1    31                            
       12 |   17    77       6    39                            
       13 |  134  1031      95  1107                            
       14 |   35   504      15   187                            
       15 |   73   675      78   584                            
       16 |   54   888      69  1177                            
       17 |  107   761      64   642                            
       18 |    8    90       5    62                            
       19 |   34   237      20   234                            
       20 |                 .5    21                   9.5    21
       21 |   16    43                    20    49              
       22 |                                7    66      32   127
       23 |   12    76                                  20    74
       24 |    9    55                                   3    26
----------------------------------------------------------------
Warning: i2 option is not available in pairs format
The data contain multi-arm trials - this analysis in pairs format is wrong
Command is: metareg _y _trtdiff_A _trtdiff_B _trtdiff_D , wsse(_stderr) noconst
> ant

Meta-regression                                       Number of obs  =      28
REML estimate of between-study variance               tau2           =   .4242
% residual variation due to heterogeneity             I-squared_res  =  87.93%
Joint test for all covariates                         Model F(3,25)  =    4.53
With Knapp-Hartung modification                       Prob > F       =  0.0114
------------------------------------------------------------------------------
          _y |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
  _trtdiff_A |  -.6945398   .1946246    -3.57   0.001    -1.095377   -.2937029
  _trtdiff_B |  -.3017989    .327707    -0.92   0.366     -.976724    .3731263
  _trtdiff_D |   .0675288   .3261452     0.21   0.838    -.6041797    .7392374
------------------------------------------------------------------------------
mvmeta command stored as F9
The data contain multi-arm trials - this analysis in pairs format is wrong
Command is: metareg _y _trtdiff_A _trtdiff_B _trtdiff_D _trtdiff_A_des_ACD _trt
> diff_D_des_AD _trtdiff_B_des_BC _trtdiff_B_des_BCD _trtdiff_D_des_BCD _trtdif
> f_D_des_BD _trtdiff_D_des_CD , wsse(_stderr) noconstant

Meta-regression                                       Number of obs  =      28
REML estimate of between-study variance               tau2           =   .4714
% residual variation due to heterogeneity             I-squared_res  =  90.48%
Joint test for all covariates                         Model F(10,18) =    1.94
With Knapp-Hartung modification                       Prob > F       =  0.1068
------------------------------------------------------------------------------
          _y |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
  _trtdiff_A |   -.691554   .2225266    -3.11   0.006    -1.159065   -.2240429
  _trtdiff_B |  -.3657364   .5005015    -0.73   0.474    -1.417251    .6857783
  _trtdiff_D |  -.9227655   .6716127    -1.37   0.186    -2.333771    .4882404
_trtdiff_A~D |   -.359739   .7103875    -0.51   0.619    -1.852208     1.13273
_trtdiff_~AD |   3.753728    1.83081     2.05   0.055    -.0926598    7.600116
_trtdiff_B~C |    .517421   .9692517     0.53   0.600    -1.518901    2.553743
_trtdiff_B~D |   .3644918   .8415135     0.43   0.670    -1.403462    2.132446
_t~D_des_BCD |   1.146854   .9416698     1.22   0.239    -.8315206    3.125229
_trtdiff_~BD |   1.600515   1.187002     1.35   0.194    -.8932843    4.094315
_trtdiff~_CD |   1.175121   .9261604     1.27   0.221    -.7706702    3.120911
------------------------------------------------------------------------------

Testing for inconsistency:
 ( 1)  _trtdiff_A_des_ACD = 0
 ( 2)  _trtdiff_D_des_AD = 0
 ( 3)  _trtdiff_B_des_BC = 0
 ( 4)  _trtdiff_B_des_BCD = 0
 ( 5)  _trtdiff_D_des_BCD = 0
 ( 6)  _trtdiff_D_des_BD = 0
 ( 7)  _trtdiff_D_des_CD = 0

       F(  7,    18) =    0.88
            Prob > F =    0.5441
mvmeta command stored as F9; test command stored as F8
         studyvar                study
         design                  _design
         ref                     C
         trtlistnoref            A B D
         trtnameA                No contact
         trtnameB                Self help
         trtnameC                Individual counselling
         trtnameD                Group counselling
         maxarms                 3
         measure                 Log odds ratio
         outcome                 count
         dim                     1
         format                  pairs
         d                       d
         n                       n
         nmiss                   
         y                       _y
         stderr                  _stderr
         contrast                _contrast
         t1                      _t1
         t2                      _t2
         trtdiff                 _trtdiff
         component               
         MNAR                    
         testcons_type           F
         testcons_stat           .8755670827015756
         testcons_df             7,18
         testcons_p              .5441279245656216
         metavars                _trtdiff_A _trtdiff_B _trtdiff_D des_AB des_AC
>  des_ACD des_AD des_BC des_BCD des_BD des_CD _trtdiff_A_des_ACD _trtdiff_D_de
> s_AD _trtdiff_B_des_BC _trtdiff_B_des_BCD _trtdiff_D_des_BCD _trtdiff_D_des_B
> D _trtdiff_D_des_CD
         consistency_fitted      _network_consistency
         inconsistency_fitted    _network_inconsistency
         plot_location           
         ncomponents             1
         df_inconsistency        7
         df_heterogeneity        16
Loop 1: format pairs, ref Group counselling
(Smoking data from Lu & Ades (2006))
Treatments used
   A:                                  No contact
   B:                                  Self help
   C:                                  Individual counselling
   D (reference):                      Group counselling

Measure                                Log odds ratio

Studies
   ID variable:                        study
   Number used:                        24
   IDs with zero cells:                9 20
   - count added to all their cells:   .5

Network information                    
   Components:                         1 (connected)
   D.f. for inconsistency:             7
   D.f. for heterogeneity:             16

Current data
   Data format:                        pairs
   Design variable:                    _design
   Estimate variable:                  _y
   Standard error variable:            _stderr
   Contrast variable:                  _contrast
   Command to list the data:           list study _design _contrast _y* _stderr
> *, noo sepby(_design)

----------------------------------------------------------------
          |               Treatment and Statistic               
          | - Group  -    - No con -    - Self h -    - Indivi -
    study |    d     n       d     n       d     n       d     n
----------+-----------------------------------------------------
        1 |   10   138       9   140                    23   140
        2 |   29   170                    11    78      12    85
        3 |                 79   702      77   694              
        4 |                 18   671      21   535              
        5 |                  8   116      19   146              
        6 |                 75   731                   363   714
        7 |                  2   106                     9   205
        8 |                 58   549                   237  1561
        9 |                 .5    34                   9.5    49
       10 |                  3   100                    31    98
       11 |                  1    31                    26    95
       12 |                  6    39                    17    77
       13 |                 95  1107                   134  1031
       14 |                 15   187                    35   504
       15 |                 78   584                    73   675
       16 |                 69  1177                    54   888
       17 |                 64   642                   107   761
       18 |                  5    62                     8    90
       19 |                 20   234                    34   237
       20 |  9.5    21      .5    21                            
       21 |                               20    49      16    43
       22 |   32   127                     7    66              
       23 |   20    74                                  12    76
       24 |    3    26                                   9    55
----------------------------------------------------------------
Warning: i2 option is not available in pairs format
The data contain multi-arm trials - this analysis in pairs format is wrong
Command is: metareg _y _trtdiff_A _trtdiff_B _trtdiff_C , wsse(_stderr) noconst
> ant

Meta-regression                                       Number of obs  =      28
REML estimate of between-study variance               tau2           =   .4242
% residual variation due to heterogeneity             I-squared_res  =  87.93%
Joint test for all covariates                         Model F(3,25)  =    4.53
With Knapp-Hartung modification                       Prob > F       =  0.0114
------------------------------------------------------------------------------
          _y |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
  _trtdiff_A |  -.7620687   .3456505    -2.20   0.037    -1.473949   -.0501882
  _trtdiff_B |  -.3693277   .3799084    -0.97   0.340    -1.151764    .4131084
  _trtdiff_C |  -.0675288   .3261452    -0.21   0.838    -.7392374    .6041797
------------------------------------------------------------------------------
mvmeta command stored as F9
The data contain multi-arm trials - this analysis in pairs format is wrong
Command is: metareg _y _trtdiff_A _trtdiff_B _trtdiff_C _trtdiff_C_des_AC _trtd
> iff_A_des_AD _trtdiff_B_des_BC _trtdiff_C_des_BCD _trtdiff_B_des_BCD _trtdiff
> _B_des_BD _trtdiff_C_des_CD , wsse(_stderr) noconstant

Meta-regression                                       Number of obs  =      28
REML estimate of between-study variance               tau2           =   .4714
% residual variation due to heterogeneity             I-squared_res  =  90.48%
Joint test for all covariates                         Model F(10,18) =    1.94
With Knapp-Hartung modification                       Prob > F       =  0.1068
------------------------------------------------------------------------------
          _y |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
  _trtdiff_A |  -.1285276   .6884116    -0.19   0.854    -1.574827    1.317772
  _trtdiff_B |     .19729   .8215195     0.24   0.813    -1.528658    1.923238
  _trtdiff_C |   .9227655   .6716127     1.37   0.186    -.4882404    2.333771
_trtdiff_C~C |   -.359739   .7103875    -0.51   0.619    -1.852208     1.13273
_trtdiff_A~D |  -3.393989   1.823511    -1.86   0.079    -7.225044    .4370652
_trtdiff_B~C |     .87716   1.159769     0.76   0.459    -1.559423    3.313743
_t~C_des_BCD |  -1.146854   .9416698    -1.22   0.239    -3.125229    .8315206
_t~B_des_BCD |  -.4226233   1.055391    -0.40   0.694    -2.639918    1.794672
_trtdiff_~BD |  -1.240776   1.175714    -1.06   0.305     -3.71086    1.229307
_trtdiff~_CD |  -1.175121   .9261604    -1.27   0.221    -3.120911    .7706702
------------------------------------------------------------------------------

Testing for inconsistency:
 ( 1)  _trtdiff_C_des_AC = 0
 ( 2)  _trtdiff_A_des_AD = 0
 ( 3)  _trtdiff_B_des_BC = 0
 ( 4)  _trtdiff_C_des_BCD = 0
 ( 5)  _trtdiff_B_des_BCD = 0
 ( 6)  _trtdiff_B_des_BD = 0
 ( 7)  _trtdiff_C_des_CD = 0

       F(  7,    18) =    0.88
            Prob > F =    0.5441
mvmeta command stored as F9; test command stored as F8
         studyvar                study
         design                  _design
         ref                     D
         trtlistnoref            A B C
         trtnameA                No contact
         trtnameB                Self help
         trtnameC                Individual counselling
         trtnameD                Group counselling
         maxarms                 3
         measure                 Log odds ratio
         outcome                 count
         dim                     1
         format                  pairs
         d                       d
         n                       n
         nmiss                   
         y                       _y
         stderr                  _stderr
         contrast                _contrast
         t1                      _t1
         t2                      _t2
         trtdiff                 _trtdiff
         component               
         MNAR                    
         testcons_type           F
         testcons_stat           .8755670827015747
         testcons_df             7,18
         testcons_p              .5441279245656223
         metavars                _trtdiff_A _trtdiff_B _trtdiff_C des_AB des_AC
>  des_ACD des_AD des_BC des_BCD des_BD des_CD _trtdiff_C_des_AC _trtdiff_A_des
> _AD _trtdiff_B_des_BC _trtdiff_C_des_BCD _trtdiff_B_des_BCD _trtdiff_B_des_BD
>  _trtdiff_C_des_CD
         consistency_fitted      _network_consistency
         inconsistency_fitted    _network_inconsistency
         plot_location           
         ncomponents             1
         df_inconsistency        7
         df_heterogeneity        16

. 
. 
. // Check it also handles long study and treatment names
. foreach format in augmented standard pairs {
  2.         di as input "Loop 2: format `format'"
  3.         use smoking, clear
  4.         decode trt, gen(trtstring)
  5.         drop trt
  6.         rename trtstring trt
  7.         gen stud="Study " + string(study)
  8.         keep stud trt d n
  9.         network setup d n, studyvar(stud) trtvar(trt) format(`format') 
 10.         network table
 11.         network pattern
 12.         network map, circle(9) centre improve(2) name(map`format'`ref'circ
> le, replace) loc(M) replace listloc 
 13.         network map, square(3) improve(2) name(map`format'`ref'square, rep
> lace) trtcodes
 14.         network map, tri(4) improve(2) name(map`format'`ref'triangular, re
> place) title(The triangular one)
 15.         network map, random(9) improve(2) name(map`format'`ref'random, rep
> lace)
 16.         local force = cond("`format'"=="pairs","force","")
 17.         network meta c, i2 `force'
 18.         network compare
 19.         network meta i, `force'
 20.         network que
 21.         network forest, debug name(forest_`format', replace)
 22. }
Loop 2: format augmented
(Smoking data from Lu & Ades (2006))
Treatments used
   A (reference):                      Group counselling
   B:                                  Individual counselling
   C:                                  No contact
   D:                                  Self help

Measure                                Log odds ratio

Studies
   ID variable:                        stud
   Number used:                        24
   IDs with zero cells:                `"Study 20"' `"Study 9"'
   - count added to all their cells:   .5
   IDs with augmented reference arm:   `"Study 10"' `"Study 11"' `"Study 12"' `
> "Study 13"' `"Study 14"' `"Study 15"' `"Study 16"' `"Study 17"' `"Study 18"' 
> `"Study 19"' `"Study 21"' `"Study 3"' `"Study 4"' `"Study 5"' `"Study 6"' `"S
> tudy 7"' `"Study 8"' `"Study 9"'
   - observations added:               0.00001
   - mean in augmented observations:   study-specific mean

Network information                    
   Components:                         1 (connected)
   D.f. for inconsistency:             7
   D.f. for heterogeneity:             16

Current data
   Data format:                        augmented
   Design variable:                    _design
   Estimate variables:                 _y*
   Variance variables:                 _S*
   Command to list the data:           list stud _y* _S*, noo sepby(_design)

----------------------------------------------------------------
          |               Treatment and Statistic               
          | - Group  -    - Indivi -    - No con -    - Self h -
     stud |    d     n       d     n       d     n       d     n
----------+-----------------------------------------------------
  Study 1 |   10   138      23   140       9   140              
 Study 10 |                 31    98       3   100              
 Study 11 |                 26    95       1    31              
 Study 12 |                 17    77       6    39              
 Study 13 |                134  1031      95  1107              
 Study 14 |                 35   504      15   187              
 Study 15 |                 73   675      78   584              
 Study 16 |                 54   888      69  1177              
 Study 17 |                107   761      64   642              
 Study 18 |                  8    90       5    62              
 Study 19 |                 34   237      20   234              
  Study 2 |   29   170      12    85                    11    78
 Study 20 |  9.5    21                    .5    21              
 Study 21 |                 16    43                    20    49
 Study 22 |   32   127                                   7    66
 Study 23 |   20    74      12    76                            
 Study 24 |    3    26       9    55                            
  Study 3 |                               79   702      77   694
  Study 4 |                               18   671      21   535
  Study 5 |                                8   116      19   146
  Study 6 |                363   714      75   731              
  Study 7 |                  9   205       2   106              
  Study 8 |                237  1561      58   549              
  Study 9 |                9.5    49      .5    34              
----------------------------------------------------------------
Improving locations ...
loop 1 score 1================ 0
Stopping after achieving score of 0
Evaluating optimal locations ...
Graph command stored in F9

M[10,3]:  Treatment locations for network map
                       x           y    labelpos
Group coun~g           1           0           3
Individual~g  -.93969262  -.34202014           8
  No contact           0           0           3
   Self help   .76604444   .64278761           2
           .   .17364818   .98480775          12
           .         -.5    .8660254          11
           .  -.93969262   .34202014          10
           .         -.5   -.8660254           7
           .   .17364818  -.98480775           6
           .   .76604444  -.64278761           4
Improving locations ...
loop 1 score 31============= 1.========.==.=====.==.==================..=======
> ==================
loop 2 score 1=======.======...===== 0
Stopping after achieving score of 0
Evaluating optimal locations ...
Graph command stored in F9
Improving locations ...
loop 1 score 140==== 31============== 1==============.===.==.======.===.==. 0
Stopping after achieving score of 0
Evaluating optimal locations ...
Graph command stored in F9
Improving locations ...
loop 1 score 0=
Stopping after achieving score of 0
Evaluating optimal locations ...
Graph command stored in F9
Command is: mvmeta _y _S , i2 bscovariance(exch 0.5) longparm suppress(uv mm) v
> ars(_y_B _y_C _y_D)
Note: using method reml
Note: using variables _y_B _y_C _y_D
Note: 24 observations on 3 variables
Note: variance-covariance matrix is proportional to .5*I(3)+.5*J(3,3,1)

initial:       log likelihood = -175.48222
rescale:       log likelihood = -175.48222
rescale eq:    log likelihood = -175.26979
Iteration 0:   log likelihood = -175.26979  
Iteration 1:   log likelihood = -173.85457  
Iteration 2:   log likelihood = -173.82874  
Iteration 3:   log likelihood =  -173.8276  
Iteration 4:   log likelihood = -173.82754  
Iteration 5:   log likelihood = -173.82754  

Multivariate meta-analysis
Variance-covariance matrix = proportional .5*I(3)+.5*J(3,3,1)
Method = reml                                  Number of dimensions    =     3
Restricted log likelihood = -173.82754         Number of observations  =    24
------------------------------------------------------------------------------
             |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
_y_B         |
       _cons |  -.1635337   .3547405    -0.46   0.645    -.8588124     .531745
-------------+----------------------------------------------------------------
_y_C         |
       _cons |  -.8658892   .3762908    -2.30   0.021    -1.603406   -.1283727
-------------+----------------------------------------------------------------
_y_D         |
       _cons |  -.4674408   .4074048    -1.15   0.251     -1.26594     .331058
------------------------------------------------------------------------------

Estimated between-studies SDs and correlation matrix:
             SD       _y_B       _y_C       _y_D
_y_B  .67446645          1          .          .
_y_C  .67446645         .5          1          .
_y_D  .67446645         .5         .5          1
Method of moments failed when mvmeta ran, so I^2 cannot be computed
mvmeta command stored as F9
Table of log odds ratio and its standard error for Treatment vs. Comparator:
-------------------------------------------
           |           Treatment           
Comparator |      A       B       C       D
-----------+-------------------------------
         A |         -0.164  -0.866  -0.467
           |          0.355   0.376   0.407
           | 
         B |  0.164          -0.702  -0.304
           |  0.355           0.199   0.341
           | 
         C |  0.866   0.702           0.398
           |  0.376   0.199           0.331
           | 
         D |  0.467   0.304  -0.398        
           |  0.407   0.341   0.331        
-------------------------------------------
Command is: mvmeta _y _S , bscovariance(exch 0.5) longparm suppress(uv mm) eq(_
> y_B: des_ABC des_ABD, _y_C: des_AC des_BC, _y_D: des_AD des_BD des_CD) vars(_
> y_B _y_C _y_D)
Note: using method reml
Note: regressing _y_B on des_ABC des_ABD
Note: regressing _y_C on des_AC des_BC
Note: regressing _y_D on des_AD des_BD des_CD
Note: 24 observations on 3 variables
Note: variance-covariance matrix is proportional to .5*I(3)+.5*J(3,3,1)

initial:       log likelihood = -165.39193
rescale:       log likelihood = -165.39193
rescale eq:    log likelihood = -165.39193
Iteration 0:   log likelihood = -165.39193  
Iteration 1:   log likelihood = -164.66492  
Iteration 2:   log likelihood = -164.66406  
Iteration 3:   log likelihood = -164.66406  

Multivariate meta-analysis
Variance-covariance matrix = proportional .5*I(3)+.5*J(3,3,1)
Method = reml                                  Number of dimensions    =     3
Restricted log likelihood = -164.66406         Number of observations  =    24
------------------------------------------------------------------------------
             |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
_y_B         |
     des_ABC |   1.164695   1.068672     1.09   0.276    -.9298641    3.259254
     des_ABD |    .017841   1.058692     0.02   0.987    -2.057158     2.09284
       _cons |  -.2419297   .6556926    -0.37   0.712    -1.527064    1.043204
-------------+----------------------------------------------------------------
_y_C         |
      des_AC |  -3.393989    1.89001    -1.80   0.073     -7.09834    .3103616
      des_BC |  -.8178811   1.123171    -0.73   0.466    -3.019257    1.383494
       _cons |  -.1285277   .8825225    -0.15   0.884     -1.85824    1.601185
-------------+----------------------------------------------------------------
_y_D         |
      des_AD |   -.818153   1.205642    -0.68   0.497    -3.181167    1.544861
      des_BD |   .1350883   1.365994     0.10   0.921    -2.542212    2.812388
      des_CD |   .4268689   1.302758     0.33   0.743     -2.12649    2.980228
       _cons |  -.2253333   .8364804    -0.27   0.788    -1.864805    1.414138
------------------------------------------------------------------------------

Estimated between-studies SDs and correlation matrix:
             SD       _y_B       _y_C       _y_D
_y_B  .74316215          1          .          .
_y_C  .74316215         .5          1          .
_y_D  .74316215         .5         .5          1

Testing for inconsistency:
 ( 1)  [_y_B]des_ABC = 0
 ( 2)  [_y_B]des_ABD = 0
 ( 3)  [_y_C]des_AC = 0
 ( 4)  [_y_D]des_AD = 0
 ( 5)  [_y_C]des_BC = 0
 ( 6)  [_y_D]des_BD = 0
 ( 7)  [_y_D]des_CD = 0

           chi2(  7) =    5.11
         Prob > chi2 =    0.6464
mvmeta command stored as F9; test command stored as F8
         studyvar                stud
         design                  _design
         ref                     A
         trtlistnoref            B C D
         trtnameA                Group counselling
         trtnameB                Individual counselling
         trtnameC                No contact
         trtnameD                Self help
         maxarms                 3
         measure                 Log odds ratio
         outcome                 count
         dim                     3
         format                  augmented
         d                       d
         n                       n
         nmiss                   
         y                       _y
         S                       _S
         component               
         MNAR                    
         testcons_type           chi2
         testcons_stat           5.111150411709903
         testcons_df             7
         testcons_p              .6464010263279576
         metavars                des_AB des_ABC des_ABD des_AC des_AD des_BC de
> s_BD des_CD
         consistency_fitted      _network_consistency
         inconsistency_fitted    _network_inconsistency
         plot_location           
         ncomponents             1
         df_inconsistency        7
         df_heterogeneity        16
group(design) assumed
Listing of study-level results: studyvar design t1 t2 diff se

     +---------------------------------------------------------+
     |     stud   _design   _t1   _t2           _y     _stderr |
     |---------------------------------------------------------|
  1. |  Study 1     A B C     A     B    .92276545   .39979716 |
  2. |  Study 1     A B C     A     C   -.12852757   .47598025 |
  3. |  Study 1     A B C     B     C    -1.051293   .41324323 |
  4. | Study 10       B C     B     C   -2.7053933   .62516082 |
  5. | Study 11       B C     B     C   -2.4251874   1.0422512 |
     |---------------------------------------------------------|
  6. | Study 12       B C     B     C   -.44361687   .52197691 |
  7. | Study 13       B C     B     C    -.4645909   .14174615 |
  8. | Study 14       B C     B     C    .15581043   .32122305 |
  9. | Study 15       B C     B     C    .23997016   .17365643 |
 10. | Study 16       B C     B     C   -.03895601    .1873842 |
     |---------------------------------------------------------|
 11. | Study 17       B C     B     C   -.39041227   .16801771 |
 12. | Study 18       B C     B     C   -.10633565   .59559968 |
 13. | Study 19       B C     B     C   -.58339829   .29834673 |
 14. |  Study 2     A B D     A     B   -.22408873    .3722995 |
 15. |  Study 2     A B D     A     D   -.22533329   .38393935 |
     |---------------------------------------------------------|
 16. |  Study 2     A B D     B     D   -.00124456   .45040696 |
 17. | Study 20       A C     A     C   -3.5225168    1.496997 |
 18. | Study 21       B D     B     D    .15168459   .42897529 |
 19. | Study 22       A D     A     D   -1.0434863   .44897952 |
 20. | Study 23       A B     A     B   -.68072466   .40923936 |
     |---------------------------------------------------------|
 21. | Study 24       A B     A     B    .40546511   .71390604 |
 22. |  Study 3       C D     C     D   -.01596494   .16991505 |
 23. |  Study 4       C D     C     D    .39350454   .32657545 |
 24. |  Study 5       C D     C     D    .70294158   .44132171 |
 25. |  Study 6       B C     B     C   -2.2022893   .14304387 |
     |---------------------------------------------------------|
 26. |  Study 7       B C     B     C   -.87035364   .79109325 |
 27. |  Study 8       B C     B     C   -.41564852    .1557329 |
 28. |  Study 9       B C     B     C   -2.7796837   1.4698402 |
     +---------------------------------------------------------+
inconsistency results will be taken from matrix _network_inconsistency
Listing of inconsistency results:  design t1 t2 diff se

     +-----------------------------------------------------+
     | _desig~o   _t1inco   _t2inco       inco4      inco5 |
     |-----------------------------------------------------|
  1. |      A B         A         B   -.2419297   .6556926 |
  2. |    A B C         A         B    .9227654   .8438765 |
  3. |    A B C         A         C   -.1285277   .8825225 |
  4. |    A B C         B         C   -1.051293   .8503292 |
  5. |    A B D         A         B   -.2240887   .8312021 |
     |-----------------------------------------------------|
  6. |    A B D         A         D   -.2253333   .8364804 |
  7. |    A B D         B         D   -.0012445   .8689973 |
  8. |      A C         A         C   -3.522517   1.671314 |
  9. |      A D         A         D   -1.043486   .8682584 |
 10. |      B C         B         C   -.7044791    .234799 |
     |-----------------------------------------------------|
 11. |      B D         B         D    .1516847   .8580847 |
 12. |      C D         C         D    .3300633   .4675832 |
     +-----------------------------------------------------+
consistency results will be taken from matrix _network_consistency
Listing of consistency results:  design t1 t2 diff se

     +-----------------------------------------------------+
     | _desig~s   _t1cons   _t2cons       cons4      cons5 |
     |-----------------------------------------------------|
  1. |      A B         A         B   -.1635337   .3547406 |
  2. |    A B C         A         B   -.1635337   .3547406 |
  3. |    A B C         A         C   -.8658892   .3762908 |
  4. |    A B C         B         C   -.7023555   .1991078 |
  5. |    A B D         A         B   -.1635337   .3547406 |
     |-----------------------------------------------------|
  6. |    A B D         A         D   -.4674408   .4074048 |
  7. |    A B D         B         D    -.303907   .3405171 |
  8. |      A C         A         C   -.8658892   .3762908 |
  9. |      A D         A         D   -.4674408   .4074048 |
 10. |      B C         B         C   -.7023555   .1991078 |
     |-----------------------------------------------------|
 11. |      B D         B         D    -.303907   .3405171 |
 12. |      C D         C         D    .3984484   .3311038 |
     +-----------------------------------------------------+
graph twoway (scatter row diff if type=="study" [aw=1/se^2], mcol(blue) msymbol
> (S) msize(*0.2)) (pcspike row low row upp if type=="study" & lowistrunc==0 & 
> uppistrunc==0, lcol(blue) mcol(blue)) (scatter row diff if type=="inco" [aw=1
> /se^2], mcol(green) msymbol(S) msize(*0.2)) (pcspike row low row upp if type=
> ="inco" & lowistrunc==0 & uppistrunc==0, lcol(green) mcol(green)) (scatter ro
> w diff if type=="cons" [aw=1/se^2], mcol(red) msymbol(S) msize(*0.2)) (pcspik
> e row low row upp if type=="cons" & lowistrunc==0 & uppistrunc==0, lcol(red) 
> mcol(red)) (scatter row middle, mlabel(label2) mlabpos(0) ms(none) mlabcol(bl
> ack) ), ylabel(#44, valuelabel angle(0) labsize(vsmall) nogrid ) yscale(rever
> se) plotregion(margin(t=0)) ytitle("") subtitle("")  by(column, row(1) yresca
> le noiytick  note("Test of consistency: chi2(7)=5.11, P=0.646", size(vsmall))
>  legend()) legend(order(1 3 5) label(1 "Studies") label(3 "Pooled within desi
> gn") label(5 "Pooled overall") rows(1)) xlabel(,labsize(small)) xtitle(,size(
> small)) xtitle(Log odds ratio) name(forest_augmented, replace)
Loop 2: format standard
(Smoking data from Lu & Ades (2006))
Treatments used
   A (reference):                      Group counselling
   B:                                  Individual counselling
   C:                                  No contact
   D:                                  Self help

Measure                                Log odds ratio

Studies
   ID variable:                        stud
   Number used:                        24
   IDs with zero cells:                `"Study 20"' `"Study 9"'
   - count added to all their cells:   .5

Network information                    
   Components:                         1 (connected)
   D.f. for inconsistency:             7
   D.f. for heterogeneity:             16

Current data
   Data format:                        standard
   Design variable:                    _design
   Estimate variables:                 _y*
   Variance variables:                 _S*
   Contrast variables:                 _contrast*
   Command to list the data:           list stud _design _contrast* _y* _S*, no
> o sepby(_design)

----------------------------------------------------------------
          |               Treatment and Statistic               
          | - Group  -    - Indivi -    - No con -    - Self h -
     stud |    d     n       d     n       d     n       d     n
----------+-----------------------------------------------------
  Study 1 |   10   138      23   140       9   140              
 Study 10 |                 31    98       3   100              
 Study 11 |                 26    95       1    31              
 Study 12 |                 17    77       6    39              
 Study 13 |                134  1031      95  1107              
 Study 14 |                 35   504      15   187              
 Study 15 |                 73   675      78   584              
 Study 16 |                 54   888      69  1177              
 Study 17 |                107   761      64   642              
 Study 18 |                  8    90       5    62              
 Study 19 |                 34   237      20   234              
  Study 2 |   29   170      12    85                    11    78
 Study 20 |  9.5    21                    .5    21              
 Study 21 |                 16    43                    20    49
 Study 22 |   32   127                                   7    66
 Study 23 |   20    74      12    76                            
 Study 24 |    3    26       9    55                            
  Study 3 |                               79   702      77   694
  Study 4 |                               18   671      21   535
  Study 5 |                                8   116      19   146
  Study 6 |                363   714      75   731              
  Study 7 |                  9   205       2   106              
  Study 8 |                237  1561      58   549              
  Study 9 |                9.5    49      .5    34              
----------------------------------------------------------------
Improving locations ...
loop 1 score 1================ 0
Stopping after achieving score of 0
Evaluating optimal locations ...
Graph command stored in F9

M[10,3]:  Treatment locations for network map
                       x           y    labelpos
Group coun~g           1           0           3
Individual~g  -.93969262  -.34202014           8
  No contact           0           0           3
   Self help   .76604444   .64278761           2
           .   .17364818   .98480775          12
           .         -.5    .8660254          11
           .  -.93969262   .34202014          10
           .         -.5   -.8660254           7
           .   .17364818  -.98480775           6
           .   .76604444  -.64278761           4
Improving locations ...
loop 1 score 31============= 1.========.==.=====.==.==================..=======
> ==================
loop 2 score 1=======.======...===== 0
Stopping after achieving score of 0
Evaluating optimal locations ...
Graph command stored in F9
Improving locations ...
loop 1 score 140==== 31============== 1==============.===.==.======.===.==. 0
Stopping after achieving score of 0
Evaluating optimal locations ...
Graph command stored in F9
Improving locations ...
loop 1 score 0=
Stopping after achieving score of 0
Evaluating optimal locations ...
Graph command stored in F9
Warning: i2 option is not meaningful in standard format
Command is: mvmeta _y _S , i2 bscovariance(exch 0.5) commonparm noconstant supp
> ress(uv mm) eq(_y_1: _trtdiff1_B _trtdiff1_C _trtdiff1_D, _y_2: _trtdiff2_B _
> trtdiff2_C _trtdiff2_D) vars(_y_1 _y_2)
Note: using method reml
Note: regressing _y_1 on _trtdiff1_B _trtdiff1_C _trtdiff1_D
Note: regressing _y_2 on _trtdiff2_B _trtdiff2_C _trtdiff2_D
Note: 24 observations on 2 variables
Note: variance-covariance matrix is proportional to .5*I(2)+.5*J(2,2,1)

initial:       log likelihood = -34.471727
rescale:       log likelihood = -34.471727
rescale eq:    log likelihood = -34.259312
Iteration 0:   log likelihood = -34.259312  
Iteration 1:   log likelihood = -32.844423  
Iteration 2:   log likelihood = -32.817174  
Iteration 3:   log likelihood = -32.817057  
Iteration 4:   log likelihood = -32.817057  

Multivariate meta-analysis
Variance-covariance matrix = proportional .5*I(2)+.5*J(2,2,1)
Method = reml                                  Number of dimensions    =     2
Restricted log likelihood = -32.817057         Number of observations  =    24
------------------------------------------------------------------------------
             |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
_y_1         |
 _trtdiff1_B |  -.1635346    .354741    -0.46   0.645    -.8588143     .531745
 _trtdiff1_C |  -.8658902   .3762928    -2.30   0.021    -1.603411   -.1283698
 _trtdiff1_D |  -.4674415   .4074053    -1.15   0.251    -1.265941    .3310581
------------------------------------------------------------------------------
The above coefficients also apply to the following equations:
    _y_2: _trtdiff2_B _trtdiff2_C _trtdiff2_D 

Estimated between-studies SDs and correlation matrix:
             SD       _y_1       _y_2
_y_1  .67446638          1          .
_y_2  .67446638         .5          1
Method of moments failed when mvmeta ran, so I^2 cannot be computed
mvmeta command stored as F9
Table of log odds ratio and its standard error for Treatment vs. Comparator:
-------------------------------------------
           |           Treatment           
Comparator |      A       B       C       D
-----------+-------------------------------
         A |         -0.164  -0.866  -0.467
           |          0.355   0.376   0.407
           | 
         B |  0.164          -0.702  -0.304
           |  0.355           0.199   0.341
           | 
         C |  0.866   0.702           0.398
           |  0.376   0.199           0.331
           | 
         D |  0.467   0.304  -0.398        
           |  0.407   0.341   0.331        
-------------------------------------------
Command is: mvmeta _y _S , bscovariance(exch 0.5) commonparm noconstant suppres
> s(uv mm) eq(_y_1: _trtdiff1_B _trtdiff1_C _trtdiff1_D _trtdiff1_B_des_ABC _tr
> tdiff1_B_des_ABD _trtdiff1_C_des_AC _trtdiff1_D_des_AD _trtdiff1_C_des_BC _tr
> tdiff1_D_des_BD _trtdiff1_D_des_CD, _y_2: _trtdiff2_B _trtdiff2_C _trtdiff2_D
>  _trtdiff2_B_des_ABC _trtdiff2_B_des_ABD _trtdiff2_C_des_AC _trtdiff2_D_des_A
> D _trtdiff2_C_des_BC _trtdiff2_D_des_BD _trtdiff2_D_des_CD) vars(_y_1 _y_2)
Note: using method reml
Note: regressing _y_1 on _trtdiff1_B _trtdiff1_C _trtdiff1_D _trtdiff1_B_des_AB
> C _trtdiff1_B_des_ABD _trtdiff1_C_des_AC _trtdiff1_D_des_AD _trtdiff1_C_des_B
> C _trtdiff1_D_des_BD _trtdiff1_D_des_CD
Note: regressing _y_2 on _trtdiff2_B _trtdiff2_C _trtdiff2_D _trtdiff2_B_des_AB
> C _trtdiff2_B_des_ABD _trtdiff2_C_des_AC _trtdiff2_D_des_AD _trtdiff2_C_des_B
> C _trtdiff2_D_des_BD _trtdiff2_D_des_CD
Note: 24 observations on 2 variables
Note: variance-covariance matrix is proportional to .5*I(2)+.5*J(2,2,1)

initial:       log likelihood = -24.381433
rescale:       log likelihood = -24.381433
rescale eq:    log likelihood = -24.381433
Iteration 0:   log likelihood = -24.381433  
Iteration 1:   log likelihood = -23.654262  
Iteration 2:   log likelihood = -23.653575  
Iteration 3:   log likelihood = -23.653575  

Multivariate meta-analysis
Variance-covariance matrix = proportional .5*I(2)+.5*J(2,2,1)
Method = reml                                  Number of dimensions    =     2
Restricted log likelihood = -23.653575         Number of observations  =    24
------------------------------------------------------------------------------
             |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
_y_1         |
 _trtdiff1_B |  -.2419329   .6556959    -0.37   0.712    -1.527073    1.043208
 _trtdiff1_C |  -.1285276   .8825236    -0.15   0.884    -1.858242    1.601187
 _trtdiff1_D |  -.2253333   .8364808    -0.27   0.788    -1.864805    1.414139
~1_B_des_ABC |   1.164698   1.068675     1.09   0.276    -.9298656    3.259262
~1_B_des_ABD |   .0178441   1.058695     0.02   0.987     -2.05716    2.092848
_trtdiff1~AC |  -3.393989    1.89001    -1.80   0.073    -7.098341    .3103628
_trtdiff1~AD |   -.818153   1.205642    -0.68   0.497    -3.181169    1.544862
_~1_C_des_BC |  -.8178847   1.123174    -0.73   0.466    -3.019265    1.383496
_~1_D_des_BD |    .135085   1.365997     0.10   0.921     -2.54222     2.81239
_trtdiff1~CD |   .4268691    1.30276     0.33   0.743    -2.126493    2.980231
------------------------------------------------------------------------------
The above coefficients also apply to the following equations:
    _y_2: _trtdiff2_B _trtdiff2_C _trtdiff2_D _trtdiff2_B_des_ABC _trtdiff2_B_d
> es_ABD _trtdiff2_C_des_AC _trtdiff2_D_des_AD _trtdiff2_C_des_BC _trtdiff2_D_d
> es_BD _trtdiff2_D_des_CD 

Estimated between-studies SDs and correlation matrix:
             SD       _y_1       _y_2
_y_1  .74316262          1          .
_y_2  .74316262         .5          1

Testing for inconsistency:
 ( 1)  [_y_1]_trtdiff1_B_des_ABC = 0
 ( 2)  [_y_1]_trtdiff1_B_des_ABD = 0
 ( 3)  [_y_1]_trtdiff1_C_des_AC = 0
 ( 4)  [_y_1]_trtdiff1_D_des_AD = 0
 ( 5)  [_y_1]_trtdiff1_C_des_BC = 0
 ( 6)  [_y_1]_trtdiff1_D_des_BD = 0
 ( 7)  [_y_1]_trtdiff1_D_des_CD = 0

           chi2(  7) =    5.11
         Prob > chi2 =    0.6464
mvmeta command stored as F9; test command stored as F8
         studyvar                stud
         design                  _design
         ref                     A
         trtlistnoref            B C D
         trtnameA                Group counselling
         trtnameB                Individual counselling
         trtnameC                No contact
         trtnameD                Self help
         maxarms                 3
         measure                 Log odds ratio
         outcome                 count
         dim                     2
         format                  standard
         d                       d
         n                       n
         nmiss                   
         y                       _y
         S                       _S
         contrast                _contrast
         trtdiff                 _trtdiff
         component               
         MNAR                    
         testcons_type           chi2
         testcons_stat           5.111146857208371
         testcons_df             7
         testcons_p              .6464014598607619
         metavars                _trtdiff1_B _trtdiff1_C _trtdiff1_D _trtdiff2_
> B _trtdiff2_C _trtdiff2_D des_AB des_ABC des_ABD des_AC des_AD des_BC des_BD 
> des_CD _trtdiff1_B_des_ABC _trtdiff2_B_des_ABC _trtdiff1_B_des_ABD _trtdiff2_
> B_des_ABD _trtdiff1_C_des_AC _trtdiff2_C_des_AC _trtdiff1_D_des_AD _trtdiff2_
> D_des_AD _trtdiff1_C_des_BC _trtdiff2_C_des_BC _trtdiff1_D_des_BD _trtdiff2_D
> _des_BD _trtdiff1_D_des_CD _trtdiff2_D_des_CD
         consistency_fitted      _network_consistency
         inconsistency_fitted    _network_inconsistency
         plot_location           
         ncomponents             1
         df_inconsistency        7
         df_heterogeneity        16
group(design) assumed
Listing of study-level results: studyvar design t1 t2 diff se

     +---------------------------------------------------------+
     |     stud   _design   _t1   _t2           _y     _stderr |
     |---------------------------------------------------------|
  1. |  Study 1     A B C     A     B    .92276545   .39979716 |
  2. |  Study 1     A B C     A     C   -.12852757   .47598025 |
  3. |  Study 1     A B C     B     C    -1.051293   .41324323 |
  4. | Study 10       B C     B     C   -2.7053933   .62516082 |
  5. | Study 11       B C     B     C   -2.4251874   1.0422512 |
     |---------------------------------------------------------|
  6. | Study 12       B C     B     C   -.44361687   .52197691 |
  7. | Study 13       B C     B     C    -.4645909   .14174615 |
  8. | Study 14       B C     B     C    .15581043   .32122305 |
  9. | Study 15       B C     B     C    .23997016   .17365643 |
 10. | Study 16       B C     B     C   -.03895601    .1873842 |
     |---------------------------------------------------------|
 11. | Study 17       B C     B     C   -.39041227   .16801771 |
 12. | Study 18       B C     B     C   -.10633565   .59559968 |
 13. | Study 19       B C     B     C   -.58339829   .29834673 |
 14. |  Study 2     A B D     A     B   -.22408873    .3722995 |
 15. |  Study 2     A B D     A     D   -.22533329   .38393935 |
     |---------------------------------------------------------|
 16. |  Study 2     A B D     B     D   -.00124456   .45040696 |
 17. | Study 20       A C     A     C   -3.5225168    1.496997 |
 18. | Study 21       B D     B     D    .15168459   .42897529 |
 19. | Study 22       A D     A     D   -1.0434863   .44897952 |
 20. | Study 23       A B     A     B   -.68072466   .40923936 |
     |---------------------------------------------------------|
 21. | Study 24       A B     A     B    .40546511   .71390604 |
 22. |  Study 3       C D     C     D   -.01596494   .16991505 |
 23. |  Study 4       C D     C     D    .39350454   .32657545 |
 24. |  Study 5       C D     C     D    .70294158   .44132171 |
 25. |  Study 6       B C     B     C   -2.2022893   .14304387 |
     |---------------------------------------------------------|
 26. |  Study 7       B C     B     C   -.87035364   .79109325 |
 27. |  Study 8       B C     B     C   -.41564852    .1557329 |
 28. |  Study 9       B C     B     C   -2.7796837   1.4698402 |
     +---------------------------------------------------------+
inconsistency results will be taken from matrix _network_inconsistency
Listing of inconsistency results:  design t1 t2 diff se

     +-----------------------------------------------------+
     | _desig~o   _t1inco   _t2inco       inco4      inco5 |
     |-----------------------------------------------------|
  1. |      A B         A         B   -.2419329   .6556959 |
  2. |    A B C         A         B    .9227654    .843877 |
  3. |    A B C         A         C   -.1285276   .8825236 |
  4. |    A B C         B         C   -1.051293   .8503298 |
  5. |    A B D         A         B   -.2240887   .8312025 |
     |-----------------------------------------------------|
  6. |    A B D         A         D   -.2253333   .8364808 |
  7. |    A B D         B         D   -.0012446   .8689978 |
  8. |      A C         A         C   -3.522517   1.671314 |
  9. |      A D         A         D   -1.043486   .8682588 |
 10. |      B C         B         C   -.7044794   .2348016 |
     |-----------------------------------------------------|
 11. |      B D         B         D    .1516846   .8580853 |
 12. |      C D         C         D    .3300633   .4675836 |
     +-----------------------------------------------------+
consistency results will be taken from matrix _network_consistency
Listing of consistency results:  design t1 t2 diff se

     +-----------------------------------------------------+
     | _desig~s   _t1cons   _t2cons       cons4      cons5 |
     |-----------------------------------------------------|
  1. |      A B         A         B   -.1635346    .354741 |
  2. |    A B C         A         B   -.1635346    .354741 |
  3. |    A B C         A         C   -.8658902   .3762928 |
  4. |    A B C         B         C   -.7023556   .1991095 |
  5. |    A B D         A         B   -.1635346    .354741 |
     |-----------------------------------------------------|
  6. |    A B D         A         D   -.4674415   .4074053 |
  7. |    A B D         B         D   -.3039069   .3405171 |
  8. |      A C         A         C   -.8658902   .3762928 |
  9. |      A D         A         D   -.4674415   .4074053 |
 10. |      B C         B         C   -.7023556   .1991095 |
     |-----------------------------------------------------|
 11. |      B D         B         D   -.3039069   .3405171 |
 12. |      C D         C         D    .3984487   .3311044 |
     +-----------------------------------------------------+
graph twoway (scatter row diff if type=="study" [aw=1/se^2], mcol(blue) msymbol
> (S) msize(*0.2)) (pcspike row low row upp if type=="study" & lowistrunc==0 & 
> uppistrunc==0, lcol(blue) mcol(blue)) (scatter row diff if type=="inco" [aw=1
> /se^2], mcol(green) msymbol(S) msize(*0.2)) (pcspike row low row upp if type=
> ="inco" & lowistrunc==0 & uppistrunc==0, lcol(green) mcol(green)) (scatter ro
> w diff if type=="cons" [aw=1/se^2], mcol(red) msymbol(S) msize(*0.2)) (pcspik
> e row low row upp if type=="cons" & lowistrunc==0 & uppistrunc==0, lcol(red) 
> mcol(red)) (scatter row middle, mlabel(label2) mlabpos(0) ms(none) mlabcol(bl
> ack) ), ylabel(#44, valuelabel angle(0) labsize(vsmall) nogrid ) yscale(rever
> se) plotregion(margin(t=0)) ytitle("") subtitle("")  by(column, row(1) yresca
> le noiytick  note("Test of consistency: chi2(7)=5.11, P=0.646", size(vsmall))
>  legend()) legend(order(1 3 5) label(1 "Studies") label(3 "Pooled within desi
> gn") label(5 "Pooled overall") rows(1)) xlabel(,labsize(small)) xtitle(,size(
> small)) xtitle(Log odds ratio) name(forest_standard, replace)
Loop 2: format pairs
(Smoking data from Lu & Ades (2006))
Treatments used
   A (reference):                      Group counselling
   B:                                  Individual counselling
   C:                                  No contact
   D:                                  Self help

Measure                                Log odds ratio

Studies
   ID variable:                        stud
   Number used:                        24
   IDs with zero cells:                `"Study 20"' `"Study 9"'
   - count added to all their cells:   .5

Network information                    
   Components:                         1 (connected)
   D.f. for inconsistency:             7
   D.f. for heterogeneity:             16

Current data
   Data format:                        pairs
   Design variable:                    _design
   Estimate variable:                  _y
   Standard error variable:            _stderr
   Contrast variable:                  _contrast
   Command to list the data:           list stud _design _contrast _y* _stderr*
> , noo sepby(_design)

----------------------------------------------------------------
          |               Treatment and Statistic               
          | - Group  -    - Indivi -    - No con -    - Self h -
     stud |    d     n       d     n       d     n       d     n
----------+-----------------------------------------------------
  Study 1 |   10   138      23   140       9   140              
 Study 10 |                 31    98       3   100              
 Study 11 |                 26    95       1    31              
 Study 12 |                 17    77       6    39              
 Study 13 |                134  1031      95  1107              
 Study 14 |                 35   504      15   187              
 Study 15 |                 73   675      78   584              
 Study 16 |                 54   888      69  1177              
 Study 17 |                107   761      64   642              
 Study 18 |                  8    90       5    62              
 Study 19 |                 34   237      20   234              
  Study 2 |   29   170      12    85                    11    78
 Study 20 |  9.5    21                    .5    21              
 Study 21 |                 16    43                    20    49
 Study 22 |   32   127                                   7    66
 Study 23 |   20    74      12    76                            
 Study 24 |    3    26       9    55                            
  Study 3 |                               79   702      77   694
  Study 4 |                               18   671      21   535
  Study 5 |                                8   116      19   146
  Study 6 |                363   714      75   731              
  Study 7 |                  9   205       2   106              
  Study 8 |                237  1561      58   549              
  Study 9 |                9.5    49      .5    34              
----------------------------------------------------------------
Improving locations ...
loop 1 score 1================ 0
Stopping after achieving score of 0
Evaluating optimal locations ...
Graph command stored in F9

M[10,3]:  Treatment locations for network map
                       x           y    labelpos
Group coun~g           1           0           3
Individual~g  -.93969262  -.34202014           8
  No contact           0           0           3
   Self help   .76604444   .64278761           2
           .   .17364818   .98480775          12
           .         -.5    .8660254          11
           .  -.93969262   .34202014          10
           .         -.5   -.8660254           7
           .   .17364818  -.98480775           6
           .   .76604444  -.64278761           4
Improving locations ...
loop 1 score 31============= 1.========.==.=====.==.==================..=======
> ==================
loop 2 score 1=======.======...===== 0
Stopping after achieving score of 0
Evaluating optimal locations ...
Graph command stored in F9
Improving locations ...
loop 1 score 140==== 31============== 1==============.===.==.======.===.==. 0
Stopping after achieving score of 0
Evaluating optimal locations ...
Graph command stored in F9
Improving locations ...
loop 1 score 1===================================== 0
Stopping after achieving score of 0
Evaluating optimal locations ...
Graph command stored in F9
Warning: i2 option is not available in pairs format
The data contain multi-arm trials - this analysis in pairs format is wrong
Command is: metareg _y _trtdiff_B _trtdiff_C _trtdiff_D , wsse(_stderr) noconst
> ant

Meta-regression                                       Number of obs  =      28
REML estimate of between-study variance               tau2           =   .4242
% residual variation due to heterogeneity             I-squared_res  =  87.93%
Joint test for all covariates                         Model F(3,25)  =    4.53
With Knapp-Hartung modification                       Prob > F       =  0.0114
------------------------------------------------------------------------------
          _y |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
  _trtdiff_B |  -.0675288   .3261452    -0.21   0.838    -.7392374    .6041797
  _trtdiff_C |  -.7620687   .3456505    -2.20   0.037    -1.473949   -.0501882
  _trtdiff_D |  -.3693277   .3799084    -0.97   0.340    -1.151764    .4131084
------------------------------------------------------------------------------
mvmeta command stored as F9
Table of log odds ratio and its standard error for Treatment vs. Comparator:
-------------------------------------------
           |           Treatment           
Comparator |      A       B       C       D
-----------+-------------------------------
         A |         -0.068  -0.762  -0.369
           |          0.326   0.346   0.380
           | 
         B |  0.068          -0.695  -0.302
           |  0.326           0.195   0.328
           | 
         C |  0.762   0.695           0.393
           |  0.346   0.195           0.321
           | 
         D |  0.369   0.302  -0.393        
           |  0.380   0.328   0.321        
-------------------------------------------
The data contain multi-arm trials - this analysis in pairs format is wrong
Command is: metareg _y _trtdiff_B _trtdiff_C _trtdiff_D _trtdiff_B_des_ABC _trt
> diff_B_des_ABD _trtdiff_C_des_AC _trtdiff_D_des_AD _trtdiff_C_des_BC _trtdiff
> _D_des_BD _trtdiff_D_des_CD , wsse(_stderr) noconstant

Meta-regression                                       Number of obs  =      28
REML estimate of between-study variance               tau2           =   .4714
% residual variation due to heterogeneity             I-squared_res  =  90.48%
Joint test for all covariates                         Model F(10,18) =    1.94
With Knapp-Hartung modification                       Prob > F       =  0.1068
------------------------------------------------------------------------------
          _y |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
  _trtdiff_B |  -.2523552   .6377378    -0.40   0.697    -1.592193    1.087482
  _trtdiff_C |  -.1285276   .6884116    -0.19   0.854    -1.574827    1.317772
  _trtdiff_D |  -.2253333   .6625382    -0.34   0.738    -1.617274    1.166608
_trtdiff_B~C |   1.175121   .9261604     1.27   0.221    -.7706702    3.120911
_trtdiff_B~D |   .0282664   .9178169     0.03   0.976    -1.899995    1.956528
_trtdiff_~AC |  -3.393989   1.823511    -1.86   0.079    -7.225044    .4370652
_trtdiff_~AD |   -.818153   1.070685    -0.76   0.455    -3.067579    1.431273
_trtdiff~_BC |  -.8153816   .9644367    -0.85   0.409    -2.841588    1.210825
_trtdiff~_BD |   .1246627   1.238795     0.10   0.921    -2.477949    2.727275
_trtdiff_~CD |   .4226233   1.055391     0.40   0.694    -1.794672    2.639918
------------------------------------------------------------------------------

Testing for inconsistency:
 ( 1)  _trtdiff_B_des_ABC = 0
 ( 2)  _trtdiff_B_des_ABD = 0
 ( 3)  _trtdiff_C_des_AC = 0
 ( 4)  _trtdiff_D_des_AD = 0
 ( 5)  _trtdiff_C_des_BC = 0
 ( 6)  _trtdiff_D_des_BD = 0
 ( 7)  _trtdiff_D_des_CD = 0

       F(  7,    18) =    0.88
            Prob > F =    0.5441
mvmeta command stored as F9; test command stored as F8
         studyvar                stud
         design                  _design
         ref                     A
         trtlistnoref            B C D
         trtnameA                Group counselling
         trtnameB                Individual counselling
         trtnameC                No contact
         trtnameD                Self help
         maxarms                 3
         measure                 Log odds ratio
         outcome                 count
         dim                     1
         format                  pairs
         d                       d
         n                       n
         nmiss                   
         y                       _y
         stderr                  _stderr
         contrast                _contrast
         t1                      _t1
         t2                      _t2
         trtdiff                 _trtdiff
         component               
         MNAR                    
         testcons_type           F
         testcons_stat           .875567082701574
         testcons_df             7,18
         testcons_p              .5441279245656228
         metavars                _trtdiff_B _trtdiff_C _trtdiff_D des_AB des_AB
> C des_ABD des_AC des_AD des_BC des_BD des_CD _trtdiff_B_des_ABC _trtdiff_B_de
> s_ABD _trtdiff_C_des_AC _trtdiff_D_des_AD _trtdiff_C_des_BC _trtdiff_D_des_BD
>  _trtdiff_D_des_CD
         consistency_fitted      _network_consistency
         inconsistency_fitted    _network_inconsistency
         plot_location           
         ncomponents             1
         df_inconsistency        7
         df_heterogeneity        16
group(design) assumed
Listing of study-level results: studyvar design t1 t2 diff se

     +---------------------------------------------------------+
     |     stud   _design   _t1   _t2           _y     _stderr |
     |---------------------------------------------------------|
  1. |  Study 1     A B C     A     B    .92276545   .39979716 |
  2. |  Study 1     A B C     A     C   -.12852757   .47598025 |
  3. |  Study 1     A B C     B     C    -1.051293   .41324323 |
  4. | Study 10       B C     B     C   -2.7053933   .62516082 |
  5. | Study 11       B C     B     C   -2.4251874   1.0422512 |
     |---------------------------------------------------------|
  6. | Study 12       B C     B     C   -.44361687   .52197691 |
  7. | Study 13       B C     B     C    -.4645909   .14174615 |
  8. | Study 14       B C     B     C    .15581043   .32122305 |
  9. | Study 15       B C     B     C    .23997016   .17365643 |
 10. | Study 16       B C     B     C   -.03895601    .1873842 |
     |---------------------------------------------------------|
 11. | Study 17       B C     B     C   -.39041227   .16801771 |
 12. | Study 18       B C     B     C   -.10633565   .59559968 |
 13. | Study 19       B C     B     C   -.58339829   .29834673 |
 14. |  Study 2     A B D     A     B   -.22408873    .3722995 |
 15. |  Study 2     A B D     A     D   -.22533329   .38393935 |
     |---------------------------------------------------------|
 16. |  Study 2     A B D     B     D   -.00124456   .45040696 |
 17. | Study 20       A C     A     C   -3.5225168    1.496997 |
 18. | Study 21       B D     B     D    .15168459   .42897529 |
 19. | Study 22       A D     A     D   -1.0434863   .44897952 |
 20. | Study 23       A B     A     B   -.68072466   .40923936 |
     |---------------------------------------------------------|
 21. | Study 24       A B     A     B    .40546511   .71390604 |
 22. |  Study 3       C D     C     D   -.01596494   .16991505 |
 23. |  Study 4       C D     C     D    .39350454   .32657545 |
 24. |  Study 5       C D     C     D    .70294158   .44132171 |
 25. |  Study 6       B C     B     C   -2.2022893   .14304387 |
     |---------------------------------------------------------|
 26. |  Study 7       B C     B     C   -.87035364   .79109325 |
 27. |  Study 8       B C     B     C   -.41564852    .1557329 |
 28. |  Study 9       B C     B     C   -2.7796837   1.4698402 |
     +---------------------------------------------------------+
inconsistency results will be taken from matrix _network_inconsistency
Listing of inconsistency results:  design t1 t2 diff se

     +-----------------------------------------------------+
     | _desig~o   _t1inco   _t2inco       inco4      inco5 |
     |-----------------------------------------------------|
  1. |      A B         A         B   -.2523552   .6377378 |
  2. |    A B C         A         B    .9227654   .6716127 |
  3. |    A B C         A         C   -.1285276   .6884116 |
  4. |    A B C         B         C   -1.051293    .674635 |
  5. |    A B D         A         B   -.2240887   .6600593 |
     |-----------------------------------------------------|
  6. |    A B D         A         D   -.2253333   .6625382 |
  7. |    A B D         B         D   -.0012446   .6764933 |
  8. |      A C         A         C   -3.522517   1.688574 |
  9. |      A D         A         D   -1.043486   .8410764 |
 10. |      B C         B         C    -.691554   .2225266 |
     |-----------------------------------------------------|
 11. |      B D         B         D    .1516846   .8300284 |
 12. |      C D         C         D    .3258176    .448312 |
     +-----------------------------------------------------+
consistency results will be taken from matrix _network_consistency
Listing of consistency results:  design t1 t2 diff se

     +-----------------------------------------------------+
     | _desig~s   _t1cons   _t2cons       cons4      cons5 |
     |-----------------------------------------------------|
  1. |      A B         A         B   -.0675288   .3261452 |
  2. |    A B C         A         B   -.0675288   .3261452 |
  3. |    A B C         A         C   -.7620687   .3456505 |
  4. |    A B C         B         C   -.6945398   .1946246 |
  5. |    A B D         A         B   -.0675288   .3261452 |
     |-----------------------------------------------------|
  6. |    A B D         A         D   -.3693277   .3799084 |
  7. |    A B D         B         D   -.3017989    .327707 |
  8. |      A C         A         C   -.7620687   .3456505 |
  9. |      A D         A         D   -.3693277   .3799084 |
 10. |      B C         B         C   -.6945398   .1946246 |
     |-----------------------------------------------------|
 11. |      B D         B         D   -.3017989    .327707 |
 12. |      C D         C         D     .392741   .3214905 |
     +-----------------------------------------------------+
graph twoway (scatter row diff if type=="study" [aw=1/se^2], mcol(blue) msymbol
> (S) msize(*0.2)) (pcspike row low row upp if type=="study" & lowistrunc==0 & 
> uppistrunc==0, lcol(blue) mcol(blue)) (scatter row diff if type=="inco" [aw=1
> /se^2], mcol(green) msymbol(S) msize(*0.2)) (pcspike row low row upp if type=
> ="inco" & lowistrunc==0 & uppistrunc==0, lcol(green) mcol(green)) (scatter ro
> w diff if type=="cons" [aw=1/se^2], mcol(red) msymbol(S) msize(*0.2)) (pcspik
> e row low row upp if type=="cons" & lowistrunc==0 & uppistrunc==0, lcol(red) 
> mcol(red)) (scatter row middle, mlabel(label2) mlabpos(0) ms(none) mlabcol(bl
> ack) ), ylabel(#44, valuelabel angle(0) labsize(vsmall) nogrid ) yscale(rever
> se) plotregion(margin(t=0)) ytitle("") subtitle("")  by(column, row(1) yresca
> le noiytick  note("Test of consistency: F(7,18)=0.88, P=0.544" "The data cont
> ain multi-arm trials - this analysis in pairs format is wrong", size(vsmall))
>  legend()) legend(order(1 3 5) label(1 "Studies") label(3 "Pooled within desi
> gn") label(5 "Pooled overall") rows(1)) xlabel(,labsize(small)) xtitle(,size(
> small)) xtitle(Log odds ratio) name(forest_pairs, replace)

. 
. // and extra-long treatment names with nocodes (should print warnings)
. use smoking, clear
(Smoking data from Lu & Ades (2006))

. decode trt, gen(trtstring)

. drop trt

. rename trtstring trt

. replace trt = subinstr(trt," ","",.)
(50 real changes made)

. keep study trt d n

. network setup d n, studyvar(stud) trtvar(trt) nocodes
Warning: treatment code Groupcounselling has been truncated to 14 characters
Warning: treatment code Individualcounselling has been truncated to 14 characte
> rs
Treatments used
   Groupcounselli (reference):         Groupcounselling
   Individualcoun:                     Individualcounselling
   Nocontact:                          Nocontact
   Selfhelp:                           Selfhelp

Measure                                Log odds ratio

Studies
   ID variable:                        study
   Number used:                        24
   IDs with zero cells:                9 20
   - count added to all their cells:   .5
   IDs with augmented reference arm:   3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18
>  19 21
   - observations added:               0.00001
   - mean in augmented observations:   study-specific mean

Network information                    
   Components:                         1 (connected)
   D.f. for inconsistency:             7
   D.f. for heterogeneity:             16

Current data
   Data format:                        augmented
   Design variable:                    _design
   Estimate variables:                 _y*
   Variance variables:                 _S*
   Command to list the data:           list study _y* _S*, noo sepby(_design)

. 
. // More forest plots - formats should agree
. * Load and analyse the smoking data
. foreach format in pairs aug st {
  2.         di as input "Loop 3: format `format'"
  3.         use smoking, clear
  4.         keep study trt d n
  5.         network setup d n, studyvar(stud) trtvar(trt) format(`format')
  6.         local opts ms(S) xsize(9.8) ysize(7.3) columns(xtile) ///
>                 xline(0,lcol(gray)) contrastpos(2)
  7.         network forest, title(Smoking network) `opts' ///
>                 name(smoke_forest1_`format', replace)   
  8.         local force = cond("`format'"=="pairs","force","")
  9.         network meta c, `force'
 10.         network meta i, `force'
 11.         network forest, title(Smoking network) `opts' ///
>                 name(smoke_forest2_`format', replace) eform group(type) xlabe
> l(0.1 1 10 100)
 12. }
Loop 3: format pairs
(Smoking data from Lu & Ades (2006))
Treatments used
   A (reference):                      No contact
   B:                                  Self help
   C:                                  Individual counselling
   D:                                  Group counselling

Measure                                Log odds ratio

Studies
   ID variable:                        study
   Number used:                        24
   IDs with zero cells:                9 20
   - count added to all their cells:   .5

Network information                    
   Components:                         1 (connected)
   D.f. for inconsistency:             7
   D.f. for heterogeneity:             16

Current data
   Data format:                        pairs
   Design variable:                    _design
   Estimate variable:                  _y
   Standard error variable:            _stderr
   Contrast variable:                  _contrast
   Command to list the data:           list study _design _contrast _y* _stderr
> *, noo sepby(_design)
Drawing raw forest plot without any model results
The data contain multi-arm trials - this analysis in pairs format is wrong
Command is: metareg _y _trtdiff_B _trtdiff_C _trtdiff_D , wsse(_stderr) noconst
> ant

Meta-regression                                       Number of obs  =      28
REML estimate of between-study variance               tau2           =   .4242
% residual variation due to heterogeneity             I-squared_res  =  87.93%
Joint test for all covariates                         Model F(3,25)  =    4.53
With Knapp-Hartung modification                       Prob > F       =  0.0114
------------------------------------------------------------------------------
          _y |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
  _trtdiff_B |    .392741   .3214905     1.22   0.233    -.2693811    1.054863
  _trtdiff_C |   .6945398   .1946246     3.57   0.001     .2937029    1.095377
  _trtdiff_D |   .7620687   .3456505     2.20   0.037     .0501882    1.473949
------------------------------------------------------------------------------
mvmeta command stored as F9
The data contain multi-arm trials - this analysis in pairs format is wrong
Command is: metareg _y _trtdiff_B _trtdiff_C _trtdiff_D _trtdiff_C_des_ACD _trt
> diff_D_des_AD _trtdiff_C_des_BC _trtdiff_C_des_BCD _trtdiff_D_des_BCD _trtdif
> f_D_des_BD _trtdiff_D_des_CD , wsse(_stderr) noconstant

Meta-regression                                       Number of obs  =      28
REML estimate of between-study variance               tau2           =   .4714
% residual variation due to heterogeneity             I-squared_res  =  90.48%
Joint test for all covariates                         Model F(10,18) =    1.94
With Knapp-Hartung modification                       Prob > F       =  0.1068
------------------------------------------------------------------------------
          _y |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
  _trtdiff_B |   .3258176   .4483121     0.73   0.477    -.6160511    1.267686
  _trtdiff_C |    .691554   .2225266     3.11   0.006     .2240429    1.159065
  _trtdiff_D |   .1285276   .6884116     0.19   0.854    -1.317772    1.574827
_trtdiff~ACD |    .359739   .7103875     0.51   0.619     -1.13273    1.852208
_trtdiff_~AD |   3.393989   1.823511     1.86   0.079    -.4370652    7.225044
_trtdiff_C~C |   -.517421   .9692517    -0.53   0.600    -2.553743    1.518901
_t~C_des_BCD |  -.3644918   .8415135    -0.43   0.670    -2.132446    1.403462
_t~D_des_BCD |   .4226233   1.055391     0.40   0.694    -1.794672    2.639918
_trtdiff_~BD |   1.240776   1.175714     1.06   0.305    -1.229307     3.71086
_trtdiff~_CD |   .8153816   .9644367     0.85   0.409    -1.210825    2.841588
------------------------------------------------------------------------------

Testing for inconsistency:
 ( 1)  _trtdiff_C_des_ACD = 0
 ( 2)  _trtdiff_D_des_AD = 0
 ( 3)  _trtdiff_C_des_BC = 0
 ( 4)  _trtdiff_C_des_BCD = 0
 ( 5)  _trtdiff_D_des_BCD = 0
 ( 6)  _trtdiff_D_des_BD = 0
 ( 7)  _trtdiff_D_des_CD = 0

       F(  7,    18) =    0.88
            Prob > F =    0.5441
mvmeta command stored as F9; test command stored as F8
Loop 3: format aug
(Smoking data from Lu & Ades (2006))
Treatments used
   A (reference):                      No contact
   B:                                  Self help
   C:                                  Individual counselling
   D:                                  Group counselling

Measure                                Log odds ratio

Studies
   ID variable:                        study
   Number used:                        24
   IDs with zero cells:                9 20
   - count added to all their cells:   .5
   IDs with augmented reference arm:   2 21 22 23 24
   - observations added:               0.00001
   - mean in augmented observations:   study-specific mean

Network information                    
   Components:                         1 (connected)
   D.f. for inconsistency:             7
   D.f. for heterogeneity:             16

Current data
   Data format:                        augmented
   Design variable:                    _design
   Estimate variables:                 _y*
   Variance variables:                 _S*
   Command to list the data:           list study _y* _S*, noo sepby(_design)
Drawing raw forest plot without any model results
Command is: mvmeta _y _S , bscovariance(exch 0.5) longparm suppress(uv mm) vars
> (_y_B _y_C _y_D)
Note: using method reml
Note: using variables _y_B _y_C _y_D
Note: 24 observations on 3 variables
Note: variance-covariance matrix is proportional to .5*I(3)+.5*J(3,3,1)

initial:       log likelihood = -72.419237
rescale:       log likelihood = -72.419237
rescale eq:    log likelihood = -72.206817
Iteration 0:   log likelihood = -72.206817  
Iteration 1:   log likelihood = -70.791949  
Iteration 2:   log likelihood = -70.764767  
Iteration 3:   log likelihood = -70.764565  
Iteration 4:   log likelihood = -70.764565  

Multivariate meta-analysis
Variance-covariance matrix = proportional .5*I(3)+.5*J(3,3,1)
Method = reml                                  Number of dimensions    =     3
Restricted log likelihood = -70.764565         Number of observations  =    24
------------------------------------------------------------------------------
             |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
_y_B         |
       _cons |   .3984484   .3311037     1.20   0.229    -.2505029      1.0474
-------------+----------------------------------------------------------------
_y_C         |
       _cons |   .7023554   .1991078     3.53   0.000     .3121112      1.0926
-------------+----------------------------------------------------------------
_y_D         |
       _cons |   .8658897   .3762911     2.30   0.021     .1283727    1.603407
------------------------------------------------------------------------------

Estimated between-studies SDs and correlation matrix:
             SD       _y_B       _y_C       _y_D
_y_B  .67446625          1          .          .
_y_C  .67446625         .5          1          .
_y_D  .67446625         .5         .5          1
mvmeta command stored as F9
Command is: mvmeta _y _S , bscovariance(exch 0.5) longparm suppress(uv mm) eq(_
> y_C: des_ACD des_BC des_BCD, _y_D: des_AD des_BCD des_BD des_CD) vars(_y_B _y
> _C _y_D)
Note: using method reml
Note: regressing _y_B on (nothing)
Note: regressing _y_C on des_ACD des_BC des_BCD
Note: regressing _y_D on des_AD des_BCD des_BD des_CD
Note: 24 observations on 3 variables
Note: variance-covariance matrix is proportional to .5*I(3)+.5*J(3,3,1)

initial:       log likelihood = -62.328944
rescale:       log likelihood = -62.328944
rescale eq:    log likelihood = -62.328944
Iteration 0:   log likelihood = -62.328944  
Iteration 1:   log likelihood = -61.601801  
Iteration 2:   log likelihood = -61.601084  
Iteration 3:   log likelihood = -61.601084  

Multivariate meta-analysis
Variance-covariance matrix = proportional .5*I(3)+.5*J(3,3,1)
Method = reml                                  Number of dimensions    =     3
Restricted log likelihood = -61.601084         Number of observations  =    24
------------------------------------------------------------------------------
             |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
_y_B         |
       _cons |   .3300627   .4675832     0.71   0.480    -.5863836    1.246509
-------------+----------------------------------------------------------------
_y_C         |
     des_ACD |   .3468138   .8821519     0.39   0.694    -1.382172      2.0758
      des_BC |  -.5261013   1.004557    -0.52   0.600    -2.494997    1.442794
     des_BCD |  -.3731722   1.013894    -0.37   0.713    -2.360369    1.614024
       _cons |   .7044792   .2348011     3.00   0.003     .2442774    1.164681
-------------+----------------------------------------------------------------
_y_D         |
      des_AD |   3.393989    1.89001     1.80   0.073    -.3103625    7.098341
     des_BCD |   .4268682   1.302759     0.33   0.743    -2.126493    2.980229
      des_BD |   1.245021   1.323387     0.94   0.347    -1.348771    3.838812
      des_CD |   .8178841   1.123174     0.73   0.466    -1.383496    3.019264
       _cons |   .1285276   .8825235     0.15   0.884    -1.601187    1.858242
------------------------------------------------------------------------------

Estimated between-studies SDs and correlation matrix:
             SD       _y_B       _y_C       _y_D
_y_B  .74316243          1          .          .
_y_C  .74316243         .5          1          .
_y_D  .74316243         .5         .5          1

Testing for inconsistency:
 ( 1)  [_y_C]des_ACD = 0
 ( 2)  [_y_D]des_AD = 0
 ( 3)  [_y_C]des_BC = 0
 ( 4)  [_y_C]des_BCD = 0
 ( 5)  [_y_D]des_BCD = 0
 ( 6)  [_y_D]des_BD = 0
 ( 7)  [_y_D]des_CD = 0

           chi2(  7) =    5.11
         Prob > chi2 =    0.6464
mvmeta command stored as F9; test command stored as F8
Loop 3: format st
(Smoking data from Lu & Ades (2006))
Treatments used
   A (reference):                      No contact
   B:                                  Self help
   C:                                  Individual counselling
   D:                                  Group counselling

Measure                                Log odds ratio

Studies
   ID variable:                        study
   Number used:                        24
   IDs with zero cells:                9 20
   - count added to all their cells:   .5

Network information                    
   Components:                         1 (connected)
   D.f. for inconsistency:             7
   D.f. for heterogeneity:             16

Current data
   Data format:                        standard
   Design variable:                    _design
   Estimate variables:                 _y*
   Variance variables:                 _S*
   Contrast variables:                 _contrast*
   Command to list the data:           list study _design _contrast* _y* _S*, n
> oo sepby(_design)
Drawing raw forest plot without any model results
Command is: mvmeta _y _S , bscovariance(exch 0.5) commonparm noconstant suppres
> s(uv mm) eq(_y_1: _trtdiff1_B _trtdiff1_C _trtdiff1_D, _y_2: _trtdiff2_B _trt
> diff2_C _trtdiff2_D) vars(_y_1 _y_2)
Note: using method reml
Note: regressing _y_1 on _trtdiff1_B _trtdiff1_C _trtdiff1_D
Note: regressing _y_2 on _trtdiff2_B _trtdiff2_C _trtdiff2_D
Note: 24 observations on 2 variables
Note: variance-covariance matrix is proportional to .5*I(2)+.5*J(2,2,1)

initial:       log likelihood = -34.471727
rescale:       log likelihood = -34.471727
rescale eq:    log likelihood = -34.259312
Iteration 0:   log likelihood = -34.259312  
Iteration 1:   log likelihood = -32.844434  
Iteration 2:   log likelihood = -32.817175  
Iteration 3:   log likelihood = -32.817057  
Iteration 4:   log likelihood = -32.817057  

Multivariate meta-analysis
Variance-covariance matrix = proportional .5*I(2)+.5*J(2,2,1)
Method = reml                                  Number of dimensions    =     2
Restricted log likelihood = -32.817057         Number of observations  =    24
------------------------------------------------------------------------------
             |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
_y_1         |
 _trtdiff1_B |   .3984487   .3311044     1.20   0.229     -.250504    1.047401
 _trtdiff1_C |   .7023556   .1991095     3.53   0.000     .3121081    1.092603
 _trtdiff1_D |   .8658902   .3762928     2.30   0.021     .1283699    1.603411
------------------------------------------------------------------------------
The above coefficients also apply to the following equations:
    _y_2: _trtdiff2_B _trtdiff2_C _trtdiff2_D 

Estimated between-studies SDs and correlation matrix:
             SD       _y_1       _y_2
_y_1  .67446638          1          .
_y_2  .67446638         .5          1
mvmeta command stored as F9
Command is: mvmeta _y _S , bscovariance(exch 0.5) commonparm noconstant suppres
> s(uv mm) eq(_y_1: _trtdiff1_B _trtdiff1_C _trtdiff1_D _trtdiff1_C_des_ACD _tr
> tdiff1_D_des_AD _trtdiff1_C_des_BC _trtdiff1_C_des_BCD _trtdiff1_D_des_BCD _t
> rtdiff1_D_des_BD _trtdiff1_D_des_CD, _y_2: _trtdiff2_B _trtdiff2_C _trtdiff2_
> D _trtdiff2_C_des_ACD _trtdiff2_D_des_AD _trtdiff2_C_des_BC _trtdiff2_C_des_B
> CD _trtdiff2_D_des_BCD _trtdiff2_D_des_BD _trtdiff2_D_des_CD) vars(_y_1 _y_2)
Note: using method reml
Note: regressing _y_1 on _trtdiff1_B _trtdiff1_C _trtdiff1_D _trtdiff1_C_des_AC
> D _trtdiff1_D_des_AD _trtdiff1_C_des_BC _trtdiff1_C_des_BCD _trtdiff1_D_des_B
> CD _trtdiff1_D_des_BD _trtdiff1_D_des_CD
Note: regressing _y_2 on _trtdiff2_B _trtdiff2_C _trtdiff2_D _trtdiff2_C_des_AC
> D _trtdiff2_D_des_AD _trtdiff2_C_des_BC _trtdiff2_C_des_BCD _trtdiff2_D_des_B
> CD _trtdiff2_D_des_BD _trtdiff2_D_des_CD
Note: 24 observations on 2 variables
Note: variance-covariance matrix is proportional to .5*I(2)+.5*J(2,2,1)

initial:       log likelihood = -24.381433
rescale:       log likelihood = -24.381433
rescale eq:    log likelihood = -24.381433
Iteration 0:   log likelihood = -24.381433  
Iteration 1:   log likelihood = -23.654263  
Iteration 2:   log likelihood = -23.653575  
Iteration 3:   log likelihood = -23.653575  

Multivariate meta-analysis
Variance-covariance matrix = proportional .5*I(2)+.5*J(2,2,1)
Method = reml                                  Number of dimensions    =     2
Restricted log likelihood = -23.653575         Number of observations  =    24
------------------------------------------------------------------------------
             |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
_y_1         |
 _trtdiff1_B |   .3300634   .4675836     0.71   0.480    -.5863837     1.24651
 _trtdiff1_C |   .7044794   .2348016     3.00   0.003     .2442767    1.164682
 _trtdiff1_D |   .1285276   .8825236     0.15   0.884    -1.601187    1.858242
~1_C_des_ACD |   .3468136   .8821522     0.39   0.694    -1.382173      2.0758
_trtdiff1~AD |   3.393989    1.89001     1.80   0.073    -.3103627    7.098341
_trtdiff1~BC |  -.5261006   1.004558    -0.52   0.600    -2.494998    1.442796
~1_C_des_BCD |  -.3731715   1.013895    -0.37   0.713    -2.360369    1.614026
~1_D_des_BCD |   .4268691    1.30276     0.33   0.743    -2.126493    2.980231
_trtdiff1~BD |   1.245022   1.323388     0.94   0.347    -1.348771    3.838815
_~1_D_des_CD |   .8178847   1.123174     0.73   0.466    -1.383496    3.019265
------------------------------------------------------------------------------
The above coefficients also apply to the following equations:
    _y_2: _trtdiff2_B _trtdiff2_C _trtdiff2_D _trtdiff2_C_des_ACD _trtdiff2_D_d
> es_AD _trtdiff2_C_des_BC _trtdiff2_C_des_BCD _trtdiff2_D_des_BCD _trtdiff2_D_
> des_BD _trtdiff2_D_des_CD 

Estimated between-studies SDs and correlation matrix:
             SD       _y_1       _y_2
_y_1  .74316262          1          .
_y_2  .74316262         .5          1

Testing for inconsistency:
 ( 1)  [_y_1]_trtdiff1_C_des_ACD = 0
 ( 2)  [_y_1]_trtdiff1_D_des_AD = 0
 ( 3)  [_y_1]_trtdiff1_C_des_BC = 0
 ( 4)  [_y_1]_trtdiff1_C_des_BCD = 0
 ( 5)  [_y_1]_trtdiff1_D_des_BCD = 0
 ( 6)  [_y_1]_trtdiff1_D_des_BD = 0
 ( 7)  [_y_1]_trtdiff1_D_des_CD = 0

           chi2(  7) =    5.11
         Prob > chi2 =    0.6464
mvmeta command stored as F9; test command stored as F8

. 
. * Load and analyse the thrombolytics data (metareg fails for pairs format - w
> hy?)
. foreach format in aug st {
  2.         di as input "Loop 4: format `format'"
  3.         use thromb, clear
  4.         keep study treat r n
  5.         network setup r n, studyvar(stud) trtvar(treat) format(`format')
  6.         local opts ms(Sh) xsize(9.8) ysize(7.3) columns(xtile) ///
>                 xline(0,lcol(gray)) contrastpos(-1.5) ncolumns(3)
  7.         network forest, title(Thrombolytics network) `opts' ///
>                 name(thromb_forest1_`format', replace) 
  8.         local force = cond("`format'"=="pairs","force","")
  9.         network meta c, `force'
 10.         network compare
 11.         network meta i, `force'
 12.         network forest, title(Thrombolytics network) `opts' ///
>                 name(thromb_forest2_`format', replace) 
 13. }
Loop 4: format aug
(Thrombolytics network meta-analysis from Lu & Ades (2006), corrected)
Treatments used
   A (reference):                      A
   B:                                  B
   C:                                  C
   D:                                  D
   E:                                  E
   F:                                  F
   G:                                  G
   H:                                  H

Measure                                Log odds ratio

Studies
   ID variable:                        study
   Number used:                        28
   IDs with zero cells:                [none]
   IDs with augmented reference arm:   17 18 19 20 21 22 23 24 25 26 27 28
   - observations added:               0.00001
   - mean in augmented observations:   study-specific mean

Network information                    
   Components:                         1 (connected)
   D.f. for inconsistency:             8
   D.f. for heterogeneity:             15

Current data
   Data format:                        augmented
   Design variable:                    _design
   Estimate variables:                 _y*
   Variance variables:                 _S*
   Command to list the data:           list study _y* _S*, noo sepby(_design)
Drawing raw forest plot without any model results
Command is: mvmeta _y _S , bscovariance(exch 0.5) longparm suppress(uv mm) vars
> (_y_B _y_C _y_D _y_E _y_F _y_G _y_H)
Note: using method reml
Note: using variables _y_B _y_C _y_D _y_E _y_F _y_G _y_H
Note: 28 observations on 7 variables
Note: variance-covariance matrix is proportional to .5*I(7)+.5*J(7,7,1)

initial:       log likelihood = -128.22249
rescale:       log likelihood = -117.53856
rescale eq:    log likelihood = -115.63531
Iteration 0:   log likelihood = -115.63531  
Iteration 1:   log likelihood =  -115.4644  
Iteration 2:   log likelihood = -115.45842  
Iteration 3:   log likelihood =  -115.4584  
Iteration 4:   log likelihood =  -115.4584  

Multivariate meta-analysis
Variance-covariance matrix = proportional .5*I(7)+.5*J(7,7,1)
Method = reml                                  Number of dimensions    =     7
Restricted log likelihood = -115.4584          Number of observations  =    28
------------------------------------------------------------------------------
             |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
_y_B         |
       _cons |  -.1612884   .0463903    -3.48   0.001    -.2522116   -.0703651
-------------+----------------------------------------------------------------
_y_C         |
       _cons |    .002128   .0324293     0.07   0.948    -.0614322    .0656882
-------------+----------------------------------------------------------------
_y_D         |
       _cons |  -.0438162   .0488541    -0.90   0.370    -.1395684    .0519361
-------------+----------------------------------------------------------------
_y_E         |
       _cons |  -.1558534   .0803896    -1.94   0.053    -.3134142    .0017074
-------------+----------------------------------------------------------------
_y_F         |
       _cons |  -.1130021   .0619122    -1.83   0.068    -.2343479    .0083436
-------------+----------------------------------------------------------------
_y_G         |
       _cons |  -.1972332   .2215627    -0.89   0.373     -.631488    .2370216
-------------+----------------------------------------------------------------
_y_H         |
       _cons |   .0143584    .040299     0.36   0.722    -.0646261    .0933429
------------------------------------------------------------------------------

Estimated between-studies SDs and correlation matrix:
             SD       _y_B       _y_C       _y_D       _y_E       _y_F
_y_B  .01520432          1          .          .          .          .
_y_C  .01520432         .5          1          .          .          .
_y_D  .01520432         .5         .5          1          .          .
_y_E  .01520432         .5         .5         .5          1          .
_y_F  .01520432         .5         .5         .5         .5          1
_y_G  .01520432         .5         .5         .5         .5         .5
_y_H  .01520432         .5         .5         .5         .5         .5

           _y_G       _y_H
_y_B          .          .
_y_C          .          .
_y_D          .          .
_y_E          .          .
_y_F          .          .
_y_G          1          .
_y_H         .5          1
mvmeta command stored as F9
Table of log odds ratio and its standard error for Treatment vs. Comparator:
---------------------------------------------------------------------------
           |                           Treatment                           
Comparator |      A       B       C       D       E       F       G       H
-----------+---------------------------------------------------------------
         A |         -0.161   0.002  -0.044  -0.156  -0.113  -0.197   0.014
           |          0.046   0.032   0.049   0.080   0.062   0.222   0.040
           | 
         B |  0.161           0.163   0.117   0.005   0.048  -0.036   0.176
           |  0.046           0.057   0.056   0.066   0.057   0.223   0.062
           | 
         C | -0.002  -0.163          -0.046  -0.158  -0.115  -0.199   0.012
           |  0.032   0.057           0.059   0.087   0.070   0.222   0.040
           | 
         D |  0.044  -0.117   0.046          -0.112  -0.069  -0.153   0.058
           |  0.049   0.056   0.059           0.086   0.073   0.226   0.063
           | 
         E |  0.156  -0.005   0.158   0.112           0.043  -0.041   0.170
           |  0.080   0.066   0.087   0.086           0.087   0.232   0.090
           | 
         F |  0.113  -0.048   0.115   0.069  -0.043          -0.084   0.127
           |  0.062   0.057   0.070   0.073   0.087           0.228   0.074
           | 
         G |  0.197   0.036   0.199   0.153   0.041   0.084           0.212
           |  0.222   0.223   0.222   0.226   0.232   0.228           0.224
           | 
         H | -0.014  -0.176  -0.012  -0.058  -0.170  -0.127  -0.212        
           |  0.040   0.062   0.040   0.063   0.090   0.074   0.224        
---------------------------------------------------------------------------
Command is: mvmeta _y _S , bscovariance(exch 0.5) longparm suppress(uv mm) eq(_
> y_C: des_ACH, _y_D: des_AD, _y_F: des_BF, _y_G: des_BG des_CG, _y_H: des_AH d
> es_BH des_CH) vars(_y_B _y_C _y_D _y_E _y_F _y_G _y_H)
Note: using method reml
Note: regressing _y_B on (nothing)
Note: regressing _y_C on des_ACH
Note: regressing _y_D on des_AD
Note: regressing _y_E on (nothing)
Note: regressing _y_F on des_BF
Note: regressing _y_G on des_BG des_CG
Note: regressing _y_H on des_AH des_BH des_CH
Note: 28 observations on 7 variables
Note: variance-covariance matrix is proportional to .5*I(7)+.5*J(7,7,1)

initial:       log likelihood = -117.92653
rescale:       log likelihood =  -114.1119
rescale eq:    log likelihood =  -111.8201
Iteration 0:   log likelihood =  -111.8201  
Iteration 1:   log likelihood = -111.50542  
Iteration 2:   log likelihood = -111.49879  
Iteration 3:   log likelihood = -111.49222  
Iteration 4:   log likelihood = -111.49218  
Iteration 5:   log likelihood = -111.49218  

Multivariate meta-analysis
Variance-covariance matrix = proportional .5*I(7)+.5*J(7,7,1)
Method = reml                                  Number of dimensions    =     7
Restricted log likelihood = -111.49218         Number of observations  =    28
------------------------------------------------------------------------------
             |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
_y_B         |
       _cons |  -.1570566   .2210417    -0.71   0.477    -.5902904    .2761773
-------------+----------------------------------------------------------------
_y_C         |
     des_ACH |   .1590951   .3191612     0.50   0.618    -.4664493    .7846396
       _cons |   -.185097   .2319909    -0.80   0.425    -.6397908    .2695968
-------------+----------------------------------------------------------------
_y_D         |
      des_AD |     .45014   .7288921     0.62   0.537    -.9784622    1.878742
       _cons |  -.0446749   .2207029    -0.20   0.840    -.4772447    .3878949
-------------+----------------------------------------------------------------
_y_E         |
       _cons |  -.1516215   .3153228    -0.48   0.631    -.7696428    .4663997
-------------+----------------------------------------------------------------
_y_F         |
      des_BF |  -.1835905   .3961029    -0.46   0.643    -.9599379    .5927568
       _cons |  -.0603276   .2333211    -0.26   0.796    -.5176285    .3969733
-------------+----------------------------------------------------------------
_y_G         |
      des_BG |   .3279506   .7117498     0.46   0.645    -1.067053    1.722955
      des_CG |  -.1097434   .6948442    -0.16   0.875    -1.471613    1.252126
       _cons |  -.3462582   .5475069    -0.63   0.527    -1.419352    .7268356
-------------+----------------------------------------------------------------
_y_H         |
      des_AH |  -.0585379   .4095562    -0.14   0.886    -.8612533    .7441775
      des_BH |    1.20477   .5346788     2.25   0.024     .1568188    2.252721
      des_CH |  -.4653832   .5027691    -0.93   0.355    -1.450793    .5200261
       _cons |  -.0048226   .2191572    -0.02   0.982    -.4343629    .4247177
------------------------------------------------------------------------------

Estimated between-studies SDs and correlation matrix:
             SD       _y_B       _y_C       _y_D       _y_E       _y_F
_y_B  .21561476          1          .          .          .          .
_y_C  .21561476         .5          1          .          .          .
_y_D  .21561476         .5         .5          1          .          .
_y_E  .21561476         .5         .5         .5          1          .
_y_F  .21561476         .5         .5         .5         .5          1
_y_G  .21561476         .5         .5         .5         .5         .5
_y_H  .21561476         .5         .5         .5         .5         .5

           _y_G       _y_H
_y_B          .          .
_y_C          .          .
_y_D          .          .
_y_E          .          .
_y_F          .          .
_y_G          1          .
_y_H         .5          1

Testing for inconsistency:
 ( 1)  [_y_C]des_ACH = 0
 ( 2)  [_y_D]des_AD = 0
 ( 3)  [_y_H]des_AH = 0
 ( 4)  [_y_F]des_BF = 0
 ( 5)  [_y_G]des_BG = 0
 ( 6)  [_y_H]des_BH = 0
 ( 7)  [_y_G]des_CG = 0
 ( 8)  [_y_H]des_CH = 0

           chi2(  8) =    8.60
         Prob > chi2 =    0.3767
mvmeta command stored as F9; test command stored as F8
Loop 4: format st
(Thrombolytics network meta-analysis from Lu & Ades (2006), corrected)
Treatments used
   A (reference):                      A
   B:                                  B
   C:                                  C
   D:                                  D
   E:                                  E
   F:                                  F
   G:                                  G
   H:                                  H

Measure                                Log odds ratio

Studies
   ID variable:                        study
   Number used:                        28
   IDs with zero cells:                [none]

Network information                    
   Components:                         1 (connected)
   D.f. for inconsistency:             8
   D.f. for heterogeneity:             15

Current data
   Data format:                        standard
   Design variable:                    _design
   Estimate variables:                 _y*
   Variance variables:                 _S*
   Contrast variables:                 _contrast*
   Command to list the data:           list study _design _contrast* _y* _S*, n
> oo sepby(_design)
Drawing raw forest plot without any model results
Command is: mvmeta _y _S , bscovariance(exch 0.5) commonparm noconstant suppres
> s(uv mm) eq(_y_1: _trtdiff1_B _trtdiff1_C _trtdiff1_D _trtdiff1_E _trtdiff1_F
>  _trtdiff1_G _trtdiff1_H, _y_2: _trtdiff2_B _trtdiff2_C _trtdiff2_D _trtdiff2
> _E _trtdiff2_F _trtdiff2_G _trtdiff2_H) vars(_y_1 _y_2)
Note: using method reml
Note: regressing _y_1 on _trtdiff1_B _trtdiff1_C _trtdiff1_D _trtdiff1_E _trtdi
> ff1_F _trtdiff1_G _trtdiff1_H
Note: regressing _y_2 on _trtdiff2_B _trtdiff2_C _trtdiff2_D _trtdiff2_E _trtdi
> ff2_F _trtdiff2_G _trtdiff2_H
Note: 28 observations on 2 variables
Note: variance-covariance matrix is proportional to .5*I(2)+.5*J(2,2,1)

initial:       log likelihood =  -30.93091
rescale:       log likelihood = -20.246987
rescale eq:    log likelihood = -19.390269
Iteration 0:   log likelihood = -19.390269  (not concave)
Iteration 1:   log likelihood = -18.320713  
Iteration 2:   log likelihood = -18.234449  (not concave)
Iteration 3:   log likelihood = -18.214696  
Iteration 4:   log likelihood = -18.168937  
Iteration 5:   log likelihood = -18.167338  
Iteration 6:   log likelihood =  -18.16683  
Iteration 7:   log likelihood = -18.166827  
Iteration 8:   log likelihood = -18.166827  

Multivariate meta-analysis
Variance-covariance matrix = proportional .5*I(2)+.5*J(2,2,1)
Method = reml                                  Number of dimensions    =     2
Restricted log likelihood = -18.166827         Number of observations  =    28
------------------------------------------------------------------------------
             |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
_y_1         |
 _trtdiff1_B |  -.1612883   .0464012    -3.48   0.001     -.252233   -.0703436
 _trtdiff1_C |    .002128   .0324349     0.07   0.948    -.0614433    .0656992
 _trtdiff1_D |  -.0438162   .0488541    -0.90   0.370    -.1395684    .0519361
 _trtdiff1_E |  -.1558533   .0803958    -1.94   0.053    -.3134262    .0017196
 _trtdiff1_F |  -.1130021   .0619173    -1.83   0.068    -.2343577    .0083535
 _trtdiff1_G |  -.1972332   .2215627    -0.89   0.373     -.631488    .2370217
 _trtdiff1_H |   .0143583   .0403242     0.36   0.722    -.0646756    .0933923
------------------------------------------------------------------------------
The above coefficients also apply to the following equations:
    _y_2: _trtdiff2_B _trtdiff2_C _trtdiff2_D _trtdiff2_E _trtdiff2_F _trtdiff2
> _G _trtdiff2_H 

Estimated between-studies SDs and correlation matrix:
             SD       _y_1       _y_2
_y_1  .01520369          1          .
_y_2  .01520369         .5          1
mvmeta command stored as F9
Table of log odds ratio and its standard error for Treatment vs. Comparator:
---------------------------------------------------------------------------
           |                           Treatment                           
Comparator |      A       B       C       D       E       F       G       H
-----------+---------------------------------------------------------------
         A |         -0.161   0.002  -0.044  -0.156  -0.113  -0.197   0.014
           |          0.046   0.032   0.049   0.080   0.062   0.222   0.040
           | 
         B |  0.161           0.163   0.117   0.005   0.048  -0.036   0.176
           |  0.046           0.057   0.056   0.066   0.057   0.223   0.062
           | 
         C | -0.002  -0.163          -0.046  -0.158  -0.115  -0.199   0.012
           |  0.032   0.057           0.059   0.087   0.070   0.222   0.040
           | 
         D |  0.044  -0.117   0.046          -0.112  -0.069  -0.153   0.058
           |  0.049   0.056   0.059           0.086   0.073   0.226   0.063
           | 
         E |  0.156  -0.005   0.158   0.112           0.043  -0.041   0.170
           |  0.080   0.066   0.087   0.086           0.087   0.232   0.090
           | 
         F |  0.113  -0.048   0.115   0.069  -0.043          -0.084   0.127
           |  0.062   0.057   0.070   0.073   0.087           0.228   0.074
           | 
         G |  0.197   0.036   0.199   0.153   0.041   0.084           0.212
           |  0.222   0.223   0.222   0.226   0.232   0.228           0.224
           | 
         H | -0.014  -0.176  -0.012  -0.058  -0.170  -0.127  -0.212        
           |  0.040   0.062   0.040   0.063   0.090   0.074   0.224        
---------------------------------------------------------------------------
Command is: mvmeta _y _S , bscovariance(exch 0.5) commonparm noconstant suppres
> s(uv mm) eq(_y_1: _trtdiff1_B _trtdiff1_C _trtdiff1_D _trtdiff1_E _trtdiff1_F
>  _trtdiff1_G _trtdiff1_H _trtdiff1_C_des_ACH _trtdiff1_D_des_AD _trtdiff1_H_d
> es_AH _trtdiff1_F_des_BF _trtdiff1_G_des_BG _trtdiff1_H_des_BH _trtdiff1_G_de
> s_CG _trtdiff1_H_des_CH, _y_2: _trtdiff2_B _trtdiff2_C _trtdiff2_D _trtdiff2_
> E _trtdiff2_F _trtdiff2_G _trtdiff2_H _trtdiff2_C_des_ACH _trtdiff2_D_des_AD 
> _trtdiff2_H_des_AH _trtdiff2_F_des_BF _trtdiff2_G_des_BG _trtdiff2_H_des_BH _
> trtdiff2_G_des_CG _trtdiff2_H_des_CH) vars(_y_1 _y_2)
Note: using method reml
Note: regressing _y_1 on _trtdiff1_B _trtdiff1_C _trtdiff1_D _trtdiff1_E _trtdi
> ff1_F _trtdiff1_G _trtdiff1_H _trtdiff1_C_des_ACH _trtdiff1_D_des_AD _trtdiff
> 1_H_des_AH _trtdiff1_F_des_BF _trtdiff1_G_des_BG _trtdiff1_H_des_BH _trtdiff1
> _G_des_CG _trtdiff1_H_des_CH
Note: regressing _y_2 on _trtdiff2_B _trtdiff2_C _trtdiff2_D _trtdiff2_E _trtdi
> ff2_F _trtdiff2_G _trtdiff2_H _trtdiff2_C_des_ACH _trtdiff2_D_des_AD _trtdiff
> 2_H_des_AH _trtdiff2_F_des_BF _trtdiff2_G_des_BG _trtdiff2_H_des_BH _trtdiff2
> _G_des_CG _trtdiff2_H_des_CH
Note: 28 observations on 2 variables
Note: variance-covariance matrix is proportional to .5*I(2)+.5*J(2,2,1)

initial:       log likelihood = -20.634952
rescale:       log likelihood = -16.820324
rescale eq:    log likelihood = -15.214981
Iteration 0:   log likelihood = -15.214981  
Iteration 1:   log likelihood = -14.790576  
Iteration 2:   log likelihood = -14.477022  
Iteration 3:   log likelihood = -14.450069  
Iteration 4:   log likelihood = -14.224355  
Iteration 5:   log likelihood = -14.200664  
Iteration 6:   log likelihood = -14.200606  
Iteration 7:   log likelihood = -14.200606  

Multivariate meta-analysis
Variance-covariance matrix = proportional .5*I(2)+.5*J(2,2,1)
Method = reml                                  Number of dimensions    =     2
Restricted log likelihood = -14.200606         Number of observations  =    28
------------------------------------------------------------------------------
             |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
_y_1         |
 _trtdiff1_B |  -.1570565   .2210418    -0.71   0.477    -.5902905    .2761775
 _trtdiff1_C |  -.1850971   .2319003    -0.80   0.425    -.6396133    .2694192
 _trtdiff1_D |  -.0446749    .220703    -0.20   0.840    -.4772448     .387895
 _trtdiff1_E |  -.1516215   .3153228    -0.48   0.631     -.769643    .4663999
 _trtdiff1_F |  -.0603276   .2333211    -0.26   0.796    -.5176286    .3969734
 _trtdiff1_G |  -.3462582    .547507    -0.63   0.527    -1.419352    .7268357
 _trtdiff1_H |  -.0048226   .2191573    -0.02   0.982     -.434363    .4247178
~1_C_des_ACH |   .1590952   .3190959     0.50   0.618    -.4663213    .7845117
_trtdiff1~AD |     .45014   .7288921     0.62   0.537    -.9784623    1.878742
_trtdiff1~AH |  -.0585379    .409556    -0.14   0.886    -.8612529    .7441772
_trtdiff1~BF |  -.1835906   .3960797    -0.46   0.643    -.9598925    .5927114
_trtdiff1~BG |   .3279506   .7117494     0.46   0.645    -1.067053    1.722954
_trtdiff1~BH |    1.20477   .5346789     2.25   0.024     .1568187    2.252722
_trtdiff1~CG |  -.1097435   .6948161    -0.16   0.874    -1.471558    1.252071
_~1_H_des_CH |  -.4653833   .5027268    -0.93   0.355     -1.45071    .5199431
------------------------------------------------------------------------------
The above coefficients also apply to the following equations:
    _y_2: _trtdiff2_B _trtdiff2_C _trtdiff2_D _trtdiff2_E _trtdiff2_F _trtdiff2
> _G _trtdiff2_H _trtdiff2_C_des_ACH _trtdiff2_D_des_AD _trtdiff2_H_des_AH _trt
> diff2_F_des_BF _trtdiff2_G_des_BG _trtdiff2_H_des_BH _trtdiff2_G_des_CG _trtd
> iff2_H_des_CH 

Estimated between-studies SDs and correlation matrix:
             SD       _y_1       _y_2
_y_1  .21561481          1          .
_y_2  .21561481         .5          1

Testing for inconsistency:
 ( 1)  [_y_1]_trtdiff1_C_des_ACH = 0
 ( 2)  [_y_1]_trtdiff1_D_des_AD = 0
 ( 3)  [_y_1]_trtdiff1_H_des_AH = 0
 ( 4)  [_y_1]_trtdiff1_F_des_BF = 0
 ( 5)  [_y_1]_trtdiff1_G_des_BG = 0
 ( 6)  [_y_1]_trtdiff1_H_des_BH = 0
 ( 7)  [_y_1]_trtdiff1_G_des_CG = 0
 ( 8)  [_y_1]_trtdiff1_H_des_CH = 0

           chi2(  8) =    8.61
         Prob > chi2 =    0.3767
mvmeta command stored as F9; test command stored as F8

. 
. * Check if and in
. use thromb, clear
(Thrombolytics network meta-analysis from Lu & Ades (2006), corrected)

. keep study treat r n

. network setup r n, studyvar(stud) trtvar(treat) 
Treatments used
   A (reference):                      A
   B:                                  B
   C:                                  C
   D:                                  D
   E:                                  E
   F:                                  F
   G:                                  G
   H:                                  H

Measure                                Log odds ratio

Studies
   ID variable:                        study
   Number used:                        28
   IDs with zero cells:                [none]
   IDs with augmented reference arm:   17 18 19 20 21 22 23 24 25 26 27 28
   - observations added:               0.00001
   - mean in augmented observations:   study-specific mean

Network information                    
   Components:                         1 (connected)
   D.f. for inconsistency:             8
   D.f. for heterogeneity:             15

Current data
   Data format:                        augmented
   Design variable:                    _design
   Estimate variables:                 _y*
   Variance variables:                 _S*
   Command to list the data:           list study _y* _S*, noo sepby(_design)

. network meta i if study>10
Treatments not found in subset: D
Command is: mvmeta _y _S if study>10 , bscovariance(exch 0.5) longparm suppress
> (uv mm) eq(_y_B: des_BG des_BH, _y_C: des_CH) vars(_y_F _y_G _y_H _y_B _y_E _
> y_C)
Note: using method reml
Note: regressing _y_F on (nothing)
Note: regressing _y_G on (nothing)
Note: regressing _y_H on (nothing)
Note: regressing _y_B on des_BG des_BH
Note: regressing _y_E on (nothing)
Note: regressing _y_C on des_CH
Note: 18 observations on 6 variables
Note: variance-covariance matrix is proportional to .5*I(6)+.5*J(6,6,1)

initial:       log likelihood = -110.20659
rescale:       log likelihood = -108.22602
rescale eq:    log likelihood = -106.50072
Iteration 0:   log likelihood = -106.50072  
Iteration 1:   log likelihood = -106.17186  
Iteration 2:   log likelihood = -106.13997  (not concave)
Iteration 3:   log likelihood = -106.11843  
Iteration 4:   log likelihood = -106.10494  (not concave)
Iteration 5:   log likelihood = -106.09921  
Iteration 6:   log likelihood = -106.09145  (not concave)
Iteration 7:   log likelihood = -106.08937  (not concave)
Iteration 8:   log likelihood = -106.08918  (not concave)
Iteration 9:   log likelihood = -106.08911  
Iteration 10:  log likelihood = -106.08892  
Iteration 11:  log likelihood = -106.08879  
Iteration 12:  log likelihood = -106.08879  

Multivariate meta-analysis
Variance-covariance matrix = proportional .5*I(6)+.5*J(6,6,1)
Method = reml                                  Number of dimensions    =     6
Restricted log likelihood = -106.08879         Number of observations  =    18
------------------------------------------------------------------------------
             |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
_y_F         |
       _cons |  -.0603259   .0891573    -0.68   0.499    -.2350709    .1144191
-------------+----------------------------------------------------------------
_y_G         |
       _cons |  -.3462579   .5032633    -0.69   0.491    -1.332636    .6401199
-------------+----------------------------------------------------------------
_y_H         |
       _cons |  -.0725392   .3197664    -0.23   0.821    -.6992699    .5541915
-------------+----------------------------------------------------------------
_y_B         |
      des_BG |  -.3876683   .6254256    -0.62   0.535     -1.61348    .8381433
      des_BH |  -1.347204   .5284601    -2.55   0.011    -2.382967   -.3114413
       _cons |  -.0797474   .1110003    -0.72   0.472     -.297304    .1378091
-------------+----------------------------------------------------------------
_y_E         |
       _cons |  -.0743119   .1280638    -0.58   0.562    -.3253123    .1766885
-------------+----------------------------------------------------------------
_y_C         |
      des_CH |   .2817386   .7718651     0.37   0.715    -1.231089    1.794566
       _cons |  -.0705827   .6069195    -0.12   0.907    -1.260123    1.118958
------------------------------------------------------------------------------

Estimated between-studies SDs and correlation matrix:
             SD       _y_F       _y_G       _y_H       _y_B       _y_E
_y_F  9.866e-06          1          .          .          .          .
_y_G  9.866e-06         .5          1          .          .          .
_y_H  9.866e-06         .5         .5          1          .          .
_y_B  9.866e-06         .5         .5         .5          1          .
_y_E  9.866e-06         .5         .5         .5         .5          1
_y_C  9.866e-06         .5         .5         .5         .5         .5

           _y_C
_y_F          .
_y_G          .
_y_H          .
_y_B          .
_y_E          .
_y_C          1

Testing for inconsistency:
 ( 1)  [_y_B]des_BG = 0
 ( 2)  [_y_B]des_BH = 0
 ( 3)  [_y_C]des_CH = 0

           chi2(  3) =    7.58
         Prob > chi2 =    0.0556
mvmeta command stored as F9; test command stored as F8

. local test1 = r(chi2)

. keep if study>10
(10 observations deleted)

. network meta i
Treatments not found in subset: D
Command is: mvmeta _y _S , bscovariance(exch 0.5) longparm suppress(uv mm) eq(_
> y_B: des_BG des_BH, _y_C: des_CH) vars(_y_F _y_G _y_H _y_B _y_E _y_C)
Note: using method reml
Note: regressing _y_F on (nothing)
Note: regressing _y_G on (nothing)
Note: regressing _y_H on (nothing)
Note: regressing _y_B on des_BG des_BH
Note: regressing _y_E on (nothing)
Note: regressing _y_C on des_CH
Note: 18 observations on 6 variables
Note: variance-covariance matrix is proportional to .5*I(6)+.5*J(6,6,1)

initial:       log likelihood = -110.20659
rescale:       log likelihood = -108.22602
rescale eq:    log likelihood = -106.50072
Iteration 0:   log likelihood = -106.50072  
Iteration 1:   log likelihood = -106.17186  
Iteration 2:   log likelihood = -106.13997  (not concave)
Iteration 3:   log likelihood = -106.11843  
Iteration 4:   log likelihood = -106.10494  (not concave)
Iteration 5:   log likelihood = -106.09921  
Iteration 6:   log likelihood = -106.09145  (not concave)
Iteration 7:   log likelihood = -106.08937  (not concave)
Iteration 8:   log likelihood = -106.08918  (not concave)
Iteration 9:   log likelihood = -106.08911  
Iteration 10:  log likelihood = -106.08892  
Iteration 11:  log likelihood = -106.08879  
Iteration 12:  log likelihood = -106.08879  

Multivariate meta-analysis
Variance-covariance matrix = proportional .5*I(6)+.5*J(6,6,1)
Method = reml                                  Number of dimensions    =     6
Restricted log likelihood = -106.08879         Number of observations  =    18
------------------------------------------------------------------------------
             |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
_y_F         |
       _cons |  -.0603259   .0891573    -0.68   0.499    -.2350709    .1144191
-------------+----------------------------------------------------------------
_y_G         |
       _cons |  -.3462579   .5032633    -0.69   0.491    -1.332636    .6401199
-------------+----------------------------------------------------------------
_y_H         |
       _cons |  -.0725392   .3197664    -0.23   0.821    -.6992699    .5541915
-------------+----------------------------------------------------------------
_y_B         |
      des_BG |  -.3876683   .6254256    -0.62   0.535     -1.61348    .8381433
      des_BH |  -1.347204   .5284601    -2.55   0.011    -2.382967   -.3114413
       _cons |  -.0797474   .1110003    -0.72   0.472     -.297304    .1378091
-------------+----------------------------------------------------------------
_y_E         |
       _cons |  -.0743119   .1280638    -0.58   0.562    -.3253123    .1766885
-------------+----------------------------------------------------------------
_y_C         |
      des_CH |   .2817386   .7718651     0.37   0.715    -1.231089    1.794566
       _cons |  -.0705827   .6069195    -0.12   0.907    -1.260123    1.118958
------------------------------------------------------------------------------

Estimated between-studies SDs and correlation matrix:
             SD       _y_F       _y_G       _y_H       _y_B       _y_E
_y_F  9.866e-06          1          .          .          .          .
_y_G  9.866e-06         .5          1          .          .          .
_y_H  9.866e-06         .5         .5          1          .          .
_y_B  9.866e-06         .5         .5         .5          1          .
_y_E  9.866e-06         .5         .5         .5         .5          1
_y_C  9.866e-06         .5         .5         .5         .5         .5

           _y_C
_y_F          .
_y_G          .
_y_H          .
_y_B          .
_y_E          .
_y_C          1

Testing for inconsistency:
 ( 1)  [_y_B]des_BG = 0
 ( 2)  [_y_B]des_BH = 0
 ( 3)  [_y_C]des_CH = 0

           chi2(  3) =    7.58
         Prob > chi2 =    0.0556
mvmeta command stored as F9; test command stored as F8

. local test2 = r(chi2)

. di `test1', `test2'
7.5778892 7.5778892

. assert abs(`test2'/`test1'-1) < 1E-10 

. 
. * Check rank
. network meta c
Treatments not found in subset: D
Command is: mvmeta _y _S , bscovariance(exch 0.5) longparm suppress(uv mm) vars
> (_y_F _y_G _y_H _y_B _y_E _y_C)
Note: using method reml
Note: using variables _y_F _y_G _y_H _y_B _y_E _y_C
Note: 18 observations on 6 variables
Note: variance-covariance matrix is proportional to .5*I(6)+.5*J(6,6,1)

initial:       log likelihood = -114.88088
rescale:       log likelihood = -112.00466
rescale eq:    log likelihood = -111.05856
Iteration 0:   log likelihood = -111.05856  
Iteration 1:   log likelihood = -110.88169  
Iteration 2:   log likelihood = -110.86186  (not concave)
Iteration 3:   log likelihood = -110.85332  
Iteration 4:   log likelihood = -110.84486  
Iteration 5:   log likelihood =  -110.8448  
Iteration 6:   log likelihood =  -110.8448  

Multivariate meta-analysis
Variance-covariance matrix = proportional .5*I(6)+.5*J(6,6,1)
Method = reml                                  Number of dimensions    =     6
Restricted log likelihood = -110.8448          Number of observations  =    18
------------------------------------------------------------------------------
             |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
_y_F         |
       _cons |  -.2691167   .3160031    -0.85   0.394    -.8884713    .3502379
-------------+----------------------------------------------------------------
_y_G         |
       _cons |  -.1065986   .3410252    -0.31   0.755    -.7749957    .5617985
-------------+----------------------------------------------------------------
_y_H         |
       _cons |   .2592303   .2849988     0.91   0.363    -.2993571    .8178177
-------------+----------------------------------------------------------------
_y_B         |
       _cons |   -.335638   .3435057    -0.98   0.329    -1.008897    .3376207
-------------+----------------------------------------------------------------
_y_E         |
       _cons |   -.330203   .4185735    -0.79   0.430    -1.150592     .490186
-------------+----------------------------------------------------------------
_y_C         |
       _cons |   .3403516   .3817498     0.89   0.373    -.4078643    1.088567
------------------------------------------------------------------------------

Estimated between-studies SDs and correlation matrix:
             SD       _y_F       _y_G       _y_H       _y_B       _y_E
_y_F  .23049425          1          .          .          .          .
_y_G  .23049425         .5          1          .          .          .
_y_H  .23049425         .5         .5          1          .          .
_y_B  .23049425         .5         .5         .5          1          .
_y_E  .23049425         .5         .5         .5         .5          1
_y_C  .23049425         .5         .5         .5         .5         .5

           _y_C
_y_F          .
_y_G          .
_y_H          .
_y_B          .
_y_E          .
_y_C          1
mvmeta command stored as F9

. network rank min, rep(50) seed(41087) cum all bar saving(z) replace mcse ///
>         title(Rank bars) name(rank1, replace) legend(row(2))
Command is: mvmeta, noest pbest(min  in 1, zero id(study) rep(50) seed(41087) c
> um all bar saving(z) replace mcse title(Rank bars) name(rank1, replace) legen
> d(row(2)) stripprefix(_y_) zeroname(A) rename(A = A, B = B, C = C, D = D, E =
>  E, F = F, G = G, H = H))

Estimated probabilities (%) of each treatment being the best (and other ranks)
- assuming the minimum parameter is the best
- using 50 draws (written to file z.dta)
- allowing for parameter uncertainty
- figures are estimated probability (upper), Monte Carlo error (lower)
----------------------------------------------------
study and |                Treatment                
Rank      |    A     F     G     H     B     E     C
----------+-----------------------------------------
11        |
     Best |  6.0  12.0   6.0   0.0  26.0  50.0   0.0
          |  3.4   4.6   3.4   0.0   6.2   7.1   0.0
          | 
      2nd |  4.0  36.0   8.0   0.0  36.0  16.0   0.0
          |  2.8   6.8   3.8   0.0   6.8   5.2   0.0
          | 
      3rd |  2.0  42.0   8.0   0.0  26.0  20.0   2.0
          |  2.0   7.0   3.8   0.0   6.2   5.7   2.0
          | 
      4th | 36.0   6.0  34.0   4.0   6.0   8.0   6.0
          |  6.8   3.4   6.7   2.8   3.4   3.8   3.4
          | 
      5th | 32.0   4.0  32.0  14.0   4.0   2.0  12.0
          |  6.6   2.8   6.6   4.9   2.8   2.0   4.6
          | 
      6th | 12.0   0.0  10.0  42.0   2.0   2.0  32.0
          |  4.6   0.0   4.2   7.0   2.0   2.0   6.6
          | 
    Worst |  8.0   0.0   2.0  40.0   0.0   2.0  48.0
          |  3.8   0.0   2.0   6.9   0.0   2.0   7.1
----------------------------------------------------
mvmeta command is stored in F9

. network rank min, meanrank clear line predict trtcodes ///
>         ylabel(0 25 50) title(Rankogram) name(rank2, replace)
Command is: mvmeta, noest pbest(min  in 1, zero id(study) meanrank clear line p
> redict ylabel(0 25 50) title(Rankogram) name(rank2, replace) stripprefix(_y_)
>  zeroname(A) rename())
Option line specified -> option all assumed

Estimated probabilities (%) of each treatment being the best (and other ranks)
- assuming the minimum parameter is the best
- using 1000 draws
- allowing for parameter uncertainty and between-studies variation
----------------------------------------------------
study and |                Treatment                
Rank      |    A     F     G     H     B     E     C
----------+-----------------------------------------
11        |
     Best |  6.9  18.8  13.8   1.0  26.6  31.3   1.6
      2nd |  8.2  22.6  13.1   2.4  31.2  19.7   2.8
      3rd | 12.7  26.9  15.2   4.3  20.2  17.8   2.9
      4th | 20.5  16.7  24.3   8.5  11.7  12.4   5.9
      5th | 27.0   8.8  19.2  15.1   6.4   9.5  14.0
      6th | 16.5   4.4   9.7  36.3   2.5   5.5  25.1
    Worst |  8.2   1.8   4.7  32.4   1.4   3.8  47.7
MEAN RANK |  4.3   2.9   3.7   5.7   2.5   2.8   5.9
    SUCRA |  0.4   0.7   0.6   0.2   0.7   0.7   0.2
----------------------------------------------------
Tabulate command is stored in F7
Graph command is stored in F8
mvmeta command is stored in F9

. 
. * Check network import from augmented format, and play with prefixes
. use thromb, clear
(Thrombolytics network meta-analysis from Lu & Ades (2006), corrected)

. keep study treat r n

. network setup r n, studyvar(stud) trtvar(treat) genprefix(AA)
Treatments used
   A (reference):                      A
   B:                                  B
   C:                                  C
   D:                                  D
   E:                                  E
   F:                                  F
   G:                                  G
   H:                                  H

Measure                                Log odds ratio

Studies
   ID variable:                        study
   Number used:                        28
   IDs with zero cells:                [none]
   IDs with augmented reference arm:   17 18 19 20 21 22 23 24 25 26 27 28
   - observations added:               0.00001
   - mean in augmented observations:   study-specific mean

Network information                    
   Components:                         1 (connected)
   D.f. for inconsistency:             8
   D.f. for heterogeneity:             15

Current data
   Data format:                        augmented
   Design variable:                    AAdesign
   Estimate variables:                 AAy*
   Variance variables:                 AAS*
   Command to list the data:           list study AAy* AAS*, noo sepby(AAdesign
> )

. network meta i
Command is: mvmeta AAy AAS , bscovariance(exch 0.5) longparm suppress(uv mm) eq
> (AAy_C: des_ACH, AAy_D: des_AD, AAy_F: des_BF, AAy_G: des_BG des_CG, AAy_H: d
> es_AH des_BH des_CH) vars(AAy_B AAy_C AAy_D AAy_E AAy_F AAy_G AAy_H)
Note: using method reml
Note: regressing AAy_B on (nothing)
Note: regressing AAy_C on des_ACH
Note: regressing AAy_D on des_AD
Note: regressing AAy_E on (nothing)
Note: regressing AAy_F on des_BF
Note: regressing AAy_G on des_BG des_CG
Note: regressing AAy_H on des_AH des_BH des_CH
Note: 28 observations on 7 variables
Note: variance-covariance matrix is proportional to .5*I(7)+.5*J(7,7,1)

initial:       log likelihood = -117.92653
rescale:       log likelihood =  -114.1119
rescale eq:    log likelihood =  -111.8201
Iteration 0:   log likelihood =  -111.8201  
Iteration 1:   log likelihood = -111.50542  
Iteration 2:   log likelihood = -111.49879  
Iteration 3:   log likelihood = -111.49222  
Iteration 4:   log likelihood = -111.49218  
Iteration 5:   log likelihood = -111.49218  

Multivariate meta-analysis
Variance-covariance matrix = proportional .5*I(7)+.5*J(7,7,1)
Method = reml                                  Number of dimensions    =     7
Restricted log likelihood = -111.49218         Number of observations  =    28
------------------------------------------------------------------------------
             |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
AAy_B        |
       _cons |  -.1570566   .2210417    -0.71   0.477    -.5902904    .2761773
-------------+----------------------------------------------------------------
AAy_C        |
     des_ACH |   .1590951   .3191612     0.50   0.618    -.4664493    .7846396
       _cons |   -.185097   .2319909    -0.80   0.425    -.6397908    .2695968
-------------+----------------------------------------------------------------
AAy_D        |
      des_AD |     .45014   .7288921     0.62   0.537    -.9784622    1.878742
       _cons |  -.0446749   .2207029    -0.20   0.840    -.4772447    .3878949
-------------+----------------------------------------------------------------
AAy_E        |
       _cons |  -.1516215   .3153228    -0.48   0.631    -.7696428    .4663997
-------------+----------------------------------------------------------------
AAy_F        |
      des_BF |  -.1835905   .3961029    -0.46   0.643    -.9599379    .5927568
       _cons |  -.0603276   .2333211    -0.26   0.796    -.5176285    .3969733
-------------+----------------------------------------------------------------
AAy_G        |
      des_BG |   .3279506   .7117498     0.46   0.645    -1.067053    1.722955
      des_CG |  -.1097434   .6948442    -0.16   0.875    -1.471613    1.252126
       _cons |  -.3462582   .5475069    -0.63   0.527    -1.419352    .7268356
-------------+----------------------------------------------------------------
AAy_H        |
      des_AH |  -.0585379   .4095562    -0.14   0.886    -.8612533    .7441775
      des_BH |    1.20477   .5346788     2.25   0.024     .1568188    2.252721
      des_CH |  -.4653832   .5027691    -0.93   0.355    -1.450793    .5200261
       _cons |  -.0048226   .2191572    -0.02   0.982    -.4343629    .4247177
------------------------------------------------------------------------------

Estimated between-studies SDs and correlation matrix:
              SD      AAy_B      AAy_C      AAy_D      AAy_E      AAy_F
AAy_B  .21561476          1          .          .          .          .
AAy_C  .21561476         .5          1          .          .          .
AAy_D  .21561476         .5         .5          1          .          .
AAy_E  .21561476         .5         .5         .5          1          .
AAy_F  .21561476         .5         .5         .5         .5          1
AAy_G  .21561476         .5         .5         .5         .5         .5
AAy_H  .21561476         .5         .5         .5         .5         .5

           AAy_G      AAy_H
AAy_B          .          .
AAy_C          .          .
AAy_D          .          .
AAy_E          .          .
AAy_F          .          .
AAy_G          1          .
AAy_H         .5          1

Testing for inconsistency:
 ( 1)  [AAy_C]des_ACH = 0
 ( 2)  [AAy_D]des_AD = 0
 ( 3)  [AAy_H]des_AH = 0
 ( 4)  [AAy_F]des_BF = 0
 ( 5)  [AAy_G]des_BG = 0
 ( 6)  [AAy_H]des_BH = 0
 ( 7)  [AAy_G]des_CG = 0
 ( 8)  [AAy_H]des_CH = 0

           chi2(  8) =    8.60
         Prob > chi2 =    0.3767
mvmeta command stored as F9; test command stored as F8

. local test1 = r(chi2)

. network unset

. drop AAdesign

. rename study myid

. rename (AAy*) (b*)

. rename (AAS*) (V*)

. network import, studyvar(myid) effect(b) variance(V) ref(A)
Importing from augmented format
Found treatments: A (ref) B C D E F G H

. network meta i
Warning: can't check for disconnected network
Warning: can't check df for inconsistency
Warning: can't check df for heterogeneity
Command is: mvmeta b V , bscovariance(exch 0.5) longparm suppress(uv mm) eq(b_C
> : des_ACH, b_D: des_AD, b_F: des_BF, b_G: des_BG des_CG, b_H: des_AH des_BH d
> es_CH) vars(b_B b_C b_D b_E b_F b_G b_H)
Note: using method reml
Note: regressing b_B on (nothing)
Note: regressing b_C on des_ACH
Note: regressing b_D on des_AD
Note: regressing b_E on (nothing)
Note: regressing b_F on des_BF
Note: regressing b_G on des_BG des_CG
Note: regressing b_H on des_AH des_BH des_CH
Note: 28 observations on 7 variables
Note: variance-covariance matrix is proportional to .5*I(7)+.5*J(7,7,1)

initial:       log likelihood = -117.92653
rescale:       log likelihood =  -114.1119
rescale eq:    log likelihood =  -111.8201
Iteration 0:   log likelihood =  -111.8201  
Iteration 1:   log likelihood = -111.50542  
Iteration 2:   log likelihood = -111.49879  
Iteration 3:   log likelihood = -111.49222  
Iteration 4:   log likelihood = -111.49218  
Iteration 5:   log likelihood = -111.49218  

Multivariate meta-analysis
Variance-covariance matrix = proportional .5*I(7)+.5*J(7,7,1)
Method = reml                                  Number of dimensions    =     7
Restricted log likelihood = -111.49218         Number of observations  =    28
------------------------------------------------------------------------------
             |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
b_B          |
       _cons |  -.1570566   .2210417    -0.71   0.477    -.5902904    .2761773
-------------+----------------------------------------------------------------
b_C          |
     des_ACH |   .1590951   .3191612     0.50   0.618    -.4664493    .7846396
       _cons |   -.185097   .2319909    -0.80   0.425    -.6397908    .2695968
-------------+----------------------------------------------------------------
b_D          |
      des_AD |     .45014   .7288921     0.62   0.537    -.9784622    1.878742
       _cons |  -.0446749   .2207029    -0.20   0.840    -.4772447    .3878949
-------------+----------------------------------------------------------------
b_E          |
       _cons |  -.1516215   .3153228    -0.48   0.631    -.7696428    .4663997
-------------+----------------------------------------------------------------
b_F          |
      des_BF |  -.1835905   .3961029    -0.46   0.643    -.9599379    .5927568
       _cons |  -.0603276   .2333211    -0.26   0.796    -.5176285    .3969733
-------------+----------------------------------------------------------------
b_G          |
      des_BG |   .3279506   .7117498     0.46   0.645    -1.067053    1.722955
      des_CG |  -.1097434   .6948442    -0.16   0.875    -1.471613    1.252126
       _cons |  -.3462582   .5475069    -0.63   0.527    -1.419352    .7268356
-------------+----------------------------------------------------------------
b_H          |
      des_AH |  -.0585379   .4095562    -0.14   0.886    -.8612533    .7441775
      des_BH |    1.20477   .5346788     2.25   0.024     .1568188    2.252721
      des_CH |  -.4653832   .5027691    -0.93   0.355    -1.450793    .5200261
       _cons |  -.0048226   .2191572    -0.02   0.982    -.4343629    .4247177
------------------------------------------------------------------------------

Estimated between-studies SDs and correlation matrix:
            SD        b_B        b_C        b_D        b_E        b_F
b_B  .21561476          1          .          .          .          .
b_C  .21561476         .5          1          .          .          .
b_D  .21561476         .5         .5          1          .          .
b_E  .21561476         .5         .5         .5          1          .
b_F  .21561476         .5         .5         .5         .5          1
b_G  .21561476         .5         .5         .5         .5         .5
b_H  .21561476         .5         .5         .5         .5         .5

           b_G        b_H
b_B          .          .
b_C          .          .
b_D          .          .
b_E          .          .
b_F          .          .
b_G          1          .
b_H         .5          1

Testing for inconsistency:
 ( 1)  [b_C]des_ACH = 0
 ( 2)  [b_D]des_AD = 0
 ( 3)  [b_H]des_AH = 0
 ( 4)  [b_F]des_BF = 0
 ( 5)  [b_G]des_BG = 0
 ( 6)  [b_H]des_BH = 0
 ( 7)  [b_G]des_CG = 0
 ( 8)  [b_H]des_CH = 0

           chi2(  8) =    8.60
         Prob > chi2 =    0.3767
mvmeta command stored as F9; test command stored as F8

. local test2 = r(chi2)

. di `test1', `test2'
8.6045213 8.6045213

. assert abs(`test2'/`test1'-1) < 1E-10 

. 
. // CHECK NETWORK IMPORT FROM PAIRS FORMAT
. 
. * CHECK REF() OPTION
. use "coronary artery disease pairwise", clear

.         * treatments are strings
. network import, tr(t1 t2) eff(logOR) study(study) stderr(se) ref(BMS)
Importing from pairs format
Reference treatment: BMS
All treatments: BMS DES MT PTCA

. network meta c
Warning: can't check for disconnected network
Warning: can't check df for inconsistency
Warning: can't check df for heterogeneity
Command is: metareg logOR _trtdiff_DES _trtdiff_MT _trtdiff_PTCA , wsse(selogOR
> ) noconstant

Meta-regression                                       Number of obs  =      62
REML estimate of between-study variance               tau2           =       0
% residual variation due to heterogeneity             I-squared_res  =   0.00%
Joint test for all covariates                         Model F(3,59)  =    0.32
With Knapp-Hartung modification                       Prob > F       =  0.8126
------------------------------------------------------------------------------
       logOR |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
_trtdiff_DES |  -.0804465   .2060468    -0.39   0.698    -.4927452    .3318523
 _trtdiff_MT |  -.0804069   .0995168    -0.81   0.422    -.2795396    .1187259
_trtdiff_P~A |   .0007112   .1243693     0.01   0.995    -.2481513    .2495737
------------------------------------------------------------------------------
mvmeta command stored as F9

. local b1 = _b[_trtdiff_PTCA]

. 
. use "coronary artery disease pairwise", clear

. network import, tr(t1 t2) eff(logOR) study(study) stderr(se) ref(PTCA)
Importing from pairs format
Reference treatment: PTCA
All treatments: BMS DES MT PTCA

. network meta c
Warning: can't check for disconnected network
Warning: can't check df for inconsistency
Warning: can't check df for heterogeneity
Command is: metareg logOR _trtdiff_BMS _trtdiff_DES _trtdiff_MT , wsse(selogOR)
>  noconstant

Meta-regression                                       Number of obs  =      62
REML estimate of between-study variance               tau2           =       0
% residual variation due to heterogeneity             I-squared_res  =   0.00%
Joint test for all covariates                         Model F(3,59)  =    0.32
With Knapp-Hartung modification                       Prob > F       =  0.8126
------------------------------------------------------------------------------
       logOR |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
_trtdiff_BMS |  -.0007112   .1243693    -0.01   0.995    -.2495737    .2481513
_trtdiff_DES |  -.0811577    .240672    -0.34   0.737    -.5627413     .400426
 _trtdiff_MT |  -.0811181   .1219894    -0.66   0.509    -.3252183    .1629822
------------------------------------------------------------------------------
mvmeta command stored as F9

. assert reldif(-`b1', _b[_trtdiff_BMS]) < 1E-6

. 
. * HANDLE LABELLED NUMERIC TREATMENTS
. use "coronary artery disease pairwise", clear

. reshape long t, i(study) j(arm)
(note: j = 1 2)

Data                               wide   ->   long
-----------------------------------------------------------------------------
Number of obs.                       62   ->     124
Number of variables                   5   ->       5
j variable (2 values)                     ->   arm
xij variables:
                                  t1 t2   ->   t
-----------------------------------------------------------------------------

. encode t, gen(trt)

. drop t

. reshape wide trt, i(study) j(arm)
(note: j = 1 2)

Data                               long   ->   wide
-----------------------------------------------------------------------------
Number of obs.                      124   ->      62
Number of variables                   5   ->       5
j variable (2 values)               arm   ->   (dropped)
xij variables:
                                    trt   ->   trt1 trt2
-----------------------------------------------------------------------------

. * treatments are now labelled numeric
. network import, tr(trt1 trt2) eff(logOR) study(study) stderr(se) ref(BMS)
Importing from pairs format
Converted trt1 and trt2 to string
Reference treatment: BMS
All treatments: BMS DES MT PTCA

. network meta c
Warning: can't check for disconnected network
Warning: can't check df for inconsistency
Warning: can't check df for heterogeneity
Command is: metareg logOR _trtdiff_DES _trtdiff_MT _trtdiff_PTCA , wsse(selogOR
> ) noconstant

Meta-regression                                       Number of obs  =      62
REML estimate of between-study variance               tau2           =       0
% residual variation due to heterogeneity             I-squared_res  =   0.00%
Joint test for all covariates                         Model F(3,59)  =    0.32
With Knapp-Hartung modification                       Prob > F       =  0.8126
------------------------------------------------------------------------------
       logOR |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
_trtdiff_DES |  -.0804465   .2060468    -0.39   0.698    -.4927452    .3318523
 _trtdiff_MT |  -.0804069   .0995168    -0.81   0.422    -.2795396    .1187259
_trtdiff_P~A |   .0007112   .1243693     0.01   0.995    -.2481513    .2495737
------------------------------------------------------------------------------
mvmeta command stored as F9

. assert reldif(`b1', _b[_trtdiff_PTCA]) < 1E-6

. 
. * HANDLE UNLABELLED NUMERIC TREATMENTS
. use "coronary artery disease pairwise", clear

. reshape long t, i(study) j(arm)
(note: j = 1 2)

Data                               wide   ->   long
-----------------------------------------------------------------------------
Number of obs.                       62   ->     124
Number of variables                   5   ->       5
j variable (2 values)                     ->   arm
xij variables:
                                  t1 t2   ->   t
-----------------------------------------------------------------------------

. encode t, gen(trt)

. drop t

. label val trt 

. reshape wide trt, i(study) j(arm)
(note: j = 1 2)

Data                               long   ->   wide
-----------------------------------------------------------------------------
Number of obs.                      124   ->      62
Number of variables                   5   ->       5
j variable (2 values)               arm   ->   (dropped)
xij variables:
                                    trt   ->   trt1 trt2
-----------------------------------------------------------------------------

. * treatments are now unlabelled numeric
. network import, tr(trt1 trt2) eff(logOR) study(study) stderr(se) ref(1)
Importing from pairs format
Converted trt1 and trt2 to string
Reference treatment: 1
All treatments: 1 2 3 4

. network meta c
Warning: can't check for disconnected network
Warning: can't check df for inconsistency
Warning: can't check df for heterogeneity
Command is: metareg logOR _trtdiff_2 _trtdiff_3 _trtdiff_4 , wsse(selogOR) noco
> nstant

Meta-regression                                       Number of obs  =      62
REML estimate of between-study variance               tau2           =       0
% residual variation due to heterogeneity             I-squared_res  =   0.00%
Joint test for all covariates                         Model F(3,59)  =    0.32
With Knapp-Hartung modification                       Prob > F       =  0.8126
------------------------------------------------------------------------------
       logOR |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
  _trtdiff_2 |  -.0804465   .2060468    -0.39   0.698    -.4927452    .3318523
  _trtdiff_3 |  -.0804069   .0995168    -0.81   0.422    -.2795396    .1187259
  _trtdiff_4 |   .0007112   .1243693     0.01   0.995    -.2481513    .2495737
------------------------------------------------------------------------------
mvmeta command stored as F9

. assert reldif(`b1', _b[_trtdiff_4]) < 1E-6

. 
. * HANDLE MULTI-ARM STUDIES
. use "coronary artery disease pairwise", clear

. sort study

. replace study = 17 if inlist(study,50,59)
(2 real changes made)

. network import, tr(t1 t2) eff(logOR) study(study) stderr(se) 
Importing from pairs format
Reference treatment: BMS
All treatments: BMS DES MT PTCA

. cap network meta c

. assert _rc==498

. network meta c, force
Warning: can't check for disconnected network
Warning: can't check df for inconsistency
Warning: can't check df for heterogeneity
The data contain multi-arm trials - this analysis in pairs format is wrong
Command is: metareg logOR _trtdiff_DES _trtdiff_MT _trtdiff_PTCA , wsse(selogOR
> ) noconstant

Meta-regression                                       Number of obs  =      62
REML estimate of between-study variance               tau2           =       0
% residual variation due to heterogeneity             I-squared_res  =   0.00%
Joint test for all covariates                         Model F(3,59)  =    0.32
With Knapp-Hartung modification                       Prob > F       =  0.8126
------------------------------------------------------------------------------
       logOR |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
_trtdiff_DES |  -.0804465   .2060468    -0.39   0.698    -.4927452    .3318523
 _trtdiff_MT |  -.0804069   .0995168    -0.81   0.422    -.2795396    .1187259
_trtdiff_P~A |   .0007112   .1243693     0.01   0.995    -.2481513    .2495737
------------------------------------------------------------------------------
mvmeta command stored as F9

. 
. * DETECT MULTI-ARM STUDIES WITH SOME CONTRASTS DUPLICATED
. use "coronary artery disease pairwise", clear

. replace study = 2 if study==1
(1 real change made)

. cap noi network import, tr(t1 t2) eff(logOR) study(study) stderr(se) 
Importing from pairs format
Reference treatment: BMS
All treatments: BMS DES MT PTCA
Error: one or more contrasts is duplicated in the studies listed

Duplicates in terms of study _contrast

  +--------------------------+
  | obs:   study   _contrast |
  |--------------------------|
  |    1       2   DES - BMS |
  |    2       2   DES - BMS |
  +--------------------------+

. assert _rc==498

. 
. * DETECT MULTI-ARM STUDIES WITH SOME CONTRASTS MISSING
. use "coronary artery disease pairwise", clear

. replace study = 17 if inlist(study,50)
(1 real change made)

. l if study == 17

     +--------------------------------------------+
     | study     t1     t2       logOR    selogOR |
     |--------------------------------------------|
 21. |    17     MT   PTCA   -.0214601   .2253973 |
 51. |    17   PTCA    BMS   -.1596448   .6129748 |
     +--------------------------------------------+

. cap noi network import, tr(t1 t2) eff(logOR) study(study) stderr(se) 
Importing from pairs format
Reference treatment: BMS
All treatments: BMS DES MT PTCA
Error: there are missing contrasts in the studies listed

     +-----------------------------------------------+
     | study       _design     t1     t2       logOR |
     |-----------------------------------------------|
 17. |    17   BMS MT PTCA     MT   PTCA   -.0214601 |
 18. |    17   BMS MT PTCA   PTCA    BMS   -.1596448 |
     +-----------------------------------------------+

. assert _rc==498

. 
. * HANDLE NESTED TREATMENT NAMES
. use "coronary artery disease pairwise", clear

. replace t1="BMSX" if t1=="PTCA"
(33 real changes made)

. replace t2="BMSX" if t2=="PTCA"
(10 real changes made)

. network import, tr(t1 t2) eff(logOR) study(study) stderr(se)
Importing from pairs format
Reference treatment: BMS
All treatments: BMS BMSX DES MT

. network meta c
Warning: can't check for disconnected network
Warning: can't check df for inconsistency
Warning: can't check df for heterogeneity
Command is: metareg logOR _trtdiff_BMSX _trtdiff_DES _trtdiff_MT , wsse(selogOR
> ) noconstant

Meta-regression                                       Number of obs  =      62
REML estimate of between-study variance               tau2           =       0
% residual variation due to heterogeneity             I-squared_res  =   0.00%
Joint test for all covariates                         Model F(3,59)  =    0.32
With Knapp-Hartung modification                       Prob > F       =  0.8126
------------------------------------------------------------------------------
       logOR |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
_trtdiff_B~X |   .0007112   .1243693     0.01   0.995    -.2481513    .2495737
_trtdiff_DES |  -.0804465   .2060468    -0.39   0.698    -.4927452    .3318523
 _trtdiff_MT |  -.0804069   .0995168    -0.81   0.422    -.2795396    .1187259
------------------------------------------------------------------------------
mvmeta command stored as F9

. assert reldif(`b1', _b[_trtdiff_BMSX]) < 1E-6

. 
. // END OF CHECKING NETWORK IMPORT FROM PAIRS FORMAT
. 
. 
. // Compare meta results between different formats, both CE and RE models
. use smoking, clear
(Smoking data from Lu & Ades (2006))

. drop if study<3 // makes mvmeta valid in all formats
(6 observations deleted)

. network setup d n, studyvar(stud) trtvar(trt) 
Treatments used
   A (reference):                      No contact
   B:                                  Self help
   C:                                  Individual counselling
   D:                                  Group counselling

Measure                                Log odds ratio

Studies
   ID variable:                        study
   Number used:                        22
   IDs with zero cells:                9 20
   - count added to all their cells:   .5
   IDs with augmented reference arm:   21 22 23 24
   - observations added:               0.00001
   - mean in augmented observations:   study-specific mean

Network information                    
   Components:                         1 (connected)
   D.f. for inconsistency:             3
   D.f. for heterogeneity:             16

Current data
   Data format:                        augmented
   Design variable:                    _design
   Estimate variables:                 _y*
   Variance variables:                 _S*
   Command to list the data:           list study _y* _S*, noo sepby(_design)

. foreach opt in "fixed" " " {
  2.         network convert aug
  3.         network meta c, `opt'
  4.         local baug = [_y_B][_cons]
  5.         
.         network convert sta
  6.         network meta c, `opt'
  7.         local bsta = _b[_trtdiff1_B]
  8.         
.         di reldif(`baug',`bsta')
  9.         assert reldif(`baug',`bsta')<1E-5
 10. 
.         network convert pairs
 11.         network meta c, `opt'
 12.         local bpai = _b[_trtdiff_B]
 13. 
.         di reldif(`baug',`bpai')
 14.         assert reldif(`baug',`bpai')<1E-5
 15. }
Data are already in augmented format
Command is: mvmeta _y _S , fixed longparm suppress(uv mm) vars(_y_B _y_C _y_D)
Note: using method fixed
Note: using variables _y_B _y_C _y_D
Note: 22 observations on 3 variables

Multivariate meta-analysis
Variance-covariance matrix = (none)
Method = fixed                                 Number of dimensions    =     3
                                               Number of observations  =    22
------------------------------------------------------------------------------
             |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
_y_B         |
       _cons |   .1984961   .1319389     1.50   0.132    -.0600994    .4570917
-------------+----------------------------------------------------------------
_y_C         |
       _cons |   .6361874   .0600489    10.59   0.000     .5184938    .7538811
-------------+----------------------------------------------------------------
_y_D         |
       _cons |   1.203067   .2808497     4.28   0.000     .6526115    1.753522
------------------------------------------------------------------------------
mvmeta command stored as F9
Converting augmented to standard ...
Command is: mvmeta _y _S , fixed commonparm noconstant suppress(uv mm) eq(_y_1:
>  _trtdiff1_B _trtdiff1_C _trtdiff1_D) vars(_y_1)
Note: using method fixed
Note: regressing _y_1 on _trtdiff1_B _trtdiff1_C _trtdiff1_D
Note: 22 observations on 1 variables

Multivariate meta-analysis
Variance-covariance matrix = (none)
Method = fixed                                 Number of dimensions    =     1
                                               Number of observations  =    22
------------------------------------------------------------------------------
             |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
_y_1         |
 _trtdiff1_B |   .1984962   .1319389     1.50   0.132    -.0600994    .4570917
 _trtdiff1_C |   .6361875   .0600489    10.59   0.000     .5184938    .7538811
 _trtdiff1_D |   1.203067   .2808497     4.28   0.000     .6526117    1.753522
------------------------------------------------------------------------------
mvmeta command stored as F9
2.614e-08
Converting standard to pairs ...
Command is: vwls _y _trtdiff_B _trtdiff_C _trtdiff_D , sd(_stderr) noconstant

Variance-weighted least-squares regression      Number of obs     =         22
Goodness-of-fit chi2(19)   =  193.73            Model chi2(3)     =     120.41
Prob > chi2                =  0.0000            Prob > chi2       =     0.0000
------------------------------------------------------------------------------
          _y |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
  _trtdiff_B |   .1984962   .1319389     1.50   0.132    -.0600994    .4570917
  _trtdiff_C |   .6361875   .0600489    10.59   0.000     .5184938    .7538811
  _trtdiff_D |   1.203067   .2808497     4.28   0.000     .6526117    1.753522
------------------------------------------------------------------------------
mvmeta command stored as F9
2.614e-08
Converting pairs to augmented ...
Command is: mvmeta _y _S , bscovariance(exch 0.5) longparm suppress(uv mm) vars
> (_y_B _y_C _y_D)
Note: using method reml
Note: using variables _y_B _y_C _y_D
Note: 22 observations on 3 variables
Note: variance-covariance matrix is proportional to .5*I(3)+.5*J(3,3,1)

initial:       log likelihood =  -56.08237
rescale:       log likelihood =  -56.08237
rescale eq:    log likelihood =  -56.08237
Iteration 0:   log likelihood =  -56.08237  
Iteration 1:   log likelihood = -55.035848  
Iteration 2:   log likelihood = -55.009225  
Iteration 3:   log likelihood = -55.009068  
Iteration 4:   log likelihood = -55.009068  

Multivariate meta-analysis
Variance-covariance matrix = proportional .5*I(3)+.5*J(3,3,1)
Method = reml                                  Number of dimensions    =     3
Restricted log likelihood = -55.009068         Number of observations  =    22
------------------------------------------------------------------------------
             |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
_y_B         |
       _cons |   .4227364   .3745024     1.13   0.259    -.3112748    1.156748
-------------+----------------------------------------------------------------
_y_C         |
       _cons |   .7118538   .2172659     3.28   0.001     .2860205    1.137687
-------------+----------------------------------------------------------------
_y_D         |
       _cons |   1.347197   .5222318     2.58   0.010     .3236418    2.370753
------------------------------------------------------------------------------

Estimated between-studies SDs and correlation matrix:
             SD       _y_B       _y_C       _y_D
_y_B  .70636072          1          .          .
_y_C  .70636072         .5          1          .
_y_D  .70636072         .5         .5          1
mvmeta command stored as F9
Converting augmented to standard ...
Command is: mvmeta _y _S , bscovariance(exch 0.5) commonparm noconstant suppres
> s(uv mm) eq(_y_1: _trtdiff1_B _trtdiff1_C _trtdiff1_D) vars(_y_1)
Note: using method reml
Note: regressing _y_1 on _trtdiff1_B _trtdiff1_C _trtdiff1_D
Note: 22 observations on 1 variables
Note: variance-covariance matrix is proportional to .5*I(1)+.5*J(1,1,1)

initial:       log likelihood = -29.380734
rescale:       log likelihood = -29.380734
rescale eq:    log likelihood = -29.380734
Iteration 0:   log likelihood = -29.380734  
Iteration 1:   log likelihood = -28.334223  
Iteration 2:   log likelihood = -28.307455  
Iteration 3:   log likelihood = -28.307443  
Iteration 4:   log likelihood = -28.307443  

Multivariate meta-analysis
Variance-covariance matrix = proportional .5*I(1)+.5*J(1,1,1)
Method = reml                                  Number of dimensions    =     1
Restricted log likelihood = -28.307443         Number of observations  =    22
------------------------------------------------------------------------------
             |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
_y_1         |
 _trtdiff1_B |   .4227379   .3745031     1.13   0.259    -.3112747    1.156751
 _trtdiff1_C |   .7118549   .2172664     3.28   0.001     .2860206    1.137689
 _trtdiff1_D |     1.3472   .5222329     2.58   0.010     .3236425    2.370758
------------------------------------------------------------------------------

Estimated between-studies SDs and correlation matrix:
             SD       _y_1
_y_1  .70636161          1
mvmeta command stored as F9
1.094e-06
Converting standard to pairs ...
Command is: metareg _y _trtdiff_B _trtdiff_C _trtdiff_D , wsse(_stderr) noconst
> ant

Meta-regression                                       Number of obs  =      22
REML estimate of between-study variance               tau2           =   .4989
% residual variation due to heterogeneity             I-squared_res  =  90.19%
Joint test for all covariates                         Model F(3,19)  =    4.35
With Knapp-Hartung modification                       Prob > F       =  0.0172
------------------------------------------------------------------------------
          _y |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
  _trtdiff_B |   .4227379   .3893297     1.09   0.291    -.3921385    1.237614
  _trtdiff_C |   .7118549   .2219591     3.21   0.005     .2472891    1.176421
  _trtdiff_D |     1.3472   .5414388     2.49   0.022     .2139556    2.480445
------------------------------------------------------------------------------
mvmeta command stored as F9
1.094e-06

. 
. 
. * Check other effect measures
. foreach measure in rr or rd hr {
  2.         use thromb, clear
  3.         keep study treat r n
  4.     network setup r n, studyvar(stud) trtvar(treat) `measure'
  5.     network meta c
  6.         network compare
  7.     network meta i
  8.     network forest, name(`measure', replace)
  9. } 
(Thrombolytics network meta-analysis from Lu & Ades (2006), corrected)
Treatments used
   A (reference):                      A
   B:                                  B
   C:                                  C
   D:                                  D
   E:                                  E
   F:                                  F
   G:                                  G
   H:                                  H

Measure                                Log risk ratio

Studies
   ID variable:                        study
   Number used:                        28
   IDs with zero cells:                [none]
   IDs with augmented reference arm:   17 18 19 20 21 22 23 24 25 26 27 28
   - observations added:               0.00001
   - mean in augmented observations:   study-specific mean

Network information                    
   Components:                         1 (connected)
   D.f. for inconsistency:             8
   D.f. for heterogeneity:             15

Current data
   Data format:                        augmented
   Design variable:                    _design
   Estimate variables:                 _y*
   Variance variables:                 _S*
   Command to list the data:           list study _y* _S*, noo sepby(_design)
Command is: mvmeta _y _S , bscovariance(exch 0.5) longparm suppress(uv mm) vars
> (_y_B _y_C _y_D _y_E _y_F _y_G _y_H)
Note: using method reml
Note: using variables _y_B _y_C _y_D _y_E _y_F _y_G _y_H
Note: 28 observations on 7 variables
Note: variance-covariance matrix is proportional to .5*I(7)+.5*J(7,7,1)

initial:       log likelihood = -127.00526
rescale:       log likelihood = -115.41956
rescale eq:    log likelihood = -113.43202
Iteration 0:   log likelihood = -113.43202  
Iteration 1:   log likelihood = -113.29141  
Iteration 2:   log likelihood = -113.26973  
Iteration 3:   log likelihood = -113.26622  
Iteration 4:   log likelihood = -113.26598  
Iteration 5:   log likelihood = -113.26598  

Multivariate meta-analysis
Variance-covariance matrix = proportional .5*I(7)+.5*J(7,7,1)
Method = reml                                  Number of dimensions    =     7
Restricted log likelihood = -113.26598         Number of observations  =    28
------------------------------------------------------------------------------
             |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
_y_B         |
       _cons |  -.1491226   .0431148    -3.46   0.001     -.233626   -.0646192
-------------+----------------------------------------------------------------
_y_C         |
       _cons |   .0018144   .0295291     0.06   0.951    -.0560617    .0596904
-------------+----------------------------------------------------------------
_y_D         |
       _cons |  -.0403396   .0454334    -0.89   0.375    -.1293874    .0487083
-------------+----------------------------------------------------------------
_y_E         |
       _cons |  -.1440227   .0751988    -1.92   0.055    -.2914095    .0033642
-------------+----------------------------------------------------------------
_y_F         |
       _cons |  -.1031412   .0569111    -1.81   0.070     -.214685    .0084026
-------------+----------------------------------------------------------------
_y_G         |
       _cons |  -.1840639   .2105389    -0.87   0.382    -.5967126    .2285848
-------------+----------------------------------------------------------------
_y_H         |
       _cons |   .0123556   .0363735     0.34   0.734    -.0589352    .0836464
------------------------------------------------------------------------------

Estimated between-studies SDs and correlation matrix:
             SD       _y_B       _y_C       _y_D       _y_E       _y_F
_y_B  .01429047          1          .          .          .          .
_y_C  .01429047         .5          1          .          .          .
_y_D  .01429047         .5         .5          1          .          .
_y_E  .01429047         .5         .5         .5          1          .
_y_F  .01429047         .5         .5         .5         .5          1
_y_G  .01429047         .5         .5         .5         .5         .5
_y_H  .01429047         .5         .5         .5         .5         .5

           _y_G       _y_H
_y_B          .          .
_y_C          .          .
_y_D          .          .
_y_E          .          .
_y_F          .          .
_y_G          1          .
_y_H         .5          1
mvmeta command stored as F9
Table of log risk ratio and its standard error for Treatment vs. Comparator:
---------------------------------------------------------------------------
           |                           Treatment                           
Comparator |      A       B       C       D       E       F       G       H
-----------+---------------------------------------------------------------
         A |         -0.149   0.002  -0.040  -0.144  -0.103  -0.184   0.012
           |          0.043   0.030   0.045   0.075   0.057   0.211   0.036
           | 
         B |  0.149           0.151   0.109   0.005   0.046  -0.035   0.161
           |  0.043           0.052   0.052   0.062   0.052   0.212   0.057
           | 
         C | -0.002  -0.151          -0.042  -0.146  -0.105  -0.186   0.011
           |  0.030   0.052           0.054   0.081   0.064   0.211   0.036
           | 
         D |  0.040  -0.109   0.042          -0.104  -0.063  -0.144   0.053
           |  0.045   0.052   0.054           0.081   0.068   0.214   0.058
           | 
         E |  0.144  -0.005   0.146   0.104           0.041  -0.040   0.156
           |  0.075   0.062   0.081   0.081           0.081   0.220   0.084
           | 
         F |  0.103  -0.046   0.105   0.063  -0.041          -0.081   0.115
           |  0.057   0.052   0.064   0.068   0.081           0.216   0.068
           | 
         G |  0.184   0.035   0.186   0.144   0.040   0.081           0.196
           |  0.211   0.212   0.211   0.214   0.220   0.216           0.213
           | 
         H | -0.012  -0.161  -0.011  -0.053  -0.156  -0.115  -0.196        
           |  0.036   0.057   0.036   0.058   0.084   0.068   0.213        
---------------------------------------------------------------------------
Command is: mvmeta _y _S , bscovariance(exch 0.5) longparm suppress(uv mm) eq(_
> y_C: des_ACH, _y_D: des_AD, _y_F: des_BF, _y_G: des_BG des_CG, _y_H: des_AH d
> es_BH des_CH) vars(_y_B _y_C _y_D _y_E _y_F _y_G _y_H)
Note: using method reml
Note: regressing _y_B on (nothing)
Note: regressing _y_C on des_ACH
Note: regressing _y_D on des_AD
Note: regressing _y_E on (nothing)
Note: regressing _y_F on des_BF
Note: regressing _y_G on des_BG des_CG
Note: regressing _y_H on des_AH des_BH des_CH
Note: 28 observations on 7 variables
Note: variance-covariance matrix is proportional to .5*I(7)+.5*J(7,7,1)

initial:       log likelihood = -116.86591
rescale:       log likelihood = -112.69538
rescale eq:    log likelihood = -110.20781
Iteration 0:   log likelihood = -110.20781  
Iteration 1:   log likelihood = -109.87673  
Iteration 2:   log likelihood = -109.85819  (not concave)
Iteration 3:   log likelihood = -109.85016  
Iteration 4:   log likelihood = -109.84471  
Iteration 5:   log likelihood = -109.84471  

Multivariate meta-analysis
Variance-covariance matrix = proportional .5*I(7)+.5*J(7,7,1)
Method = reml                                  Number of dimensions    =     7
Restricted log likelihood = -109.84471         Number of observations  =    28
------------------------------------------------------------------------------
             |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
_y_B         |
       _cons |  -.1463944   .2068521    -0.71   0.479    -.5518171    .2590283
-------------+----------------------------------------------------------------
_y_C         |
     des_ACH |   .1492679   .2999781     0.50   0.619    -.4386785    .7372142
       _cons |  -.1725556   .2191321    -0.79   0.431    -.6020466    .2569354
-------------+----------------------------------------------------------------
_y_D         |
      des_AD |   .4284277   .6939053     0.62   0.537    -.9316016    1.788457
       _cons |  -.0414817   .2064874    -0.20   0.841    -.4461895    .3632261
-------------+----------------------------------------------------------------
_y_E         |
       _cons |  -.1412945   .2951279    -0.48   0.632    -.7197346    .4371457
-------------+----------------------------------------------------------------
_y_F         |
      des_BF |  -.1722102   .3704324    -0.46   0.642    -.8982445     .553824
       _cons |  -.0547353   .2174056    -0.25   0.801    -.4808425    .3713719
-------------+----------------------------------------------------------------
_y_G         |
      des_BG |    .317895   .6756939     0.47   0.638    -1.006441    1.642231
      des_CG |  -.0970134   .6617946    -0.15   0.883    -1.394107     1.20008
       _cons |   -.331736   .5230693    -0.63   0.526    -1.356933     .693461
-------------+----------------------------------------------------------------
_y_H         |
      des_AH |  -.0568419   .3856669    -0.15   0.883    -.8127351    .6990512
      des_BH |   1.150409   .5089919     2.26   0.024     .1528034    2.148015
      des_CH |  -.4337905   .4705716    -0.92   0.357    -1.356094    .4885128
       _cons |  -.0043144    .204826    -0.02   0.983     -.405766    .3971371
------------------------------------------------------------------------------

Estimated between-studies SDs and correlation matrix:
             SD       _y_B       _y_C       _y_D       _y_E       _y_F
_y_B  .20179435          1          .          .          .          .
_y_C  .20179435         .5          1          .          .          .
_y_D  .20179435         .5         .5          1          .          .
_y_E  .20179435         .5         .5         .5          1          .
_y_F  .20179435         .5         .5         .5         .5          1
_y_G  .20179435         .5         .5         .5         .5         .5
_y_H  .20179435         .5         .5         .5         .5         .5

           _y_G       _y_H
_y_B          .          .
_y_C          .          .
_y_D          .          .
_y_E          .          .
_y_F          .          .
_y_G          1          .
_y_H         .5          1

Testing for inconsistency:
 ( 1)  [_y_C]des_ACH = 0
 ( 2)  [_y_D]des_AD = 0
 ( 3)  [_y_H]des_AH = 0
 ( 4)  [_y_F]des_BF = 0
 ( 5)  [_y_G]des_BG = 0
 ( 6)  [_y_H]des_BH = 0
 ( 7)  [_y_G]des_CG = 0
 ( 8)  [_y_H]des_CH = 0

           chi2(  8) =    8.58
         Prob > chi2 =    0.3787
mvmeta command stored as F9; test command stored as F8
(Thrombolytics network meta-analysis from Lu & Ades (2006), corrected)
Treatments used
   A (reference):                      A
   B:                                  B
   C:                                  C
   D:                                  D
   E:                                  E
   F:                                  F
   G:                                  G
   H:                                  H

Measure                                Log odds ratio

Studies
   ID variable:                        study
   Number used:                        28
   IDs with zero cells:                [none]
   IDs with augmented reference arm:   17 18 19 20 21 22 23 24 25 26 27 28
   - observations added:               0.00001
   - mean in augmented observations:   study-specific mean

Network information                    
   Components:                         1 (connected)
   D.f. for inconsistency:             8
   D.f. for heterogeneity:             15

Current data
   Data format:                        augmented
   Design variable:                    _design
   Estimate variables:                 _y*
   Variance variables:                 _S*
   Command to list the data:           list study _y* _S*, noo sepby(_design)
Command is: mvmeta _y _S , bscovariance(exch 0.5) longparm suppress(uv mm) vars
> (_y_B _y_C _y_D _y_E _y_F _y_G _y_H)
Note: using method reml
Note: using variables _y_B _y_C _y_D _y_E _y_F _y_G _y_H
Note: 28 observations on 7 variables
Note: variance-covariance matrix is proportional to .5*I(7)+.5*J(7,7,1)

initial:       log likelihood = -128.22249
rescale:       log likelihood = -117.53856
rescale eq:    log likelihood = -115.63531
Iteration 0:   log likelihood = -115.63531  
Iteration 1:   log likelihood =  -115.4644  
Iteration 2:   log likelihood = -115.45842  
Iteration 3:   log likelihood =  -115.4584  
Iteration 4:   log likelihood =  -115.4584  

Multivariate meta-analysis
Variance-covariance matrix = proportional .5*I(7)+.5*J(7,7,1)
Method = reml                                  Number of dimensions    =     7
Restricted log likelihood = -115.4584          Number of observations  =    28
------------------------------------------------------------------------------
             |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
_y_B         |
       _cons |  -.1612884   .0463903    -3.48   0.001    -.2522116   -.0703651
-------------+----------------------------------------------------------------
_y_C         |
       _cons |    .002128   .0324293     0.07   0.948    -.0614322    .0656882
-------------+----------------------------------------------------------------
_y_D         |
       _cons |  -.0438162   .0488541    -0.90   0.370    -.1395684    .0519361
-------------+----------------------------------------------------------------
_y_E         |
       _cons |  -.1558534   .0803896    -1.94   0.053    -.3134142    .0017074
-------------+----------------------------------------------------------------
_y_F         |
       _cons |  -.1130021   .0619122    -1.83   0.068    -.2343479    .0083436
-------------+----------------------------------------------------------------
_y_G         |
       _cons |  -.1972332   .2215627    -0.89   0.373     -.631488    .2370216
-------------+----------------------------------------------------------------
_y_H         |
       _cons |   .0143584    .040299     0.36   0.722    -.0646261    .0933429
------------------------------------------------------------------------------

Estimated between-studies SDs and correlation matrix:
             SD       _y_B       _y_C       _y_D       _y_E       _y_F
_y_B  .01520432          1          .          .          .          .
_y_C  .01520432         .5          1          .          .          .
_y_D  .01520432         .5         .5          1          .          .
_y_E  .01520432         .5         .5         .5          1          .
_y_F  .01520432         .5         .5         .5         .5          1
_y_G  .01520432         .5         .5         .5         .5         .5
_y_H  .01520432         .5         .5         .5         .5         .5

           _y_G       _y_H
_y_B          .          .
_y_C          .          .
_y_D          .          .
_y_E          .          .
_y_F          .          .
_y_G          1          .
_y_H         .5          1
mvmeta command stored as F9
Table of log odds ratio and its standard error for Treatment vs. Comparator:
---------------------------------------------------------------------------
           |                           Treatment                           
Comparator |      A       B       C       D       E       F       G       H
-----------+---------------------------------------------------------------
         A |         -0.161   0.002  -0.044  -0.156  -0.113  -0.197   0.014
           |          0.046   0.032   0.049   0.080   0.062   0.222   0.040
           | 
         B |  0.161           0.163   0.117   0.005   0.048  -0.036   0.176
           |  0.046           0.057   0.056   0.066   0.057   0.223   0.062
           | 
         C | -0.002  -0.163          -0.046  -0.158  -0.115  -0.199   0.012
           |  0.032   0.057           0.059   0.087   0.070   0.222   0.040
           | 
         D |  0.044  -0.117   0.046          -0.112  -0.069  -0.153   0.058
           |  0.049   0.056   0.059           0.086   0.073   0.226   0.063
           | 
         E |  0.156  -0.005   0.158   0.112           0.043  -0.041   0.170
           |  0.080   0.066   0.087   0.086           0.087   0.232   0.090
           | 
         F |  0.113  -0.048   0.115   0.069  -0.043          -0.084   0.127
           |  0.062   0.057   0.070   0.073   0.087           0.228   0.074
           | 
         G |  0.197   0.036   0.199   0.153   0.041   0.084           0.212
           |  0.222   0.223   0.222   0.226   0.232   0.228           0.224
           | 
         H | -0.014  -0.176  -0.012  -0.058  -0.170  -0.127  -0.212        
           |  0.040   0.062   0.040   0.063   0.090   0.074   0.224        
---------------------------------------------------------------------------
Command is: mvmeta _y _S , bscovariance(exch 0.5) longparm suppress(uv mm) eq(_
> y_C: des_ACH, _y_D: des_AD, _y_F: des_BF, _y_G: des_BG des_CG, _y_H: des_AH d
> es_BH des_CH) vars(_y_B _y_C _y_D _y_E _y_F _y_G _y_H)
Note: using method reml
Note: regressing _y_B on (nothing)
Note: regressing _y_C on des_ACH
Note: regressing _y_D on des_AD
Note: regressing _y_E on (nothing)
Note: regressing _y_F on des_BF
Note: regressing _y_G on des_BG des_CG
Note: regressing _y_H on des_AH des_BH des_CH
Note: 28 observations on 7 variables
Note: variance-covariance matrix is proportional to .5*I(7)+.5*J(7,7,1)

initial:       log likelihood = -117.92653
rescale:       log likelihood =  -114.1119
rescale eq:    log likelihood =  -111.8201
Iteration 0:   log likelihood =  -111.8201  
Iteration 1:   log likelihood = -111.50542  
Iteration 2:   log likelihood = -111.49879  
Iteration 3:   log likelihood = -111.49222  
Iteration 4:   log likelihood = -111.49218  
Iteration 5:   log likelihood = -111.49218  

Multivariate meta-analysis
Variance-covariance matrix = proportional .5*I(7)+.5*J(7,7,1)
Method = reml                                  Number of dimensions    =     7
Restricted log likelihood = -111.49218         Number of observations  =    28
------------------------------------------------------------------------------
             |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
_y_B         |
       _cons |  -.1570566   .2210417    -0.71   0.477    -.5902904    .2761773
-------------+----------------------------------------------------------------
_y_C         |
     des_ACH |   .1590951   .3191612     0.50   0.618    -.4664493    .7846396
       _cons |   -.185097   .2319909    -0.80   0.425    -.6397908    .2695968
-------------+----------------------------------------------------------------
_y_D         |
      des_AD |     .45014   .7288921     0.62   0.537    -.9784622    1.878742
       _cons |  -.0446749   .2207029    -0.20   0.840    -.4772447    .3878949
-------------+----------------------------------------------------------------
_y_E         |
       _cons |  -.1516215   .3153228    -0.48   0.631    -.7696428    .4663997
-------------+----------------------------------------------------------------
_y_F         |
      des_BF |  -.1835905   .3961029    -0.46   0.643    -.9599379    .5927568
       _cons |  -.0603276   .2333211    -0.26   0.796    -.5176285    .3969733
-------------+----------------------------------------------------------------
_y_G         |
      des_BG |   .3279506   .7117498     0.46   0.645    -1.067053    1.722955
      des_CG |  -.1097434   .6948442    -0.16   0.875    -1.471613    1.252126
       _cons |  -.3462582   .5475069    -0.63   0.527    -1.419352    .7268356
-------------+----------------------------------------------------------------
_y_H         |
      des_AH |  -.0585379   .4095562    -0.14   0.886    -.8612533    .7441775
      des_BH |    1.20477   .5346788     2.25   0.024     .1568188    2.252721
      des_CH |  -.4653832   .5027691    -0.93   0.355    -1.450793    .5200261
       _cons |  -.0048226   .2191572    -0.02   0.982    -.4343629    .4247177
------------------------------------------------------------------------------

Estimated between-studies SDs and correlation matrix:
             SD       _y_B       _y_C       _y_D       _y_E       _y_F
_y_B  .21561476          1          .          .          .          .
_y_C  .21561476         .5          1          .          .          .
_y_D  .21561476         .5         .5          1          .          .
_y_E  .21561476         .5         .5         .5          1          .
_y_F  .21561476         .5         .5         .5         .5          1
_y_G  .21561476         .5         .5         .5         .5         .5
_y_H  .21561476         .5         .5         .5         .5         .5

           _y_G       _y_H
_y_B          .          .
_y_C          .          .
_y_D          .          .
_y_E          .          .
_y_F          .          .
_y_G          1          .
_y_H         .5          1

Testing for inconsistency:
 ( 1)  [_y_C]des_ACH = 0
 ( 2)  [_y_D]des_AD = 0
 ( 3)  [_y_H]des_AH = 0
 ( 4)  [_y_F]des_BF = 0
 ( 5)  [_y_G]des_BG = 0
 ( 6)  [_y_H]des_BH = 0
 ( 7)  [_y_G]des_CG = 0
 ( 8)  [_y_H]des_CH = 0

           chi2(  8) =    8.60
         Prob > chi2 =    0.3767
mvmeta command stored as F9; test command stored as F8
(Thrombolytics network meta-analysis from Lu & Ades (2006), corrected)
Treatments used
   A (reference):                      A
   B:                                  B
   C:                                  C
   D:                                  D
   E:                                  E
   F:                                  F
   G:                                  G
   H:                                  H

Measure                                Risk difference

Studies
   ID variable:                        study
   Number used:                        28
   IDs with zero cells:                [none]
   IDs with augmented reference arm:   17 18 19 20 21 22 23 24 25 26 27 28
   - observations added:               0.00001
   - mean in augmented observations:   study-specific mean

Network information                    
   Components:                         1 (connected)
   D.f. for inconsistency:             8
   D.f. for heterogeneity:             15

Current data
   Data format:                        augmented
   Design variable:                    _design
   Estimate variables:                 _y*
   Variance variables:                 _S*
   Command to list the data:           list study _y* _S*, noo sepby(_design)
Command is: mvmeta _y _S , bscovariance(exch 0.5) longparm suppress(uv mm) vars
> (_y_B _y_C _y_D _y_E _y_F _y_G _y_H)
Note: using method reml
Note: using variables _y_B _y_C _y_D _y_E _y_F _y_G _y_H
Note: 28 observations on 7 variables
Note: variance-covariance matrix is proportional to .5*I(7)+.5*J(7,7,1)

initial:       log likelihood = -88.723004
rescale:       log likelihood = -17.512769
rescale eq:    log likelihood = -13.864284
Iteration 0:   log likelihood = -13.864284  
Iteration 1:   log likelihood = -13.651642  (not concave)
Iteration 2:   log likelihood = -13.464153  (not concave)
Iteration 3:   log likelihood =  -13.44134  (not concave)
Iteration 4:   log likelihood = -13.434256  
Iteration 5:   log likelihood = -13.429822  (not concave)
Iteration 6:   log likelihood = -13.397258  
Iteration 7:   log likelihood = -13.392339  
Iteration 8:   log likelihood = -13.390118  
Iteration 9:   log likelihood =  -13.38807  (not concave)
Iteration 10:  log likelihood = -13.386283  
Iteration 11:  log likelihood = -13.385788  
Iteration 12:  log likelihood = -13.385767  (not concave)
Iteration 13:  log likelihood = -13.385759  
Iteration 14:  log likelihood = -13.385759  

Multivariate meta-analysis
Variance-covariance matrix = proportional .5*I(7)+.5*J(7,7,1)
Method = reml                                  Number of dimensions    =     7
Restricted log likelihood = -13.385759         Number of observations  =    28
------------------------------------------------------------------------------
             |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
_y_B         |
       _cons |  -.0111584   .0034329    -3.25   0.001    -.0178868     -.00443
-------------+----------------------------------------------------------------
_y_C         |
       _cons |   .0002419   .0027769     0.09   0.931    -.0052007    .0056844
-------------+----------------------------------------------------------------
_y_D         |
       _cons |  -.0031913   .0033854    -0.94   0.346    -.0098265     .003444
-------------+----------------------------------------------------------------
_y_E         |
       _cons |   -.010844   .0052381    -2.07   0.038    -.0211104   -.0005776
-------------+----------------------------------------------------------------
_y_F         |
       _cons |  -.0087772   .0047683    -1.84   0.066    -.0181228    .0005684
-------------+----------------------------------------------------------------
_y_G         |
       _cons |  -.0113099    .010071    -1.12   0.261    -.0310488    .0084289
-------------+----------------------------------------------------------------
_y_H         |
       _cons |   .0021887   .0036498     0.60   0.549    -.0049648    .0093422
------------------------------------------------------------------------------

Estimated between-studies SDs and correlation matrix:
             SD       _y_B       _y_C       _y_D       _y_E       _y_F
_y_B  .00141371          1          .          .          .          .
_y_C  .00141371         .5          1          .          .          .
_y_D  .00141371         .5         .5          1          .          .
_y_E  .00141371         .5         .5         .5          1          .
_y_F  .00141371         .5         .5         .5         .5          1
_y_G  .00141371         .5         .5         .5         .5         .5
_y_H  .00141371         .5         .5         .5         .5         .5

           _y_G       _y_H
_y_B          .          .
_y_C          .          .
_y_D          .          .
_y_E          .          .
_y_F          .          .
_y_G          1          .
_y_H         .5          1
mvmeta command stored as F9
Table of risk difference and its standard error for Treatment vs. Comparator:
---------------------------------------------------------------------------
           |                           Treatment                           
Comparator |      A       B       C       D       E       F       G       H
-----------+---------------------------------------------------------------
         A |         -0.011   0.000  -0.003  -0.011  -0.009  -0.011   0.002
           |          0.003   0.003   0.003   0.005   0.005   0.010   0.004
           | 
         B |  0.011           0.011   0.008   0.000   0.002  -0.000   0.013
           |  0.003           0.004   0.004   0.004   0.004   0.010   0.005
           | 
         C | -0.000  -0.011          -0.003  -0.011  -0.009  -0.012   0.002
           |  0.003   0.004           0.004   0.006   0.005   0.010   0.004
           | 
         D |  0.003  -0.008   0.003          -0.008  -0.006  -0.008   0.005
           |  0.003   0.004   0.004           0.005   0.005   0.010   0.005
           | 
         E |  0.011  -0.000   0.011   0.008           0.002  -0.000   0.013
           |  0.005   0.004   0.006   0.005           0.006   0.011   0.007
           | 
         F |  0.009  -0.002   0.009   0.006  -0.002          -0.003   0.011
           |  0.005   0.004   0.005   0.005   0.006           0.011   0.006
           | 
         G |  0.011   0.000   0.012   0.008   0.000   0.003           0.013
           |  0.010   0.010   0.010   0.010   0.011   0.011           0.011
           | 
         H | -0.002  -0.013  -0.002  -0.005  -0.013  -0.011  -0.013        
           |  0.004   0.005   0.004   0.005   0.007   0.006   0.011        
---------------------------------------------------------------------------
Command is: mvmeta _y _S , bscovariance(exch 0.5) longparm suppress(uv mm) eq(_
> y_C: des_ACH, _y_D: des_AD, _y_F: des_BF, _y_G: des_BG des_CG, _y_H: des_AH d
> es_BH des_CH) vars(_y_B _y_C _y_D _y_E _y_F _y_G _y_H)
Note: using method reml
Note: regressing _y_B on (nothing)
Note: regressing _y_C on des_ACH
Note: regressing _y_D on des_AD
Note: regressing _y_E on (nothing)
Note: regressing _y_F on des_BF
Note: regressing _y_G on des_BG des_CG
Note: regressing _y_H on des_AH des_BH des_CH
Note: 28 observations on 7 variables
Note: variance-covariance matrix is proportional to .5*I(7)+.5*J(7,7,1)

initial:       log likelihood = -80.316686
rescale:       log likelihood = -38.965317
rescale eq:    log likelihood =  -33.57131
Iteration 0:   log likelihood =  -33.57131  
Iteration 1:   log likelihood = -33.216137  (not concave)
Iteration 2:   log likelihood = -33.105851  
Iteration 3:   log likelihood = -33.073607  
Iteration 4:   log likelihood = -33.018118  (not concave)
Iteration 5:   log likelihood = -33.017443  (not concave)
Iteration 6:   log likelihood = -33.015278  
Iteration 7:   log likelihood = -33.001905  
Iteration 8:   log likelihood = -33.001875  
Iteration 9:   log likelihood = -33.001874  

Multivariate meta-analysis
Variance-covariance matrix = proportional .5*I(7)+.5*J(7,7,1)
Method = reml                                  Number of dimensions    =     7
Restricted log likelihood = -33.001874         Number of observations  =    28
------------------------------------------------------------------------------
             |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
_y_B         |
       _cons |  -.0099372   .0120824    -0.82   0.411    -.0336182    .0137439
-------------+----------------------------------------------------------------
_y_C         |
     des_ACH |   .0074555   .0174345     0.43   0.669    -.0267156    .0416266
       _cons |   -.009886   .0123878    -0.80   0.425    -.0341657    .0143936
-------------+----------------------------------------------------------------
_y_D         |
      des_AD |   .0206277   .0331214     0.62   0.533     -.044289    .0855443
       _cons |   -.002965    .012107    -0.24   0.807    -.0266942    .0207642
-------------+----------------------------------------------------------------
_y_E         |
       _cons |  -.0096227   .0172209    -0.56   0.576    -.0433751    .0241296
-------------+----------------------------------------------------------------
_y_F         |
      des_BF |  -.0094123   .0224012    -0.42   0.674    -.0533179    .0344932
       _cons |  -.0050735   .0138971    -0.37   0.715    -.0323113    .0221643
-------------+----------------------------------------------------------------
_y_G         |
      des_BG |   .0089623   .0328048     0.27   0.785     -.055334    .0732585
      des_CG |  -.0092223   .0314014    -0.29   0.769    -.0707679    .0523234
       _cons |  -.0139076   .0232352    -0.60   0.549    -.0594477    .0316326
-------------+----------------------------------------------------------------
_y_H         |
      des_AH |  -.0022177    .021296    -0.10   0.917    -.0439571    .0395218
      des_BH |   .0514134   .0254182     2.02   0.043     .0015947    .1012321
      des_CH |  -.0275883   .0296521    -0.93   0.352    -.0857054    .0305288
       _cons |  -.0004546   .0122721    -0.04   0.970    -.0245076    .0235984
------------------------------------------------------------------------------

Estimated between-studies SDs and correlation matrix:
             SD       _y_B       _y_C       _y_D       _y_E       _y_F
_y_B  .01170135          1          .          .          .          .
_y_C  .01170135         .5          1          .          .          .
_y_D  .01170135         .5         .5          1          .          .
_y_E  .01170135         .5         .5         .5          1          .
_y_F  .01170135         .5         .5         .5         .5          1
_y_G  .01170135         .5         .5         .5         .5         .5
_y_H  .01170135         .5         .5         .5         .5         .5

           _y_G       _y_H
_y_B          .          .
_y_C          .          .
_y_D          .          .
_y_E          .          .
_y_F          .          .
_y_G          1          .
_y_H         .5          1

Testing for inconsistency:
 ( 1)  [_y_C]des_ACH = 0
 ( 2)  [_y_D]des_AD = 0
 ( 3)  [_y_H]des_AH = 0
 ( 4)  [_y_F]des_BF = 0
 ( 5)  [_y_G]des_BG = 0
 ( 6)  [_y_H]des_BH = 0
 ( 7)  [_y_G]des_CG = 0
 ( 8)  [_y_H]des_CH = 0

           chi2(  8) =    7.68
         Prob > chi2 =    0.4654
mvmeta command stored as F9; test command stored as F8
(Thrombolytics network meta-analysis from Lu & Ades (2006), corrected)
Treatments used
   A (reference):                      A
   B:                                  B
   C:                                  C
   D:                                  D
   E:                                  E
   F:                                  F
   G:                                  G
   H:                                  H

Measure                                Log hazard ratio

Studies
   ID variable:                        study
   Number used:                        28
   IDs with zero cells:                [none]
   IDs with augmented reference arm:   17 18 19 20 21 22 23 24 25 26 27 28
   - observations added:               0.00001
   - mean in augmented observations:   study-specific mean

Network information                    
   Components:                         1 (connected)
   D.f. for inconsistency:             8
   D.f. for heterogeneity:             15

Current data
   Data format:                        augmented
   Design variable:                    _design
   Estimate variables:                 _y*
   Variance variables:                 _S*
   Command to list the data:           list study _y* _S*, noo sepby(_design)
Command is: mvmeta _y _S , bscovariance(exch 0.5) longparm suppress(uv mm) vars
> (_y_B _y_C _y_D _y_E _y_F _y_G _y_H)
Note: using method reml
Note: using variables _y_B _y_C _y_D _y_E _y_F _y_G _y_H
Note: 28 observations on 7 variables
Note: variance-covariance matrix is proportional to .5*I(7)+.5*J(7,7,1)

initial:       log likelihood =  -127.5061
rescale:       log likelihood = -115.90472
rescale eq:    log likelihood = -113.91555
Iteration 0:   log likelihood = -113.91555  
Iteration 1:   log likelihood = -113.78964  
Iteration 2:   log likelihood = -113.76505  (not concave)
Iteration 3:   log likelihood = -113.74712  (not concave)
Iteration 4:   log likelihood = -113.74691  
Iteration 5:   log likelihood = -113.74666  
Iteration 6:   log likelihood = -113.74666  

Multivariate meta-analysis
Variance-covariance matrix = proportional .5*I(7)+.5*J(7,7,1)
Method = reml                                  Number of dimensions    =     7
Restricted log likelihood = -113.74666         Number of observations  =    28
------------------------------------------------------------------------------
             |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
_y_B         |
       _cons |  -.1493278   .0431717    -3.46   0.001    -.2339428   -.0647129
-------------+----------------------------------------------------------------
_y_C         |
       _cons |    .001612   .0296143     0.05   0.957     -.056431     .059655
-------------+----------------------------------------------------------------
_y_D         |
       _cons |  -.0404589    .045297    -0.89   0.372    -.1292394    .0483215
-------------+----------------------------------------------------------------
_y_E         |
       _cons |  -.1442279   .0757006    -1.91   0.057    -.2925984    .0041426
-------------+----------------------------------------------------------------
_y_F         |
       _cons |  -.1037436   .0581522    -1.78   0.074    -.2177199    .0102326
-------------+----------------------------------------------------------------
_y_G         |
       _cons |  -.1866232   .2158189    -0.86   0.387    -.6096205    .2363741
-------------+----------------------------------------------------------------
_y_H         |
       _cons |   .0121644   .0362775     0.34   0.737    -.0589382     .083267
------------------------------------------------------------------------------

Estimated between-studies SDs and correlation matrix:
             SD       _y_B       _y_C       _y_D       _y_E       _y_F
_y_B  .00624805          1          .          .          .          .
_y_C  .00624805         .5          1          .          .          .
_y_D  .00624805         .5         .5          1          .          .
_y_E  .00624805         .5         .5         .5          1          .
_y_F  .00624805         .5         .5         .5         .5          1
_y_G  .00624805         .5         .5         .5         .5         .5
_y_H  .00624805         .5         .5         .5         .5         .5

           _y_G       _y_H
_y_B          .          .
_y_C          .          .
_y_D          .          .
_y_E          .          .
_y_F          .          .
_y_G          1          .
_y_H         .5          1
mvmeta command stored as F9
Table of log hazard ratio and its standard error for Treatment vs. Comparator:
---------------------------------------------------------------------------
           |                           Treatment                           
Comparator |      A       B       C       D       E       F       G       H
-----------+---------------------------------------------------------------
         A |         -0.149   0.002  -0.040  -0.144  -0.104  -0.187   0.012
           |          0.043   0.030   0.045   0.076   0.058   0.216   0.036
           | 
         B |  0.149           0.151   0.109   0.005   0.046  -0.037   0.161
           |  0.043           0.053   0.053   0.062   0.053   0.217   0.057
           | 
         C | -0.002  -0.151          -0.042  -0.146  -0.105  -0.188   0.011
           |  0.030   0.053           0.054   0.081   0.065   0.216   0.036
           | 
         D |  0.040  -0.109   0.042          -0.104  -0.063  -0.146   0.053
           |  0.045   0.053   0.054           0.081   0.069   0.220   0.058
           | 
         E |  0.144  -0.005   0.146   0.104           0.040  -0.042   0.156
           |  0.076   0.062   0.081   0.081           0.082   0.226   0.084
           | 
         F |  0.104  -0.046   0.105   0.063  -0.040          -0.083   0.116
           |  0.058   0.053   0.065   0.069   0.082           0.221   0.069
           | 
         G |  0.187   0.037   0.188   0.146   0.042   0.083           0.199
           |  0.216   0.217   0.216   0.220   0.226   0.221           0.218
           | 
         H | -0.012  -0.161  -0.011  -0.053  -0.156  -0.116  -0.199        
           |  0.036   0.057   0.036   0.058   0.084   0.069   0.218        
---------------------------------------------------------------------------
Command is: mvmeta _y _S , bscovariance(exch 0.5) longparm suppress(uv mm) eq(_
> y_C: des_ACH, _y_D: des_AD, _y_F: des_BF, _y_G: des_BG des_CG, _y_H: des_AH d
> es_BH des_CH) vars(_y_B _y_C _y_D _y_E _y_F _y_G _y_H)
Note: using method reml
Note: regressing _y_B on (nothing)
Note: regressing _y_C on des_ACH
Note: regressing _y_D on des_AD
Note: regressing _y_E on (nothing)
Note: regressing _y_F on des_BF
Note: regressing _y_G on des_BG des_CG
Note: regressing _y_H on des_AH des_BH des_CH
Note: 28 observations on 7 variables
Note: variance-covariance matrix is proportional to .5*I(7)+.5*J(7,7,1)

initial:       log likelihood = -117.34934
rescale:       log likelihood = -113.23641
rescale eq:    log likelihood = -110.79323
Iteration 0:   log likelihood = -110.79323  
Iteration 1:   log likelihood = -110.46846  (not concave)
Iteration 2:   log likelihood = -110.45327  (not concave)
Iteration 3:   log likelihood = -110.44523  
Iteration 4:   log likelihood = -110.43829  
Iteration 5:   log likelihood = -110.43825  
Iteration 6:   log likelihood = -110.43825  

Multivariate meta-analysis
Variance-covariance matrix = proportional .5*I(7)+.5*J(7,7,1)
Method = reml                                  Number of dimensions    =     7
Restricted log likelihood = -110.43825         Number of observations  =    28
------------------------------------------------------------------------------
             |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
_y_B         |
       _cons |  -.1463943   .2017519    -0.73   0.468    -.5418209    .2490322
-------------+----------------------------------------------------------------
_y_C         |
     des_ACH |   .1371777   .3005795     0.46   0.648    -.4519473    .7263027
       _cons |  -.1604657   .2246446    -0.71   0.475    -.6007611    .2798297
-------------+----------------------------------------------------------------
_y_D         |
      des_AD |   .4284277   .7040672     0.61   0.543    -.9515187    1.808374
       _cons |  -.0414817   .2013783    -0.21   0.837     -.436176    .3532126
-------------+----------------------------------------------------------------
_y_E         |
       _cons |  -.1412944    .288136    -0.49   0.624    -.7060306    .4234418
-------------+----------------------------------------------------------------
_y_F         |
      des_BF |  -.1644236   .3643564    -0.45   0.652    -.8785489    .5497018
       _cons |  -.0547355   .2137832    -0.26   0.798    -.4737427    .3642718
-------------+----------------------------------------------------------------
_y_G         |
      des_BG |   .3127832   .6837238     0.46   0.647    -1.027291    1.652857
      des_CG |   -.086367     .67285    -0.13   0.898    -1.405129    1.232395
       _cons |   -.331736   .5304224    -0.63   0.532    -1.371345    .7078728
-------------+----------------------------------------------------------------
_y_H         |
      des_AH |  -.0566169   .3887139    -0.15   0.884    -.8184822    .7052484
      des_BH |   1.150324   .5093245     2.26   0.024     .1520665    2.148582
      des_CH |  -.4216324   .4780054    -0.88   0.378    -1.358506    .5152409
       _cons |  -.0043145   .1996714    -0.02   0.983    -.3956632    .3870342
------------------------------------------------------------------------------

Estimated between-studies SDs and correlation matrix:
             SD       _y_B       _y_C       _y_D       _y_E       _y_F
_y_B  .19619063          1          .          .          .          .
_y_C  .19619063         .5          1          .          .          .
_y_D  .19619063         .5         .5          1          .          .
_y_E  .19619063         .5         .5         .5          1          .
_y_F  .19619063         .5         .5         .5         .5          1
_y_G  .19619063         .5         .5         .5         .5         .5
_y_H  .19619063         .5         .5         .5         .5         .5

           _y_G       _y_H
_y_B          .          .
_y_C          .          .
_y_D          .          .
_y_E          .          .
_y_F          .          .
_y_G          1          .
_y_H         .5          1

Testing for inconsistency:
 ( 1)  [_y_C]des_ACH = 0
 ( 2)  [_y_D]des_AD = 0
 ( 3)  [_y_H]des_AH = 0
 ( 4)  [_y_F]des_BF = 0
 ( 5)  [_y_G]des_BG = 0
 ( 6)  [_y_H]des_BH = 0
 ( 7)  [_y_G]des_CG = 0
 ( 8)  [_y_H]des_CH = 0

           chi2(  8) =    8.28
         Prob > chi2 =    0.4068
mvmeta command stored as F9; test command stored as F8

. 
. * Check with >26 treatments
. clear

. set obs 30
number of observations (_N) was 0, now 30

. gen study = _n

. gen trt1 = 0

. gen trt2 = _n

. reshape long trt, i(study) j(arm)
(note: j = 1 2)

Data                               wide   ->   long
-----------------------------------------------------------------------------
Number of obs.                       30   ->      60
Number of variables                   3   ->       3
j variable (2 values)                     ->   arm
xij variables:
                              trt1 trt2   ->   trt
-----------------------------------------------------------------------------

. drop arm

. gen n = 100

. gen d =  20

. network setup d n, study(study) trt(trt)
Treatments used
   AA (reference):                     0
   AB:                                 1
   AC:                                 2
   AD:                                 3
   AE:                                 4
   AF:                                 5
   AG:                                 6
   AH:                                 7
   AI:                                 8
   AJ:                                 9
   AK:                                 10
   AL:                                 11
   AM:                                 12
   AN:                                 13
   AO:                                 14
   AP:                                 15
   AQ:                                 16
   AR:                                 17
   AS:                                 18
   AT:                                 19
   AU:                                 20
   AV:                                 21
   AW:                                 22
   AX:                                 23
   AY:                                 24
   AZ:                                 25
   BA:                                 26
   BB:                                 27
   BC:                                 28
   BD:                                 29
   BE:                                 30

Measure                                Log odds ratio

Studies
   ID variable:                        study
   Number used:                        30
   IDs with zero cells:                [none]

Network information                    
   Components:                         1 (connected)
   D.f. for inconsistency:             0
   D.f. for heterogeneity:             0

Current data
   Data format:                        augmented
   Design variable:                    _design
   Estimate variables:                 _y*
   Variance variables:                 _S*
   Command to list the data:           list study _y* _S*, noo sepby(_design)

. 
. * and with very many treatments - only works with setup direct to standard
. clear

. set obs 200
number of observations (_N) was 0, now 200

. gen study = _n

. gen trt1 = 0

. gen trt2 = _n

. reshape long trt, i(study) j(arm)
(note: j = 1 2)

Data                               wide   ->   long
-----------------------------------------------------------------------------
Number of obs.                      200   ->     400
Number of variables                   3   ->       3
j variable (2 values)                     ->   arm
xij variables:
                              trt1 trt2   ->   trt
-----------------------------------------------------------------------------

. drop arm

. gen n = 100

. gen d =  20

. network setup d n, study(study) trt(trt) format(standard)
Treatments used
   AA (reference):                     0
   AB:                                 1
   AC:                                 2
   AD:                                 3
   AE:                                 4
   AF:                                 5
   AG:                                 6
   AH:                                 7
   AI:                                 8
   AJ:                                 9
   AK:                                 10
   AL:                                 11
   AM:                                 12
   AN:                                 13
   AO:                                 14
   AP:                                 15
   AQ:                                 16
   AR:                                 17
   AS:                                 18
   AT:                                 19
   AU:                                 20
   AV:                                 21
   AW:                                 22
   AX:                                 23
   AY:                                 24
   AZ:                                 25
   BA:                                 26
   BB:                                 27
   BC:                                 28
   BD:                                 29
   BE:                                 30
   BF:                                 31
   BG:                                 32
   BH:                                 33
   BI:                                 34
   BJ:                                 35
   BK:                                 36
   BL:                                 37
   BM:                                 38
   BN:                                 39
   BO:                                 40
   BP:                                 41
   BQ:                                 42
   BR:                                 43
   BS:                                 44
   BT:                                 45
   BU:                                 46
   BV:                                 47
   BW:                                 48
   BX:                                 49
   BY:                                 50
   BZ:                                 51
   CA:                                 52
   CB:                                 53
   CC:                                 54
   CD:                                 55
   CE:                                 56
   CF:                                 57
   CG:                                 58
   CH:                                 59
   CI:                                 60
   CJ:                                 61
   CK:                                 62
   CL:                                 63
   CM:                                 64
   CN:                                 65
   CO:                                 66
   CP:                                 67
   CQ:                                 68
   CR:                                 69
   CS:                                 70
   CT:                                 71
   CU:                                 72
   CV:                                 73
   CW:                                 74
   CX:                                 75
   CY:                                 76
   CZ:                                 77
   DA:                                 78
   DB:                                 79
   DC:                                 80
   DD:                                 81
   DE:                                 82
   DF:                                 83
   DG:                                 84
   DH:                                 85
   DI:                                 86
   DJ:                                 87
   DK:                                 88
   DL:                                 89
   DM:                                 90
   DN:                                 91
   DO:                                 92
   DP:                                 93
   DQ:                                 94
   DR:                                 95
   DS:                                 96
   DT:                                 97
   DU:                                 98
   DV:                                 99
   DW:                                 100
   DX:                                 101
   DY:                                 102
   DZ:                                 103
   EA:                                 104
   EB:                                 105
   EC:                                 106
   ED:                                 107
   EE:                                 108
   EF:                                 109
   EG:                                 110
   EH:                                 111
   EI:                                 112
   EJ:                                 113
   EK:                                 114
   EL:                                 115
   EM:                                 116
   EN:                                 117
   EO:                                 118
   EP:                                 119
   EQ:                                 120
   ER:                                 121
   ES:                                 122
   ET:                                 123
   EU:                                 124
   EV:                                 125
   EW:                                 126
   EX:                                 127
   EY:                                 128
   EZ:                                 129
   FA:                                 130
   FB:                                 131
   FC:                                 132
   FD:                                 133
   FE:                                 134
   FF:                                 135
   FG:                                 136
   FH:                                 137
   FI:                                 138
   FJ:                                 139
   FK:                                 140
   FL:                                 141
   FM:                                 142
   FN:                                 143
   FO:                                 144
   FP:                                 145
   FQ:                                 146
   FR:                                 147
   FS:                                 148
   FT:                                 149
   FU:                                 150
   FV:                                 151
   FW:                                 152
   FX:                                 153
   FY:                                 154
   FZ:                                 155
   GA:                                 156
   GB:                                 157
   GC:                                 158
   GD:                                 159
   GE:                                 160
   GF:                                 161
   GG:                                 162
   GH:                                 163
   GI:                                 164
   GJ:                                 165
   GK:                                 166
   GL:                                 167
   GM:                                 168
   GN:                                 169
   GO:                                 170
   GP:                                 171
   GQ:                                 172
   GR:                                 173
   GS:                                 174
   GT:                                 175
   GU:                                 176
   GV:                                 177
   GW:                                 178
   GX:                                 179
   GY:                                 180
   GZ:                                 181
   HA:                                 182
   HB:                                 183
   HC:                                 184
   HD:                                 185
   HE:                                 186
   HF:                                 187
   HG:                                 188
   HH:                                 189
   HI:                                 190
   HJ:                                 191
   HK:                                 192
   HL:                                 193
   HM:                                 194
   HN:                                 195
   HO:                                 196
   HP:                                 197
   HQ:                                 198
   HR:                                 199
   HS:                                 200

Measure                                Log odds ratio

Studies
   ID variable:                        study
   Number used:                        200
   IDs with zero cells:                [none]

Network information                    
   Components:                         1 (connected)
   D.f. for inconsistency:             0
   D.f. for heterogeneity:             0

Current data
   Data format:                        standard
   Design variable:                    _design
   Estimate variables:                 _y*
   Variance variables:                 _S*
   Contrast variables:                 _contrast*
   Command to list the data:           list study _design _contrast* _y* _S*, n
> oo sepby(_design)

. network meta c, fixed
Command is: mvmeta _y _S , fixed commonparm noconstant suppress(uv mm) eq(_y_1:
>  _trtdiff1_AB _trtdiff1_AC _trtdiff1_AD _trtdiff1_AE _trtdiff1_AF _trtdiff1_A
> G _trtdiff1_AH _trtdiff1_AI _trtdiff1_AJ _trtdiff1_AK _trtdiff1_AL _trtdiff1_
> AM _trtdiff1_AN _trtdiff1_AO _trtdiff1_AP _trtdiff1_AQ _trtdiff1_AR _trtdiff1
> _AS _trtdiff1_AT _trtdiff1_AU _trtdiff1_AV _trtdiff1_AW _trtdiff1_AX _trtdiff
> 1_AY _trtdiff1_AZ _trtdiff1_BA _trtdiff1_BB _trtdiff1_BC _trtdiff1_BD _trtdif
> f1_BE _trtdiff1_BF _trtdiff1_BG _trtdiff1_BH _trtdiff1_BI _trtdiff1_BJ _trtdi
> ff1_BK _trtdiff1_BL _trtdiff1_BM _trtdiff1_BN _trtdiff1_BO _trtdiff1_BP _trtd
> iff1_BQ _trtdiff1_BR _trtdiff1_BS _trtdiff1_BT _trtdiff1_BU _trtdiff1_BV _trt
> diff1_BW _trtdiff1_BX _trtdiff1_BY _trtdiff1_BZ _trtdiff1_CA _trtdiff1_CB _tr
> tdiff1_CC _trtdiff1_CD _trtdiff1_CE _trtdiff1_CF _trtdiff1_CG _trtdiff1_CH _t
> rtdiff1_CI _trtdiff1_CJ _trtdiff1_CK _trtdiff1_CL _trtdiff1_CM _trtdiff1_CN _
> trtdiff1_CO _trtdiff1_CP _trtdiff1_CQ _trtdiff1_CR _trtdiff1_CS _trtdiff1_CT 
> _trtdiff1_CU _trtdiff1_CV _trtdiff1_CW _trtdiff1_CX _trtdiff1_CY _trtdiff1_CZ
>  _trtdiff1_DA _trtdiff1_DB _trtdiff1_DC _trtdiff1_DD _trtdiff1_DE _trtdiff1_D
> F _trtdiff1_DG _trtdiff1_DH _trtdiff1_DI _trtdiff1_DJ _trtdiff1_DK _trtdiff1_
> DL _trtdiff1_DM _trtdiff1_DN _trtdiff1_DO _trtdiff1_DP _trtdiff1_DQ _trtdiff1
> _DR _trtdiff1_DS _trtdiff1_DT _trtdiff1_DU _trtdiff1_DV _trtdiff1_DW _trtdiff
> 1_DX _trtdiff1_DY _trtdiff1_DZ _trtdiff1_EA _trtdiff1_EB _trtdiff1_EC _trtdif
> f1_ED _trtdiff1_EE _trtdiff1_EF _trtdiff1_EG _trtdiff1_EH _trtdiff1_EI _trtdi
> ff1_EJ _trtdiff1_EK _trtdiff1_EL _trtdiff1_EM _trtdiff1_EN _trtdiff1_EO _trtd
> iff1_EP _trtdiff1_EQ _trtdiff1_ER _trtdiff1_ES _trtdiff1_ET _trtdiff1_EU _trt
> diff1_EV _trtdiff1_EW _trtdiff1_EX _trtdiff1_EY _trtdiff1_EZ _trtdiff1_FA _tr
> tdiff1_FB _trtdiff1_FC _trtdiff1_FD _trtdiff1_FE _trtdiff1_FF _trtdiff1_FG _t
> rtdiff1_FH _trtdiff1_FI _trtdiff1_FJ _trtdiff1_FK _trtdiff1_FL _trtdiff1_FM _
> trtdiff1_FN _trtdiff1_FO _trtdiff1_FP _trtdiff1_FQ _trtdiff1_FR _trtdiff1_FS 
> _trtdiff1_FT _trtdiff1_FU _trtdiff1_FV _trtdiff1_FW _trtdiff1_FX _trtdiff1_FY
>  _trtdiff1_FZ _trtdiff1_GA _trtdiff1_GB _trtdiff1_GC _trtdiff1_GD _trtdiff1_G
> E _trtdiff1_GF _trtdiff1_GG _trtdiff1_GH _trtdiff1_GI _trtdiff1_GJ _trtdiff1_
> GK _trtdiff1_GL _trtdiff1_GM _trtdiff1_GN _trtdiff1_GO _trtdiff1_GP _trtdiff1
> _GQ _trtdiff1_GR _trtdiff1_GS _trtdiff1_GT _trtdiff1_GU _trtdiff1_GV _trtdiff
> 1_GW _trtdiff1_GX _trtdiff1_GY _trtdiff1_GZ _trtdiff1_HA _trtdiff1_HB _trtdif
> f1_HC _trtdiff1_HD _trtdiff1_HE _trtdiff1_HF _trtdiff1_HG _trtdiff1_HH _trtdi
> ff1_HI _trtdiff1_HJ _trtdiff1_HK _trtdiff1_HL _trtdiff1_HM _trtdiff1_HN _trtd
> iff1_HO _trtdiff1_HP _trtdiff1_HQ _trtdiff1_HR _trtdiff1_HS) vars(_y_1)
Note: using method fixed
Note: regressing _y_1 on _trtdiff1_AB _trtdiff1_AC _trtdiff1_AD _trtdiff1_AE _t
> rtdiff1_AF _trtdiff1_AG _trtdiff1_AH _trtdiff1_AI _trtdiff1_AJ _trtdiff1_AK _
> trtdiff1_AL _trtdiff1_AM _trtdiff1_AN _trtdiff1_AO _trtdiff1_AP _trtdiff1_AQ 
> _trtdiff1_AR _trtdiff1_AS _trtdiff1_AT _trtdiff1_AU _trtdiff1_AV _trtdiff1_AW
>  _trtdiff1_AX _trtdiff1_AY _trtdiff1_AZ _trtdiff1_BA _trtdiff1_BB _trtdiff1_B
> C _trtdiff1_BD _trtdiff1_BE _trtdiff1_BF _trtdiff1_BG _trtdiff1_BH _trtdiff1_
> BI _trtdiff1_BJ _trtdiff1_BK _trtdiff1_BL _trtdiff1_BM _trtdiff1_BN _trtdiff1
> _BO _trtdiff1_BP _trtdiff1_BQ _trtdiff1_BR _trtdiff1_BS _trtdiff1_BT _trtdiff
> 1_BU _trtdiff1_BV _trtdiff1_BW _trtdiff1_BX _trtdiff1_BY _trtdiff1_BZ _trtdif
> f1_CA _trtdiff1_CB _trtdiff1_CC _trtdiff1_CD _trtdiff1_CE _trtdiff1_CF _trtdi
> ff1_CG _trtdiff1_CH _trtdiff1_CI _trtdiff1_CJ _trtdiff1_CK _trtdiff1_CL _trtd
> iff1_CM _trtdiff1_CN _trtdiff1_CO _trtdiff1_CP _trtdiff1_CQ _trtdiff1_CR _trt
> diff1_CS _trtdiff1_CT _trtdiff1_CU _trtdiff1_CV _trtdiff1_CW _trtdiff1_CX _tr
> tdiff1_CY _trtdiff1_CZ _trtdiff1_DA _trtdiff1_DB _trtdiff1_DC _trtdiff1_DD _t
> rtdiff1_DE _trtdiff1_DF _trtdiff1_DG _trtdiff1_DH _trtdiff1_DI _trtdiff1_DJ _
> trtdiff1_DK _trtdiff1_DL _trtdiff1_DM _trtdiff1_DN _trtdiff1_DO _trtdiff1_DP 
> _trtdiff1_DQ _trtdiff1_DR _trtdiff1_DS _trtdiff1_DT _trtdiff1_DU _trtdiff1_DV
>  _trtdiff1_DW _trtdiff1_DX _trtdiff1_DY _trtdiff1_DZ _trtdiff1_EA _trtdiff1_E
> B _trtdiff1_EC _trtdiff1_ED _trtdiff1_EE _trtdiff1_EF _trtdiff1_EG _trtdiff1_
> EH _trtdiff1_EI _trtdiff1_EJ _trtdiff1_EK _trtdiff1_EL _trtdiff1_EM _trtdiff1
> _EN _trtdiff1_EO _trtdiff1_EP _trtdiff1_EQ _trtdiff1_ER _trtdiff1_ES _trtdiff
> 1_ET _trtdiff1_EU _trtdiff1_EV _trtdiff1_EW _trtdiff1_EX _trtdiff1_EY _trtdif
> f1_EZ _trtdiff1_FA _trtdiff1_FB _trtdiff1_FC _trtdiff1_FD _trtdiff1_FE _trtdi
> ff1_FF _trtdiff1_FG _trtdiff1_FH _trtdiff1_FI _trtdiff1_FJ _trtdiff1_FK _trtd
> iff1_FL _trtdiff1_FM _trtdiff1_FN _trtdiff1_FO _trtdiff1_FP _trtdiff1_FQ _trt
> diff1_FR _trtdiff1_FS _trtdiff1_FT _trtdiff1_FU _trtdiff1_FV _trtdiff1_FW _tr
> tdiff1_FX _trtdiff1_FY _trtdiff1_FZ _trtdiff1_GA _trtdiff1_GB _trtdiff1_GC _t
> rtdiff1_GD _trtdiff1_GE _trtdiff1_GF _trtdiff1_GG _trtdiff1_GH _trtdiff1_GI _
> trtdiff1_GJ _trtdiff1_GK _trtdiff1_GL _trtdiff1_GM _trtdiff1_GN _trtdiff1_GO 
> _trtdiff1_GP _trtdiff1_GQ _trtdiff1_GR _trtdiff1_GS _trtdiff1_GT _trtdiff1_GU
>  _trtdiff1_GV _trtdiff1_GW _trtdiff1_GX _trtdiff1_GY _trtdiff1_GZ _trtdiff1_H
> A _trtdiff1_HB _trtdiff1_HC _trtdiff1_HD _trtdiff1_HE _trtdiff1_HF _trtdiff1_
> HG _trtdiff1_HH _trtdiff1_HI _trtdiff1_HJ _trtdiff1_HK _trtdiff1_HL _trtdiff1
> _HM _trtdiff1_HN _trtdiff1_HO _trtdiff1_HP _trtdiff1_HQ _trtdiff1_HR _trtdiff
> 1_HS
Note: 200 observations on 1 variables

Multivariate meta-analysis
Variance-covariance matrix = (none)
Method = fixed                                 Number of dimensions    =     1
                                               Number of observations  =   200
------------------------------------------------------------------------------
             |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
_y_1         |
_trtdiff1_AB |          0   .3535534     0.00   1.000    -.6929519    .6929519
_trtdiff1_AC |          0   .3535534     0.00   1.000    -.6929519    .6929519
_trtdiff1_AD |          0   .3535534     0.00   1.000    -.6929519    .6929519
_trtdiff1_AE |          0   .3535534     0.00   1.000    -.6929519    .6929519
_trtdiff1_AF |          0   .3535534     0.00   1.000    -.6929519    .6929519
_trtdiff1_AG |          0   .3535534     0.00   1.000    -.6929519    .6929519
_trtdiff1_AH |          0   .3535534     0.00   1.000    -.6929519    .6929519
_trtdiff1_AI |          0   .3535534     0.00   1.000    -.6929519    .6929519
_trtdiff1_AJ |          0   .3535534     0.00   1.000    -.6929519    .6929519
_trtdiff1_AK |          0   .3535534     0.00   1.000    -.6929519    .6929519
_trtdiff1_AL |          0   .3535534     0.00   1.000    -.6929519    .6929519
_trtdiff1_AM |          0   .3535534     0.00   1.000    -.6929519    .6929519
_trtdiff1_AN |          0   .3535534     0.00   1.000    -.6929519    .6929519
_trtdiff1_AO |          0   .3535534     0.00   1.000    -.6929519    .6929519
_trtdiff1_AP |          0   .3535534     0.00   1.000    -.6929519    .6929519
_trtdiff1_AQ |          0   .3535534     0.00   1.000    -.6929519    .6929519
_trtdiff1_AR |          0   .3535534     0.00   1.000    -.6929519    .6929519
_trtdiff1_AS |          0   .3535534     0.00   1.000    -.6929519    .6929519
_trtdiff1_AT |          0   .3535534     0.00   1.000    -.6929519    .6929519
_trtdiff1_AU |          0   .3535534     0.00   1.000    -.6929519    .6929519
_trtdiff1_AV |          0   .3535534     0.00   1.000    -.6929519    .6929519
_trtdiff1_AW |          0   .3535534     0.00   1.000    -.6929519    .6929519
_trtdiff1_AX |          0   .3535534     0.00   1.000    -.6929519    .6929519
_trtdiff1_AY |          0   .3535534     0.00   1.000    -.6929519    .6929519
_trtdiff1_AZ |          0   .3535534     0.00   1.000    -.6929519    .6929519
_trtdiff1_BA |          0   .3535534     0.00   1.000    -.6929519    .6929519
_trtdiff1_BB |          0   .3535534     0.00   1.000    -.6929519    .6929519
_trtdiff1_BC |          0   .3535534     0.00   1.000    -.6929519    .6929519
_trtdiff1_BD |          0   .3535534     0.00   1.000    -.6929519    .6929519
_trtdiff1_BE |          0   .3535534     0.00   1.000    -.6929519    .6929519
_trtdiff1_BF |          0   .3535534     0.00   1.000    -.6929519    .6929519
_trtdiff1_BG |          0   .3535534     0.00   1.000    -.6929519    .6929519
_trtdiff1_BH |          0   .3535534     0.00   1.000    -.6929519    .6929519
_trtdiff1_BI |          0   .3535534     0.00   1.000    -.6929519    .6929519
_trtdiff1_BJ |          0   .3535534     0.00   1.000    -.6929519    .6929519
_trtdiff1_BK |          0   .3535534     0.00   1.000    -.6929519    .6929519
_trtdiff1_BL |          0   .3535534     0.00   1.000    -.6929519    .6929519
_trtdiff1_BM |          0   .3535534     0.00   1.000    -.6929519    .6929519
_trtdiff1_BN |          0   .3535534     0.00   1.000    -.6929519    .6929519
_trtdiff1_BO |          0   .3535534     0.00   1.000    -.6929519    .6929519
_trtdiff1_BP |          0   .3535534     0.00   1.000    -.6929519    .6929519
_trtdiff1_BQ |          0   .3535534     0.00   1.000    -.6929519    .6929519
_trtdiff1_BR |          0   .3535534     0.00   1.000    -.6929519    .6929519
_trtdiff1_BS |          0   .3535534     0.00   1.000    -.6929519    .6929519
_trtdiff1_BT |          0   .3535534     0.00   1.000    -.6929519    .6929519
_trtdiff1_BU |          0   .3535534     0.00   1.000    -.6929519    .6929519
_trtdiff1_BV |          0   .3535534     0.00   1.000    -.6929519    .6929519
_trtdiff1_BW |          0   .3535534     0.00   1.000    -.6929519    .6929519
_trtdiff1_BX |          0   .3535534     0.00   1.000    -.6929519    .6929519
_trtdiff1_BY |          0   .3535534     0.00   1.000    -.6929519    .6929519
_trtdiff1_BZ |          0   .3535534     0.00   1.000    -.6929519    .6929519
_trtdiff1_CA |          0   .3535534     0.00   1.000    -.6929519    .6929519
_trtdiff1_CB |          0   .3535534     0.00   1.000    -.6929519    .6929519
_trtdiff1_CC |          0   .3535534     0.00   1.000    -.6929519    .6929519
_trtdiff1_CD |          0   .3535534     0.00   1.000    -.6929519    .6929519
_trtdiff1_CE |          0   .3535534     0.00   1.000    -.6929519    .6929519
_trtdiff1_CF |          0   .3535534     0.00   1.000    -.6929519    .6929519
_trtdiff1_CG |          0   .3535534     0.00   1.000    -.6929519    .6929519
_trtdiff1_CH |          0   .3535534     0.00   1.000    -.6929519    .6929519
_trtdiff1_CI |          0   .3535534     0.00   1.000    -.6929519    .6929519
_trtdiff1_CJ |          0   .3535534     0.00   1.000    -.6929519    .6929519
_trtdiff1_CK |          0   .3535534     0.00   1.000    -.6929519    .6929519
_trtdiff1_CL |          0   .3535534     0.00   1.000    -.6929519    .6929519
_trtdiff1_CM |          0   .3535534     0.00   1.000    -.6929519    .6929519
_trtdiff1_CN |          0   .3535534     0.00   1.000    -.6929519    .6929519
_trtdiff1_CO |          0   .3535534     0.00   1.000    -.6929519    .6929519
_trtdiff1_CP |          0   .3535534     0.00   1.000    -.6929519    .6929519
_trtdiff1_CQ |          0   .3535534     0.00   1.000    -.6929519    .6929519
_trtdiff1_CR |          0   .3535534     0.00   1.000    -.6929519    .6929519
_trtdiff1_CS |          0   .3535534     0.00   1.000    -.6929519    .6929519
_trtdiff1_CT |          0   .3535534     0.00   1.000    -.6929519    .6929519
_trtdiff1_CU |          0   .3535534     0.00   1.000    -.6929519    .6929519
_trtdiff1_CV |          0   .3535534     0.00   1.000    -.6929519    .6929519
_trtdiff1_CW |          0   .3535534     0.00   1.000    -.6929519    .6929519
_trtdiff1_CX |          0   .3535534     0.00   1.000    -.6929519    .6929519
_trtdiff1_CY |          0   .3535534     0.00   1.000    -.6929519    .6929519
_trtdiff1_CZ |          0   .3535534     0.00   1.000    -.6929519    .6929519
_trtdiff1_DA |          0   .3535534     0.00   1.000    -.6929519    .6929519
_trtdiff1_DB |          0   .3535534     0.00   1.000    -.6929519    .6929519
_trtdiff1_DC |          0   .3535534     0.00   1.000    -.6929519    .6929519
_trtdiff1_DD |          0   .3535534     0.00   1.000    -.6929519    .6929519
_trtdiff1_DE |          0   .3535534     0.00   1.000    -.6929519    .6929519
_trtdiff1_DF |          0   .3535534     0.00   1.000    -.6929519    .6929519
_trtdiff1_DG |          0   .3535534     0.00   1.000    -.6929519    .6929519
_trtdiff1_DH |          0   .3535534     0.00   1.000    -.6929519    .6929519
_trtdiff1_DI |          0   .3535534     0.00   1.000    -.6929519    .6929519
_trtdiff1_DJ |          0   .3535534     0.00   1.000    -.6929519    .6929519
_trtdiff1_DK |          0   .3535534     0.00   1.000    -.6929519    .6929519
_trtdiff1_DL |          0   .3535534     0.00   1.000    -.6929519    .6929519
_trtdiff1_DM |          0   .3535534     0.00   1.000    -.6929519    .6929519
_trtdiff1_DN |          0   .3535534     0.00   1.000    -.6929519    .6929519
_trtdiff1_DO |          0   .3535534     0.00   1.000    -.6929519    .6929519
_trtdiff1_DP |          0   .3535534     0.00   1.000    -.6929519    .6929519
_trtdiff1_DQ |          0   .3535534     0.00   1.000    -.6929519    .6929519
_trtdiff1_DR |          0   .3535534     0.00   1.000    -.6929519    .6929519
_trtdiff1_DS |          0   .3535534     0.00   1.000    -.6929519    .6929519
_trtdiff1_DT |          0   .3535534     0.00   1.000    -.6929519    .6929519
_trtdiff1_DU |          0   .3535534     0.00   1.000    -.6929519    .6929519
_trtdiff1_DV |          0   .3535534     0.00   1.000    -.6929519    .6929519
_trtdiff1_DW |          0   .3535534     0.00   1.000    -.6929519    .6929519
_trtdiff1_DX |          0   .3535534     0.00   1.000    -.6929519    .6929519
_trtdiff1_DY |          0   .3535534     0.00   1.000    -.6929519    .6929519
_trtdiff1_DZ |          0   .3535534     0.00   1.000    -.6929519    .6929519
_trtdiff1_EA |          0   .3535534     0.00   1.000    -.6929519    .6929519
_trtdiff1_EB |          0   .3535534     0.00   1.000    -.6929519    .6929519
_trtdiff1_EC |          0   .3535534     0.00   1.000    -.6929519    .6929519
_trtdiff1_ED |          0   .3535534     0.00   1.000    -.6929519    .6929519
_trtdiff1_EE |          0   .3535534     0.00   1.000    -.6929519    .6929519
_trtdiff1_EF |          0   .3535534     0.00   1.000    -.6929519    .6929519
_trtdiff1_EG |          0   .3535534     0.00   1.000    -.6929519    .6929519
_trtdiff1_EH |          0   .3535534     0.00   1.000    -.6929519    .6929519
_trtdiff1_EI |          0   .3535534     0.00   1.000    -.6929519    .6929519
_trtdiff1_EJ |          0   .3535534     0.00   1.000    -.6929519    .6929519
_trtdiff1_EK |          0   .3535534     0.00   1.000    -.6929519    .6929519
_trtdiff1_EL |          0   .3535534     0.00   1.000    -.6929519    .6929519
_trtdiff1_EM |          0   .3535534     0.00   1.000    -.6929519    .6929519
_trtdiff1_EN |          0   .3535534     0.00   1.000    -.6929519    .6929519
_trtdiff1_EO |          0   .3535534     0.00   1.000    -.6929519    .6929519
_trtdiff1_EP |          0   .3535534     0.00   1.000    -.6929519    .6929519
_trtdiff1_EQ |          0   .3535534     0.00   1.000    -.6929519    .6929519
_trtdiff1_ER |          0   .3535534     0.00   1.000    -.6929519    .6929519
_trtdiff1_ES |          0   .3535534     0.00   1.000    -.6929519    .6929519
_trtdiff1_ET |          0   .3535534     0.00   1.000    -.6929519    .6929519
_trtdiff1_EU |          0   .3535534     0.00   1.000    -.6929519    .6929519
_trtdiff1_EV |          0   .3535534     0.00   1.000    -.6929519    .6929519
_trtdiff1_EW |          0   .3535534     0.00   1.000    -.6929519    .6929519
_trtdiff1_EX |          0   .3535534     0.00   1.000    -.6929519    .6929519
_trtdiff1_EY |          0   .3535534     0.00   1.000    -.6929519    .6929519
_trtdiff1_EZ |          0   .3535534     0.00   1.000    -.6929519    .6929519
_trtdiff1_FA |          0   .3535534     0.00   1.000    -.6929519    .6929519
_trtdiff1_FB |          0   .3535534     0.00   1.000    -.6929519    .6929519
_trtdiff1_FC |          0   .3535534     0.00   1.000    -.6929519    .6929519
_trtdiff1_FD |          0   .3535534     0.00   1.000    -.6929519    .6929519
_trtdiff1_FE |          0   .3535534     0.00   1.000    -.6929519    .6929519
_trtdiff1_FF |          0   .3535534     0.00   1.000    -.6929519    .6929519
_trtdiff1_FG |          0   .3535534     0.00   1.000    -.6929519    .6929519
_trtdiff1_FH |          0   .3535534     0.00   1.000    -.6929519    .6929519
_trtdiff1_FI |          0   .3535534     0.00   1.000    -.6929519    .6929519
_trtdiff1_FJ |          0   .3535534     0.00   1.000    -.6929519    .6929519
_trtdiff1_FK |          0   .3535534     0.00   1.000    -.6929519    .6929519
_trtdiff1_FL |          0   .3535534     0.00   1.000    -.6929519    .6929519
_trtdiff1_FM |          0   .3535534     0.00   1.000    -.6929519    .6929519
_trtdiff1_FN |          0   .3535534     0.00   1.000    -.6929519    .6929519
_trtdiff1_FO |          0   .3535534     0.00   1.000    -.6929519    .6929519
_trtdiff1_FP |          0   .3535534     0.00   1.000    -.6929519    .6929519
_trtdiff1_FQ |          0   .3535534     0.00   1.000    -.6929519    .6929519
_trtdiff1_FR |          0   .3535534     0.00   1.000    -.6929519    .6929519
_trtdiff1_FS |          0   .3535534     0.00   1.000    -.6929519    .6929519
_trtdiff1_FT |          0   .3535534     0.00   1.000    -.6929519    .6929519
_trtdiff1_FU |          0   .3535534     0.00   1.000    -.6929519    .6929519
_trtdiff1_FV |          0   .3535534     0.00   1.000    -.6929519    .6929519
_trtdiff1_FW |          0   .3535534     0.00   1.000    -.6929519    .6929519
_trtdiff1_FX |          0   .3535534     0.00   1.000    -.6929519    .6929519
_trtdiff1_FY |          0   .3535534     0.00   1.000    -.6929519    .6929519
_trtdiff1_FZ |          0   .3535534     0.00   1.000    -.6929519    .6929519
_trtdiff1_GA |          0   .3535534     0.00   1.000    -.6929519    .6929519
_trtdiff1_GB |          0   .3535534     0.00   1.000    -.6929519    .6929519
_trtdiff1_GC |          0   .3535534     0.00   1.000    -.6929519    .6929519
_trtdiff1_GD |          0   .3535534     0.00   1.000    -.6929519    .6929519
_trtdiff1_GE |          0   .3535534     0.00   1.000    -.6929519    .6929519
_trtdiff1_GF |          0   .3535534     0.00   1.000    -.6929519    .6929519
_trtdiff1_GG |          0   .3535534     0.00   1.000    -.6929519    .6929519
_trtdiff1_GH |          0   .3535534     0.00   1.000    -.6929519    .6929519
_trtdiff1_GI |          0   .3535534     0.00   1.000    -.6929519    .6929519
_trtdiff1_GJ |          0   .3535534     0.00   1.000    -.6929519    .6929519
_trtdiff1_GK |          0   .3535534     0.00   1.000    -.6929519    .6929519
_trtdiff1_GL |          0   .3535534     0.00   1.000    -.6929519    .6929519
_trtdiff1_GM |          0   .3535534     0.00   1.000    -.6929519    .6929519
_trtdiff1_GN |          0   .3535534     0.00   1.000    -.6929519    .6929519
_trtdiff1_GO |          0   .3535534     0.00   1.000    -.6929519    .6929519
_trtdiff1_GP |          0   .3535534     0.00   1.000    -.6929519    .6929519
_trtdiff1_GQ |          0   .3535534     0.00   1.000    -.6929519    .6929519
_trtdiff1_GR |          0   .3535534     0.00   1.000    -.6929519    .6929519
_trtdiff1_GS |          0   .3535534     0.00   1.000    -.6929519    .6929519
_trtdiff1_GT |          0   .3535534     0.00   1.000    -.6929519    .6929519
_trtdiff1_GU |          0   .3535534     0.00   1.000    -.6929519    .6929519
_trtdiff1_GV |          0   .3535534     0.00   1.000    -.6929519    .6929519
_trtdiff1_GW |          0   .3535534     0.00   1.000    -.6929519    .6929519
_trtdiff1_GX |          0   .3535534     0.00   1.000    -.6929519    .6929519
_trtdiff1_GY |          0   .3535534     0.00   1.000    -.6929519    .6929519
_trtdiff1_GZ |          0   .3535534     0.00   1.000    -.6929519    .6929519
_trtdiff1_HA |          0   .3535534     0.00   1.000    -.6929519    .6929519
_trtdiff1_HB |          0   .3535534     0.00   1.000    -.6929519    .6929519
_trtdiff1_HC |          0   .3535534     0.00   1.000    -.6929519    .6929519
_trtdiff1_HD |          0   .3535534     0.00   1.000    -.6929519    .6929519
_trtdiff1_HE |          0   .3535534     0.00   1.000    -.6929519    .6929519
_trtdiff1_HF |          0   .3535534     0.00   1.000    -.6929519    .6929519
_trtdiff1_HG |          0   .3535534     0.00   1.000    -.6929519    .6929519
_trtdiff1_HH |          0   .3535534     0.00   1.000    -.6929519    .6929519
_trtdiff1_HI |          0   .3535534     0.00   1.000    -.6929519    .6929519
_trtdiff1_HJ |          0   .3535534     0.00   1.000    -.6929519    .6929519
_trtdiff1_HK |          0   .3535534     0.00   1.000    -.6929519    .6929519
_trtdiff1_HL |          0   .3535534     0.00   1.000    -.6929519    .6929519
_trtdiff1_HM |          0   .3535534     0.00   1.000    -.6929519    .6929519
_trtdiff1_HN |          0   .3535534     0.00   1.000    -.6929519    .6929519
_trtdiff1_HO |          0   .3535534     0.00   1.000    -.6929519    .6929519
_trtdiff1_HP |          0   .3535534     0.00   1.000    -.6929519    .6929519
_trtdiff1_HQ |          0   .3535534     0.00   1.000    -.6929519    .6929519
_trtdiff1_HR |          0   .3535534     0.00   1.000    -.6929519    .6929519
_trtdiff1_HS |          0   .3535534     0.00   1.000    -.6929519    .6929519
------------------------------------------------------------------------------
mvmeta command stored as F9

. 
. 
. // Check connectedness routines
. clear

. input trt1      trt2

          trt1       trt2
  1. 1       2
  2. 2       3
  3. 2       5
  4. 4       5
  5. 6       7
  6. 7       8
  7. end

. gen trial = _n

. reshape long trt, i(tri) 
(note: j = 1 2)

Data                               wide   ->   long
-----------------------------------------------------------------------------
Number of obs.                        6   ->      12
Number of variables                   3   ->       3
j variable (2 values)                     ->   _j
xij variables:
                              trt1 trt2   ->   trt
-----------------------------------------------------------------------------

. drop _j

. gen n = 10

. gen d = 5

. 
. network setup d n, studyvar(trial) trtvar(trt) numcodes
Treatments used
   1 (reference):                      1
   2:                                  2
   3:                                  3
   4:                                  4
   5:                                  5
   6:                                  6
   7:                                  7
   8:                                  8

Measure                                Log odds ratio

Studies
   ID variable:                        trial
   Number used:                        6
   IDs with zero cells:                [none]
   IDs with augmented reference arm:   2 3 4 5 6
   - observations added:               0.00001
   - mean in augmented observations:   study-specific mean

Network information                    
   Components:                         2 (disconnected)
   D.f. for inconsistency:             0
   D.f. for heterogeneity:             0

Current data
   Data format:                        augmented
   Design variable:                    _design
   Estimate variables:                 _y*
   Variance variables:                 _S*
   Command to list the data:           list trial _y* _S*, noo sepby(_design)

. network table
Displaying components separately

-------------------------------------------------------------------------------
-> _component = 1

------------------------------------------------------------------------------
          |                      Treatment and Statistic                      
          | ---- 1 ---    ---- 2 ---    ---- 3 ---    ---- 4 ---    ---- 5 ---
    trial |    d     n       d     n       d     n       d     n       d     n
----------+-------------------------------------------------------------------
        1 |    5    10       5    10                                          
        2 |                  5    10       5    10                            
        3 |                  5    10                                   5    10
        4 |                                              5    10       5    10
------------------------------------------------------------------------------

-------------------------------------------------------------------------------
-> _component = 2

--------------------------------------------------
          |        Treatment and Statistic        
          | ---- 6 ---    ---- 7 ---    ---- 8 ---
    trial |    d     n       d     n       d     n
----------+---------------------------------------
        5 |    5    10       5    10              
        6 |                  5    10       5    10
--------------------------------------------------


. matrix list network_adjacency // the adjacency matrix

symmetric network_adjacency[8,8]
   1  2  3  4  5  6  7  8
1  0
2  1  0
3  0  1  0
4  0  0  0  0
5  0  1  0  1  0
6  0  0  0  0  0  0
7  0  0  0  0  0  1  0
8  0  0  0  0  0  0  1  0

. matrix list network_indirect_connection // the indirect connection matrix

symmetric network_indirect_connection[8,8]
   1  2  3  4  5  6  7  8
1  1
2  1  1
3  1  1  1
4  1  1  1  1
5  1  1  1  1  1
6  0  0  0  0  0  1
7  0  0  0  0  0  1  1
8  0  0  0  0  0  1  1  1

. matrix list network_distance // the distance matrix

symmetric network_distance[8,8]
   1  2  3  4  5  6  7  8
1  0
2  1  0
3  2  1  0
4  3  2  3  0
5  2  1  2  1  0
6  0  0  0  0  0  0
7  0  0  0  0  0  1  0
8  0  0  0  0  0  2  1  0

. matrix list network_components // assigns treatments to components

network_components[8,2]
   c1  c2
1   1   0
2   1   0
3   1   0
4   1   0
5   1   0
6   0   1
7   0   1
8   0   1

. assert rowsof(network_components) == 8

. assert colsof(network_components) == 2

. 
. // Check variances aren't deleted when one trtcode starts with reference trtc
> ode
. clear

. input trial str10 trt n d

         trial         trt          n          d
  1. 1 "A" 100 10
  2. 1 "AB" 100 10
  3. end

. network setup d n, study(trial) trt(trt) nocode
Treatments used
   A (reference):                      A
   AB:                                 AB

Measure                                Log odds ratio

Studies
   ID variable:                        trial
   Number used:                        1
   IDs with zero cells:                [none]

Network information                    
   Components:                         1 (connected)
   D.f. for inconsistency:             0
   D.f. for heterogeneity:             0

Current data
   Data format:                        augmented
   Design variable:                    _design
   Estimate variables:                 _y*
   Variance variables:                 _S*
   Command to list the data:           list trial _y* _S*, noo sepby(_design)

. l _S_AB_AB

     +-----------+
     |  _S_AB_AB |
     |-----------|
  1. | .22222222 |
     +-----------+

. 
. 
. // Check matrices output by network meta
. // Uses tough nested treatment codes
. // 31may2018
. 
. clear

. set obs 18
number of observations (_N) was 0, now 18

. gen study = _n

. gen trt1 = cond(study<=12,1,7)

. gen trt2 = cond(study<=12,mod(_n-1,6)+2,mod(_n-1,6)+1)

. reshape long trt, i(study) j(arm)
(note: j = 1 2)

Data                               wide   ->   long
-----------------------------------------------------------------------------
Number of obs.                       18   ->      36
Number of variables                   3   ->       3
j variable (2 values)                     ->   arm
xij variables:
                              trt1 trt2   ->   trt
-----------------------------------------------------------------------------

. gen n=100

. gen r=20+study+5*trt

. label def trt 1 "AA" 2 "AAB" 3 "AABC" 4 "BC" 5 "B" 6 "BD" 7 "A" 

. label val trt trt

. drop arm

. l, sepby(study)

     +-------------------------+
     | study    trt     n    r |
     |-------------------------|
  1. |     1     AA   100   26 |
  2. |     1    AAB   100   31 |
     |-------------------------|
  3. |     2     AA   100   27 |
  4. |     2   AABC   100   37 |
     |-------------------------|
  5. |     3     AA   100   28 |
  6. |     3     BC   100   43 |
     |-------------------------|
  7. |     4     AA   100   29 |
  8. |     4      B   100   49 |
     |-------------------------|
  9. |     5     AA   100   30 |
 10. |     5     BD   100   55 |
     |-------------------------|
 11. |     6     AA   100   31 |
 12. |     6      A   100   61 |
     |-------------------------|
 13. |     7     AA   100   32 |
 14. |     7    AAB   100   37 |
     |-------------------------|
 15. |     8     AA   100   33 |
 16. |     8   AABC   100   43 |
     |-------------------------|
 17. |     9     AA   100   34 |
 18. |     9     BC   100   49 |
     |-------------------------|
 19. |    10     AA   100   35 |
 20. |    10      B   100   55 |
     |-------------------------|
 21. |    11     AA   100   36 |
 22. |    11     BD   100   61 |
     |-------------------------|
 23. |    12     AA   100   37 |
 24. |    12      A   100   67 |
     |-------------------------|
 25. |    13      A   100   68 |
 26. |    13     AA   100   38 |
     |-------------------------|
 27. |    14      A   100   69 |
 28. |    14    AAB   100   44 |
     |-------------------------|
 29. |    15      A   100   70 |
 30. |    15   AABC   100   50 |
     |-------------------------|
 31. |    16      A   100   71 |
 32. |    16     BC   100   56 |
     |-------------------------|
 33. |    17      A   100   72 |
 34. |    17      B   100   62 |
     |-------------------------|
 35. |    18      A   100   73 |
 36. |    18     BD   100   68 |
     +-------------------------+

. network setup r n , study(study) trt(trt) nocode
Treatments used
   AA (reference):                     AA
   AAB:                                AAB
   AABC:                               AABC
   BC:                                 BC
   B:                                  B
   BD:                                 BD
   A:                                  A

Measure                                Log odds ratio

Studies
   ID variable:                        study
   Number used:                        18
   IDs with zero cells:                [none]
   IDs with augmented reference arm:   14 15 16 17 18
   - observations added:               0.00001
   - mean in augmented observations:   study-specific mean

Network information                    
   Components:                         1 (connected)
   D.f. for inconsistency:             5
   D.f. for heterogeneity:             7

Current data
   Data format:                        augmented
   Design variable:                    _design
   Estimate variables:                 _y*
   Variance variables:                 _S*
   Command to list the data:           list study _y* _S*, noo sepby(_design)

. 
. network meta c, fixed
Command is: mvmeta _y _S , fixed longparm suppress(uv mm) vars(_y_AAB _y_AABC _
> y_BC _y_B _y_BD _y_A)
Note: using method fixed
Note: using variables _y_AAB _y_AABC _y_BC _y_B _y_BD _y_A
Note: 18 observations on 6 variables

Multivariate meta-analysis
Variance-covariance matrix = (none)
Method = fixed                                 Number of dimensions    =     6
                                               Number of observations  =    18
------------------------------------------------------------------------------
             |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
_y_AAB       |
       _cons |   .2300915   .1793599     1.28   0.200    -.1214474    .5816303
-------------+----------------------------------------------------------------
_y_AABC      |
       _cons |   .4351164   .1768412     2.46   0.014     .0885142    .7817187
-------------+----------------------------------------------------------------
_y_BC        |
       _cons |   .6321994   .1756363     3.60   0.000     .2879586    .9764402
-------------+----------------------------------------------------------------
_y_B         |
       _cons |   .8287393   .1756235     4.72   0.000     .4845234    1.172955
-------------+----------------------------------------------------------------
_y_BD        |
       _cons |   1.031988   .1768717     5.83   0.000     .6853262     1.37865
-------------+----------------------------------------------------------------
_y_A         |
       _cons |   1.265824   .1186863    10.67   0.000     1.033203    1.498444
------------------------------------------------------------------------------
mvmeta command stored as F9

. mat nc = _network_consistency

. network meta i, fixed
Command is: mvmeta _y _S , fixed longparm suppress(uv mm) eq(_y_AAB: des_AAAAB,
>  _y_AABC: des_AAAABC, _y_BC: des_AABC, _y_B: des_AAB, _y_BD: des_AABD) vars(_
> y_AAB _y_AABC _y_BC _y_B _y_BD _y_A)
Note: using method fixed
Note: regressing _y_AAB on des_AAAAB
Note: regressing _y_AABC on des_AAAABC
Note: regressing _y_BC on des_AABC
Note: regressing _y_B on des_AAB
Note: regressing _y_BD on des_AABD
Note: regressing _y_A on (nothing)
Note: 18 observations on 6 variables

Multivariate meta-analysis
Variance-covariance matrix = (none)
Method = fixed                                 Number of dimensions    =     6
                                               Number of observations  =    18
------------------------------------------------------------------------------
             |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
_y_AAB       |
   des_AAAAB |   .0306357   .4044502     0.08   0.940    -.7620721    .8233435
       _cons |   .2024273   .3417811     0.59   0.554    -.4674514    .8723059
-------------+----------------------------------------------------------------
_y_AABC      |
  des_AAAABC |   .0471954   .4024097     0.12   0.907    -.7415131    .8359038
       _cons |   .3964108    .342196     1.16   0.247    -.2742812    1.067103
-------------+----------------------------------------------------------------
_y_BC        |
    des_AABC |   .0528087   .4028993     0.13   0.896    -.7368594    .8424768
       _cons |   .5894866   .3444282     1.71   0.087    -.0855802    1.264553
-------------+----------------------------------------------------------------
_y_B         |
     des_AAB |   .0483136   .4058782     0.12   0.905    -.7471931    .8438203
       _cons |   .7887952   .3486073     2.26   0.024     .1055374    1.472053
-------------+----------------------------------------------------------------
_y_BD        |
    des_AABD |   .0322761   .4117355     0.08   0.938    -.7747105    .8392628
       _cons |   1.002858   .3552051     2.82   0.005     .3066687    1.699047
-------------+----------------------------------------------------------------
_y_A         |
       _cons |   1.243709   .1716948     7.24   0.000     .9071931    1.580224
------------------------------------------------------------------------------

Testing for inconsistency:
 ( 1)  [_y_AAB]des_AAAAB = 0
 ( 2)  [_y_AABC]des_AAAABC = 0
 ( 3)  [_y_B]des_AAB = 0
 ( 4)  [_y_BC]des_AABC = 0
 ( 5)  [_y_BD]des_AABD = 0

           chi2(  5) =    0.03
         Prob > chi2 =    1.0000
mvmeta command stored as F9; test command stored as F8

. mat ni = _network_inconsistency

. foreach format in standard pairs augmented {
  2.         network convert `format'
  3.         network meta c
  4.         assert mreldif(nc,_network_consistency)<1E-6
  5.         network meta i
  6.         assert mreldif(ni,_network_inconsistency)<1E-6
  7.         // worst is about 5E-7
. }
Converting augmented to standard ...
Command is: mvmeta _y _S , bscovariance(exch 0.5) commonparm noconstant suppres
> s(uv mm) eq(_y_1: _trtdiff1_AAB _trtdiff1_AABC _trtdiff1_BC _trtdiff1_B _trtd
> iff1_BD _trtdiff1_A) vars(_y_1)
Note: using method reml
Note: regressing _y_1 on _trtdiff1_AAB _trtdiff1_AABC _trtdiff1_BC _trtdiff1_B 
> _trtdiff1_BD _trtdiff1_A
Note: 18 observations on 1 variables
Note: variance-covariance matrix is proportional to .5*I(1)+.5*J(1,1,1)

initial:       log likelihood = -15.212027
rescale:       log likelihood = -12.660107
rescale eq:    log likelihood = -.22530835
Iteration 0:   log likelihood = -.22530835  
Iteration 1:   log likelihood = -.22529199  
Iteration 2:   log likelihood = -.22529199  

Multivariate meta-analysis
Variance-covariance matrix = proportional .5*I(1)+.5*J(1,1,1)
Method = reml                                  Number of dimensions    =     1
Restricted log likelihood = -.22529199         Number of observations  =    18
------------------------------------------------------------------------------
             |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
_y_1         |
_trtdiff1~AB |   .2300915   .1793599     1.28   0.200    -.1214473    .5816304
_trtdiff~ABC |   .4351165   .1768411     2.46   0.014     .0885142    .7817188
_trtdiff1_BC |   .6321995   .1756363     3.60   0.000     .2879587    .9764402
 _trtdiff1_B |   .8287393   .1756235     4.72   0.000     .4845236    1.172955
_trtdiff1_BD |   1.031988   .1768717     5.83   0.000     .6853262     1.37865
 _trtdiff1_A |   1.265824   .1186863    10.67   0.000     1.033203    1.498445
------------------------------------------------------------------------------

Estimated between-studies SDs and correlation matrix:
             SD       _y_1
_y_1  1.740e-09          1
mvmeta command stored as F9
Command is: mvmeta _y _S , bscovariance(exch 0.5) commonparm noconstant suppres
> s(uv mm) eq(_y_1: _trtdiff1_AAB _trtdiff1_AABC _trtdiff1_BC _trtdiff1_B _trtd
> iff1_BD _trtdiff1_A _trtdiff1_AAB_des_AAAAB _trtdiff1_AABC_des_AAAABC _trtdif
> f1_B_des_AAB _trtdiff1_BC_des_AABC _trtdiff1_BD_des_AABD) vars(_y_1)
Note: using method reml
Note: regressing _y_1 on _trtdiff1_AAB _trtdiff1_AABC _trtdiff1_BC _trtdiff1_B 
> _trtdiff1_BD _trtdiff1_A _trtdiff1_AAB_des_AAAAB _trtdiff1_AABC_des_AAAABC _t
> rtdiff1_B_des_AAB _trtdiff1_BC_des_AABC _trtdiff1_BD_des_AABD
Note: 18 observations on 1 variables
Note: variance-covariance matrix is proportional to .5*I(1)+.5*J(1,1,1)

initial:       log likelihood = -9.0135553
rescale:       log likelihood = -9.0135553
rescale eq:    log likelihood = -.25177417
Iteration 0:   log likelihood = -.25177417  
Iteration 1:   log likelihood = -.25175869  
Iteration 2:   log likelihood = -.25175869  

Multivariate meta-analysis
Variance-covariance matrix = proportional .5*I(1)+.5*J(1,1,1)
Method = reml                                  Number of dimensions    =     1
Restricted log likelihood = -.25175869         Number of observations  =    18
------------------------------------------------------------------------------
             |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
_y_1         |
_trtdi~1_AAB |   .2024277   .3417815     0.59   0.554    -.4674517    .8723071
_trtd~1_AABC |   .3964112   .3421965     1.16   0.247    -.2742817    1.067104
_trtdiff1_BC |    .589487   .3444284     1.71   0.087    -.0855803    1.264554
 _trtdiff1_B |   .7887956   .3486078     2.26   0.024      .105537    1.472054
_trtdiff1_BD |   1.002858    .355206     2.82   0.005     .3066673    1.699049
 _trtdiff1_A |   1.243709   .1716951     7.24   0.000     .9071929    1.580225
_trtdif~AAAB |   .0306353   .4044506     0.08   0.940    -.7620733    .8233439
_trtdi~AAABC |    .047195   .4024103     0.12   0.907    -.7415146    .8359046
_trtdi~s_AAB |   .0483132   .4058787     0.12   0.905    -.7471945    .8438208
_trtd~s_AABC |   .0528083   .4028996     0.13   0.896    -.7368604     .842477
_trtdiff~ABD |   .0322757   .4117365     0.08   0.938     -.774713    .8392644
------------------------------------------------------------------------------

Estimated between-studies SDs and correlation matrix:
             SD       _y_1
_y_1  9.095e-13          1

Testing for inconsistency:
 ( 1)  [_y_1]_trtdiff1_AAB_des_AAAAB = 0
 ( 2)  [_y_1]_trtdiff1_AABC_des_AAAABC = 0
 ( 3)  [_y_1]_trtdiff1_B_des_AAB = 0
 ( 4)  [_y_1]_trtdiff1_BC_des_AABC = 0
 ( 5)  [_y_1]_trtdiff1_BD_des_AABD = 0

           chi2(  5) =    0.03
         Prob > chi2 =    1.0000
mvmeta command stored as F9; test command stored as F8
Converting standard to pairs ...
Command is: metareg _y _trtdiff_AAB _trtdiff_AABC _trtdiff_BC _trtdiff_B _trtdi
> ff_BD _trtdiff_A , wsse(_stderr) noconstant
numerical derivatives are approximate
nearby values are missing
numerical derivatives are approximate
nearby values are missing
numerical derivatives are approximate
nearby values are missing
numerical derivatives are approximate
nearby values are missing
numerical derivatives are approximate
nearby values are missing

Meta-regression                                       Number of obs  =      18
REML estimate of between-study variance               tau2           =       0
% residual variation due to heterogeneity             I-squared_res  =   0.00%
Joint test for all covariates                         Model F(6,12)  =   22.77
With Knapp-Hartung modification                       Prob > F       =  0.0000
------------------------------------------------------------------------------
          _y |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
_trtdiff_AAB |   .2300915   .1793599     1.28   0.224       -.1607    .6208831
_trtdiff_A~C |   .4351165   .1768412     2.46   0.030     .0498127    .8204203
 _trtdiff_BC |   .6321995   .1756363     3.60   0.004     .2495209    1.014878
  _trtdiff_B |   .8287393   .1756235     4.72   0.000     .4460885     1.21139
 _trtdiff_BD |   1.031988   .1768717     5.83   0.000     .6466181    1.417359
  _trtdiff_A |   1.265824   .1186863    10.67   0.000     1.007228    1.524419
------------------------------------------------------------------------------
mvmeta command stored as F9
Command is: metareg _y _trtdiff_AAB _trtdiff_AABC _trtdiff_BC _trtdiff_B _trtdi
> ff_BD _trtdiff_A _trtdiff_AAB_des_AAAAB _trtdiff_AABC_des_AAAABC _trtdiff_B_d
> es_AAB _trtdiff_BC_des_AABC _trtdiff_BD_des_AABD , wsse(_stderr) noconstant

Meta-regression                                       Number of obs  =      18
REML estimate of between-study variance               tau2           =       0
% residual variation due to heterogeneity             I-squared_res  =   0.00%
Joint test for all covariates                         Model F(11,7)  =   12.42
With Knapp-Hartung modification                       Prob > F       =  0.0014
------------------------------------------------------------------------------
          _y |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
_trtdiff_AAB |   .2024277   .3417811     0.59   0.572    -.6057563    1.010612
_trtd~f_AABC |   .3964112   .3421961     1.16   0.285     -.412754    1.205576
 _trtdiff_BC |    .589487   .3444282     1.71   0.131    -.2249563     1.40393
  _trtdiff_B |   .7887956   .3486074     2.26   0.058    -.0355298    1.613121
 _trtdiff_BD |   1.002858   .3552051     2.82   0.026     .1629317    1.842785
  _trtdiff_A |   1.243709   .1716948     7.24   0.000     .8377153    1.649703
_trtdif~AAAB |   .0306353   .4044502     0.08   0.942    -.9257374    .9870081
_trtdi~AAABC |    .047195   .4024097     0.12   0.910    -.9043528    .9987427
_trtdiff_B~B |   .0483132   .4058783     0.12   0.909    -.9114364    1.008063
_trtd~s_AABC |   .0528083   .4028993     0.13   0.899    -.8998972    1.005514
_trtdiff~ABD |   .0322757   .4117355     0.08   0.940     -.941324    1.005875
------------------------------------------------------------------------------

Testing for inconsistency:
 ( 1)  _trtdiff_AAB_des_AAAAB = 0
 ( 2)  _trtdiff_AABC_des_AAAABC = 0
 ( 3)  _trtdiff_B_des_AAB = 0
 ( 4)  _trtdiff_BC_des_AABC = 0
 ( 5)  _trtdiff_BD_des_AABD = 0

       F(  5,     7) =    0.01
            Prob > F =    1.0000
mvmeta command stored as F9; test command stored as F8
Converting pairs to augmented ...
Command is: mvmeta _y _S , bscovariance(exch 0.5) longparm suppress(uv mm) vars
> (_y_AAB _y_AABC _y_BC _y_B _y_BD _y_A)
Note: using method reml
Note: using variables _y_AAB _y_AABC _y_BC _y_B _y_BD _y_A
Note: 18 observations on 6 variables
Note: variance-covariance matrix is proportional to .5*I(6)+.5*J(6,6,1)

initial:       log likelihood = -48.589097
rescale:       log likelihood = -46.037184
rescale eq:    log likelihood = -33.602355
Iteration 0:   log likelihood = -33.602355  
Iteration 1:   log likelihood = -33.602339  
Iteration 2:   log likelihood = -33.602339  

Multivariate meta-analysis
Variance-covariance matrix = proportional .5*I(6)+.5*J(6,6,1)
Method = reml                                  Number of dimensions    =     6
Restricted log likelihood = -33.602339         Number of observations  =    18
------------------------------------------------------------------------------
             |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
_y_AAB       |
       _cons |   .2300912   .1793599     1.28   0.200    -.1214476    .5816301
-------------+----------------------------------------------------------------
_y_AABC      |
       _cons |   .4351162   .1768412     2.46   0.014     .0885139    .7817185
-------------+----------------------------------------------------------------
_y_BC        |
       _cons |   .6321992   .1756363     3.60   0.000     .2879584      .97644
-------------+----------------------------------------------------------------
_y_B         |
       _cons |    .828739   .1756235     4.72   0.000     .4845232    1.172955
-------------+----------------------------------------------------------------
_y_BD        |
       _cons |   1.031988   .1768717     5.83   0.000      .685326     1.37865
-------------+----------------------------------------------------------------
_y_A         |
       _cons |   1.265823   .1186863    10.67   0.000     1.033202    1.498444
------------------------------------------------------------------------------

Estimated between-studies SDs and correlation matrix:
                SD     _y_AAB    _y_AABC      _y_BC       _y_B      _y_BD
 _y_AAB  1.939e-08          1          .          .          .          .
_y_AABC  1.939e-08         .5          1          .          .          .
  _y_BC  1.939e-08         .5         .5          1          .          .
   _y_B  1.939e-08         .5         .5         .5          1          .
  _y_BD  1.939e-08         .5         .5         .5         .5          1
   _y_A  1.939e-08         .5         .5         .5         .5         .5

              _y_A
 _y_AAB          .
_y_AABC          .
  _y_BC          .
   _y_B          .
  _y_BD          .
   _y_A          1
mvmeta command stored as F9
Command is: mvmeta _y _S , bscovariance(exch 0.5) longparm suppress(uv mm) eq(_
> y_AAB: des_AAAAB, _y_AABC: des_AAAABC, _y_BC: des_AABC, _y_B: des_AAB, _y_BD:
>  des_AABD) vars(_y_AAB _y_AABC _y_BC _y_B _y_BD _y_A)
Note: using method reml
Note: regressing _y_AAB on des_AAAAB
Note: regressing _y_AABC on des_AAAABC
Note: regressing _y_BC on des_AABC
Note: regressing _y_B on des_AAB
Note: regressing _y_BD on des_AABD
Note: regressing _y_A on (nothing)
Note: 18 observations on 6 variables
Note: variance-covariance matrix is proportional to .5*I(6)+.5*J(6,6,1)

initial:       log likelihood = -42.390634
rescale:       log likelihood = -42.390634
rescale eq:    log likelihood =  -33.62882
Iteration 0:   log likelihood =  -33.62882  
Iteration 1:   log likelihood = -33.628804  
Iteration 2:   log likelihood = -33.628804  

Multivariate meta-analysis
Variance-covariance matrix = proportional .5*I(6)+.5*J(6,6,1)
Method = reml                                  Number of dimensions    =     6
Restricted log likelihood = -33.628804         Number of observations  =    18
------------------------------------------------------------------------------
             |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
_y_AAB       |
   des_AAAAB |   .0306371   .4044501     0.08   0.940    -.7620706    .8233449
       _cons |   .2024258   .3417811     0.59   0.554    -.4674528    .8723044
-------------+----------------------------------------------------------------
_y_AABC      |
  des_AAAABC |   .0471968   .4024096     0.12   0.907    -.7415116    .8359052
       _cons |   .3964093    .342196     1.16   0.247    -.2742825    1.067101
-------------+----------------------------------------------------------------
_y_BC        |
    des_AABC |   .0528101   .4028993     0.13   0.896    -.7368579    .8424782
       _cons |   .5894852   .3444281     1.71   0.087    -.0855816    1.264552
-------------+----------------------------------------------------------------
_y_B         |
     des_AAB |    .048315   .4058782     0.12   0.905    -.7471917    .8438217
       _cons |   .7887938   .3486073     2.26   0.024      .105536    1.472052
-------------+----------------------------------------------------------------
_y_BD        |
    des_AABD |   .0322775   .4117354     0.08   0.938    -.7747091    .8392641
       _cons |   1.002856    .355205     2.82   0.005     .3066674    1.699045
-------------+----------------------------------------------------------------
_y_A         |
       _cons |   1.243707   .1716947     7.24   0.000     .9071918    1.580223
------------------------------------------------------------------------------

Estimated between-studies SDs and correlation matrix:
                SD     _y_AAB    _y_AABC      _y_BC       _y_B      _y_BD
 _y_AAB  1.231e-08          1          .          .          .          .
_y_AABC  1.231e-08         .5          1          .          .          .
  _y_BC  1.231e-08         .5         .5          1          .          .
   _y_B  1.231e-08         .5         .5         .5          1          .
  _y_BD  1.231e-08         .5         .5         .5         .5          1
   _y_A  1.231e-08         .5         .5         .5         .5         .5

              _y_A
 _y_AAB          .
_y_AABC          .
  _y_BC          .
   _y_B          .
  _y_BD          .
   _y_A          1

Testing for inconsistency:
 ( 1)  [_y_AAB]des_AAAAB = 0
 ( 2)  [_y_AABC]des_AAAABC = 0
 ( 3)  [_y_B]des_AAB = 0
 ( 4)  [_y_BC]des_AABC = 0
 ( 5)  [_y_BD]des_AABD = 0

           chi2(  5) =    0.03
         Prob > chi2 =    1.0000
mvmeta command stored as F9; test command stored as F8

. 
. // Check setup aborts when designs are potentially ambiguous
. // 31may2018
. pda

. clear

. input trial trt n d

         trial        trt          n          d
  1. 1 1 100 10
  2. 1 2 100 10
  3. 1 3 100 10
  4. 1 4 100 10
  5. 1 5 100 10
  6. 2 2 100 10
  7. 2 3 100 10
  8. 3 4 100 10
  9. 3 5 100 10
 10. end

. label def trt 1 "A" 2 "B" 3 "CD" 4 "BC" 5 "D"

. label val trt trt

. cap network setup d n, study(trial) trt(trt) nocode

. assert _rc==498

. 
. // Check agreement of setup direct to standard (new 8apr21) and to augmented
. // count data
. * setup to augmented
. use smoking, clear
(Smoking data from Lu & Ades (2006))

. network setup d n, studyvar(stud) trtvar(trt) format(aug)
Treatments used
   A (reference):                      No contact
   B:                                  Self help
   C:                                  Individual counselling
   D:                                  Group counselling

Measure                                Log odds ratio

Studies
   ID variable:                        study
   Number used:                        24
   IDs with zero cells:                9 20
   - count added to all their cells:   .5
   IDs with augmented reference arm:   2 21 22 23 24
   - observations added:               0.00001
   - mean in augmented observations:   study-specific mean

Network information                    
   Components:                         1 (connected)
   D.f. for inconsistency:             7
   D.f. for heterogeneity:             16

Current data
   Data format:                        augmented
   Design variable:                    _design
   Estimate variables:                 _y*
   Variance variables:                 _S*
   Command to list the data:           list study _y* _S*, noo sepby(_design)

. network convert standard
Converting augmented to standard ...

. foreach thing in `_dta[network_allthings]' {
  2.     local aug`thing' : char _dta[network_`thing']
  3. }

. network meta c, fixed
Command is: mvmeta _y _S , fixed commonparm noconstant suppress(uv mm) eq(_y_1:
>  _trtdiff1_B _trtdiff1_C _trtdiff1_D, _y_2: _trtdiff2_B _trtdiff2_C _trtdiff2
> _D) vars(_y_1 _y_2)
Note: using method fixed
Note: regressing _y_1 on _trtdiff1_B _trtdiff1_C _trtdiff1_D
Note: regressing _y_2 on _trtdiff2_B _trtdiff2_C _trtdiff2_D
Note: 24 observations on 2 variables

Multivariate meta-analysis
Variance-covariance matrix = (none)
Method = fixed                                 Number of dimensions    =     2
                                               Number of observations  =    24
------------------------------------------------------------------------------
             |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
_y_1         |
 _trtdiff1_B |   .1987505   .1259883     1.58   0.115     -.048182     .445683
 _trtdiff1_C |   .6391074   .0590771    10.82   0.000     .5233184    .7548964
 _trtdiff1_D |   .7086076   .1879352     3.77   0.000     .3402613    1.076954
------------------------------------------------------------------------------
The above coefficients also apply to the following equations:
    _y_2: _trtdiff2_B _trtdiff2_C _trtdiff2_D 
mvmeta command stored as F9

. local augb = _b[_trtdiff1_B]

. drop _trtdiff*

. rename (_* *) (aug=)

. rename augstudy study

. save z, replace
file z.dta saved

. * setup to standard
. use smoking, clear
(Smoking data from Lu & Ades (2006))

. network setup d n, studyvar(stud) trtvar(trt) format(sta)
Treatments used
   A (reference):                      No contact
   B:                                  Self help
   C:                                  Individual counselling
   D:                                  Group counselling

Measure                                Log odds ratio

Studies
   ID variable:                        study
   Number used:                        24
   IDs with zero cells:                9 20
   - count added to all their cells:   .5

Network information                    
   Components:                         1 (connected)
   D.f. for inconsistency:             7
   D.f. for heterogeneity:             16

Current data
   Data format:                        standard
   Design variable:                    _design
   Estimate variables:                 _y*
   Variance variables:                 _S*
   Contrast variables:                 _contrast*
   Command to list the data:           list study _design _contrast* _y* _S*, n
> oo sepby(_design)

. foreach thing in `_dta[network_allthings]' {
  2.     local std`thing' : char _dta[network_`thing']
  3. }

. network meta c, fixed
Command is: mvmeta _y _S , fixed commonparm noconstant suppress(uv mm) eq(_y_1:
>  _trtdiff1_B _trtdiff1_C _trtdiff1_D, _y_2: _trtdiff2_B _trtdiff2_C _trtdiff2
> _D) vars(_y_1 _y_2)
Note: using method fixed
Note: regressing _y_1 on _trtdiff1_B _trtdiff1_C _trtdiff1_D
Note: regressing _y_2 on _trtdiff2_B _trtdiff2_C _trtdiff2_D
Note: 24 observations on 2 variables

Multivariate meta-analysis
Variance-covariance matrix = (none)
Method = fixed                                 Number of dimensions    =     2
                                               Number of observations  =    24
------------------------------------------------------------------------------
             |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
_y_1         |
 _trtdiff1_B |   .1987505   .1259883     1.58   0.115     -.048182     .445683
 _trtdiff1_C |   .6391074   .0590771    10.82   0.000     .5233184    .7548964
 _trtdiff1_D |   .7086076   .1879352     3.77   0.000     .3402613    1.076954
------------------------------------------------------------------------------
The above coefficients also apply to the following equations:
    _y_2: _trtdiff2_B _trtdiff2_C _trtdiff2_D 
mvmeta command stored as F9

. local stab = _b[_trtdiff1_B]

. drop _trtdiff*

. rename (_* *) (sta=)

. rename stastudy study

. * compare chars, betas and data
. assert "`augallthings'" == "`stdallthings'" 

. foreach thing in `augallthings' {
  2.         if inlist("`thing'","`dim'","`format'") continue // expected to di
> ffer
  3.         if "`aug`thing''" != "`std`thing''" {
  4.                 di as error "Found discrepancy in `thing': aug = `aug`thin
> g'', std = `std`thing''" 
  5.                 exit 99
  6.         }
  7. }

. assert reldif(`augb',`stab')<1E-10

. merge 1:1 study using z

    Result                           # of obs.
    -----------------------------------------
    not matched                             0
    matched                                24  (_merge==3)
    -----------------------------------------

. foreach var in _y_1 _y_2 _S_1_1 _S_1_2 _S_2_2 { 
  2.         assert reldif(sta`var', aug`var')<1E-10
  3. }

. 
. // Repeat with quantitative data and inconsistency model
. * setup to augmented
. use zquant, clear

. network setup sbp sbpsd count, stud(study) trt(trt) smd format(augmented)
Treatments used
   A (reference):                      A
   B:                                  B
   C:                                  C

Measure                                Standardised mean difference
   Standard deviation pooling:         on

Studies
   ID variable:                        study
   Number used:                        3

Network information                    
   Components:                         1 (connected)
   D.f. for inconsistency:             2
   D.f. for heterogeneity:             0

Current data
   Data format:                        augmented
   Design variable:                    _design
   Estimate variables:                 _y*
   Variance variables:                 _S*
   Command to list the data:           list study _y* _S*, noo sepby(_design)

. network convert standard
Converting augmented to standard ...

. network meta i, fixed
Command is: mvmeta _y _S , fixed commonparm noconstant suppress(uv mm) eq(_y_1:
>  _trtdiff1_B _trtdiff1_C _trtdiff1_B_des_ABC _trtdiff1_C_des_AC, _y_2: _trtdi
> ff2_B _trtdiff2_C _trtdiff2_B_des_ABC _trtdiff2_C_des_AC) vars(_y_1 _y_2)
Note: using method fixed
Note: regressing _y_1 on _trtdiff1_B _trtdiff1_C _trtdiff1_B_des_ABC _trtdiff1_
> C_des_AC
Note: regressing _y_2 on _trtdiff2_B _trtdiff2_C _trtdiff2_B_des_ABC _trtdiff2_
> C_des_AC
Note: 3 observations on 2 variables

Multivariate meta-analysis
Variance-covariance matrix = (none)
Method = fixed                                 Number of dimensions    =     2
                                               Number of observations  =     3
------------------------------------------------------------------------------
             |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
_y_1         |
 _trtdiff1_B |   .4981033   .1436388     3.47   0.001     .2165763    .7796302
 _trtdiff1_C |   1.196967   .1497543     7.99   0.000     .9034537     1.49048
_trtdiff1~BC |    .499369   .2057112     2.43   0.015     .0961826    .9025555
_trtdiff1~AC |  -1.689106   .3241057    -5.21   0.000    -2.324342   -1.053871
------------------------------------------------------------------------------
The above coefficients also apply to the following equations:
    _y_2: _trtdiff2_B _trtdiff2_C _trtdiff2_B_des_ABC _trtdiff2_C_des_AC 

Testing for inconsistency:
 ( 1)  [_y_1]_trtdiff1_B_des_ABC = 0
 ( 2)  [_y_1]_trtdiff1_C_des_AC = 0

           chi2(  2) =   29.45
         Prob > chi2 =    0.0000
mvmeta command stored as F9; test command stored as F8

. local augb = _b[_trtdiff1_B_des_ABC]

. drop _trtdiff*

. rename (_* *) (aug=)

. rename augstudy study

. save z, replace
file z.dta saved

. * setup to standard
. use zquant, clear

. network setup sbp sbpsd count, stud(study) trt(trt) smd format(standard)
Treatments used
   A (reference):                      A
   B:                                  B
   C:                                  C

Measure                                Standardised mean difference
   Standard deviation pooling:         on

Studies
   ID variable:                        study
   Number used:                        3

Network information                    
   Components:                         1 (connected)
   D.f. for inconsistency:             2
   D.f. for heterogeneity:             0

Current data
   Data format:                        standard
   Design variable:                    _design
   Estimate variables:                 _y*
   Variance variables:                 _S*
   Contrast variables:                 _contrast*
   Command to list the data:           list study _design _contrast* _y* _S*, n
> oo sepby(_design)

. network meta i, fixed
Command is: mvmeta _y _S , fixed commonparm noconstant suppress(uv mm) eq(_y_1:
>  _trtdiff1_B _trtdiff1_C _trtdiff1_B_des_ABC _trtdiff1_C_des_AC, _y_2: _trtdi
> ff2_B _trtdiff2_C _trtdiff2_B_des_ABC _trtdiff2_C_des_AC) vars(_y_1 _y_2)
Note: using method fixed
Note: regressing _y_1 on _trtdiff1_B _trtdiff1_C _trtdiff1_B_des_ABC _trtdiff1_
> C_des_AC
Note: regressing _y_2 on _trtdiff2_B _trtdiff2_C _trtdiff2_B_des_ABC _trtdiff2_
> C_des_AC
Note: 3 observations on 2 variables

Multivariate meta-analysis
Variance-covariance matrix = (none)
Method = fixed                                 Number of dimensions    =     2
                                               Number of observations  =     3
------------------------------------------------------------------------------
             |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
_y_1         |
 _trtdiff1_B |   .4981033   .1436388     3.47   0.001     .2165763    .7796302
 _trtdiff1_C |   1.196967   .1497543     7.99   0.000     .9034537     1.49048
_trtdiff1~BC |    .499369   .2057112     2.43   0.015     .0961826    .9025555
_trtdiff1~AC |  -1.689106   .3241057    -5.21   0.000    -2.324342   -1.053871
------------------------------------------------------------------------------
The above coefficients also apply to the following equations:
    _y_2: _trtdiff2_B _trtdiff2_C _trtdiff2_B_des_ABC _trtdiff2_C_des_AC 

Testing for inconsistency:
 ( 1)  [_y_1]_trtdiff1_B_des_ABC = 0
 ( 2)  [_y_1]_trtdiff1_C_des_AC = 0

           chi2(  2) =   29.45
         Prob > chi2 =    0.0000
mvmeta command stored as F9; test command stored as F8

. local stab = _b[_trtdiff1_B_des_ABC]

. drop _trtdiff*

. rename (_* *) (sta=)

. rename stastudy study

. * compare
. assert reldif(`augb',`stab')<1E-15

. merge 1:1 study using z

    Result                           # of obs.
    -----------------------------------------
    not matched                             0
    matched                                 3  (_merge==3)
    -----------------------------------------

. foreach var in _y_1 _y_2 _S_1_1 _S_1_2 _S_2_2 { 
  2.         assert reldif(sta`var', aug`var')<1E-15
  3. }

. 
. 
. // The end
. erase z.dta

. erase zquant.dta

. 
. di as result _n "****************************************" ///
>         _n "*** NETWORK HAS PASSED ALL ITS TESTS ***" ///
>         _n "****************************************"

****************************************
*** NETWORK HAS PASSED ALL ITS TESTS ***
****************************************

. 
. log close
      name:  <unnamed>
       log:  c:\ado\ian\network\testlogs\network_cscript.log
  log type:  text
 closed on:   8 Apr 2021, 17:45:11
-------------------------------------------------------------------------------
